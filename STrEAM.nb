(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    304182,       7610]
NotebookOptionsPosition[    296747,       7461]
NotebookOutlinePosition[    297358,       7481]
CellTagsIndexPosition[    297315,       7478]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["STrEAM.m Package", "Title",
 CellChangeTimes->{{3.8160027659802012`*^9, 3.816002803366254*^9}, {
   3.816002851023321*^9, 3.8160028597243333`*^9}, 3.81600696458191*^9},
 TextAlignment->Center,ExpressionUUID->"662a8f3a-d1ee-4f63-9c1d-149fdaf6ec99"],

Cell["\<\
SuperTrace Evaluation Automated for Matching
by Timothy Cohen, Xiaochuan Lu, and Zhengkang Zhang
Last edited on December 06, 2020.\
\>", "Text",
 CellChangeTimes->{{3.816121221217865*^9, 3.8161212671024895`*^9}, {
  3.8161235733176556`*^9, 3.8161235777876616`*^9}, {3.816205806537505*^9, 
  3.8162058494687805`*^9}, {3.8162066234953403`*^9, 3.8162066388769674`*^9}, {
  3.816251307147335*^9, 
  3.8162513072721357`*^9}},ExpressionUUID->"0b01acb2-667c-458b-b768-\
a2dcb353bb45"],

Cell[CellGroupData[{

Cell["Begin the package", "Section",
 CellChangeTimes->{{3.816002767090203*^9, 3.8160027864742303`*^9}, {
  3.8160028786273603`*^9, 
  3.8160028861293707`*^9}},ExpressionUUID->"082fd18a-95b5-45c0-99f6-\
6246c1805f02"],

Cell[BoxData[
 RowBox[{"BeginPackage", "[", "\"\<STrEAM`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002768031204*^9, 3.8160027682212043`*^9}, 
   3.816002903341395*^9},ExpressionUUID->"c20b3ed0-afb0-41b1-8870-\
a49d70cb20d3"],

Cell[CellGroupData[{

Cell["Usage messages for the public functions", "Subsection",
 CellChangeTimes->{{3.8160027689612055`*^9, 3.816002769161206*^9}, {
  3.8160029456174545`*^9, 
  3.8160029475184574`*^9}},ExpressionUUID->"865fc571-d6ad-414e-b93b-\
4d97f5764f89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Reserved", " ", "for", " ", "input", " ", "recognition"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"P", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(P\), \(\[Mu]\)]\)=\!\(\*SubscriptBox[\(iD\), \
\(\[Mu]\)]\) denote the Hermitian covariant derivatives in input and \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(i\)]\)=\!\(\*FractionBox[\
\(1\), \(\*SuperscriptBox[\(P\), \(2\)] - \*SubsuperscriptBox[\(m\), \(i\), \
\(2\)]\)]\) denotes bosonic covariant propagators in input and its \
print.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[CapitalLambda]\), \
\(i\)]\)=\!\(\*FractionBox[\(1\), \(Pslash - \*SubscriptBox[\(m\), \
\(i\)]\)]\) denotes fermionic covariant propagators in input and its print.\>\
\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Reserved", " ", "as", " ", "dummy", " ", "indices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Mu]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\) denote dummy indices in \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(i\)]\) denote dummy indices in \
output.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Reserved", " ", "for", " ", "output"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(m\), \(i\)]\) with i non-negative integers \
denote particle masses.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "::", "usage"}], "=", 
     "\"\<d denotes the spacetime dimension in dimensional \
regularization.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Eta]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu], \[Nu]\)]\)=diag(1,-1,-1,-1) \
denotes the spacetime metric.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(F\), \(\[Mu], \
\[Nu]\)]\)=-i[\!\(\*SubscriptBox[\(P\), \
\(\[Mu]\)]\),\!\(\*SubscriptBox[\(P\), \
\(\[Nu]\)]\)]=\!\(\*SubscriptBox[\(g\), \
\(a\)]\)\!\(\*SubsuperscriptBox[\(G\), \(\[Mu]\[Nu]\), \
\(a\)]\)\!\(\*SuperscriptBox[\(T\), \(a\)]\) denotes the sum of field \
strengths.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Gamma]\), \(\[Mu]\)]\) denote Dirac \
matrices.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]F", "::", "usage"}], "=", 
     "\"\<\[Sigma]F denotes \!\(\*SuperscriptBox[\(\[Sigma]\), \
\(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(F\), \
\(\[Mu]\[Nu]\)]\)=\!\(\*FractionBox[\(i\), \(2\)]\)[\!\(\*SuperscriptBox[\(\
\[Gamma]\), \(\[Mu]\)]\),\!\(\*SuperscriptBox[\(\[Gamma]\), \(\[Nu]\)]\)]\!\(\
\*SubscriptBox[\(F\), \(\[Mu]\[Nu]\)]\) in the dipole factor \
\[CapitalSigma]=-\!\(\*FractionBox[\(1\), \(2\)]\)\!\(\*SuperscriptBox[\(\
\[Sigma]\), \(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(F\), \
\(\[Mu]\[Nu]\)]\).\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Pslash", "::", "usage"}], "=", 
     "\"\<Pslash=\!\(\*SubscriptBox[\(P\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[\(\[Gamma]\), \(\[Mu]\)]\)\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LoopI", "::", "usage"}], "=", 
     "\"\<\!\(\*FractionBox[\(1\), \(16 \*SuperscriptBox[\(\[Pi]\), \(2\)]\)]\
\)\!\(\*SubsuperscriptBox[\(LoopI\), \((\*SubscriptBox[\(n\), \(1\)],  ... , \
\*SubscriptBox[\(n\), \(k\)])\), \((r)\)]\)(\!\(\*SubsuperscriptBox[\(m\), \
\(1\), \(2\)]\),...,\!\(\*SubsuperscriptBox[\(m\), \(k\), \(2\)]\))=-i\
\[Integral]\!\(\*FractionBox[\(\*SuperscriptBox[\(d\), \(d\)] q\), \
SuperscriptBox[\((2  \[Pi])\), \
\(d\)]]\)\!\(\*FractionBox[SuperscriptBox[\((\*SuperscriptBox[\(q\), \
\(2\)])\), \(r\)], \(\(\*SuperscriptBox[\((\*SuperscriptBox[\(q\), \(2\)] - \
\*SubsuperscriptBox[\(m\), \(1\), \(2\)])\), SubscriptBox[\(n\), \(1\)]] ... \
\) \*SuperscriptBox[\((\*SuperscriptBox[\(q\), \(2\)] - \
\*SubsuperscriptBox[\(m\), \(k\), \(2\)])\), SubscriptBox[\(n\), \(k\)]]\)]\)\
\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Main", " ", "Functions"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperTrace", "::", "usage"}], "=", 
     "\"\<SuperTrace[dim,flist] evaluates -iSTr[f]\!\(\*SubscriptBox[\(|\), \
\(hard\)]\) up to operator dimension dim.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperTraceFromExpr", "::", "usage"}], "=", 
     "\"\<SuperTraceFromExpr[dim,fexpr] evaluates -iSTr[f]\!\(\*SubscriptBox[\
\(|\), \(hard\)]\) up to operator dimension dim.\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160027698712068`*^9, 3.816002770071207*^9}, 
   3.816002993465522*^9, {3.8160035475373025`*^9, 3.816003547747303*^9}, {
   3.816006687356519*^9, 3.8160068569847584`*^9}, {3.8160093172702246`*^9, 
   3.8160093308122435`*^9}, {3.8160160311964874`*^9, 3.816016060683529*^9}, 
   3.8160163604249506`*^9, {3.816031268898245*^9, 3.8160314095314436`*^9}, {
   3.8160314695925283`*^9, 3.8160314779545403`*^9}, {3.816031635550762*^9, 
   3.8160316893098373`*^9}, {3.8161059911770144`*^9, 3.816106078591138*^9}, {
   3.816106111726184*^9, 3.816106128148207*^9}, {3.8161061873082905`*^9, 
   3.8161062769924173`*^9}, {3.8161063240104833`*^9, 
   3.8161064076526012`*^9}, {3.8161064448576536`*^9, 
   3.8161066300759144`*^9}, {3.8161066917260013`*^9, 
   3.8161067381340666`*^9}, {3.8161067721301146`*^9, 3.816106805365161*^9}, {
   3.8161086983828278`*^9, 3.8161087033428345`*^9}, {3.816112068700985*^9, 
   3.8161121080970407`*^9}, {3.816121218105687*^9, 3.816121219274754*^9}, {
   3.816191568564397*^9, 3.816191596987647*^9}, {3.8161916307149057`*^9, 
   3.816191660542158*^9}, {3.816191709822645*^9, 
   3.8161918181492352`*^9}},ExpressionUUID->"f5b27e81-fee2-43bf-8b72-\
a4fefe5d4e9c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin the `Private context", "Section",
 CellChangeTimes->{{3.816002770761208*^9, 3.8160027709812083`*^9}, {
  3.8160029723524923`*^9, 
  3.816002974512495*^9}},ExpressionUUID->"b6c86209-c710-4b00-971b-\
6d0c93cd8fb0"],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002771651209*^9, 3.81600277186121*^9}, 
   3.816003478506205*^9},ExpressionUUID->"68b24e7e-ba8d-467b-8952-\
fce34710afed"],

Cell[CellGroupData[{

Cell["qSection Manipulations", "Subsection",
 CellChangeTimes->{{3.8160069182138443`*^9, 
  3.8160069535298944`*^9}},ExpressionUUID->"fbe5098c-431d-4c92-91e9-\
cc1bf085f178"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8160075915227933`*^9, 3.8160076432808657`*^9}, {
  3.8160077656300383`*^9, 3.816007770911046*^9}, {3.816007801776089*^9, 
  3.8160078033160915`*^9}},ExpressionUUID->"f255be19-dfdc-4664-a83e-\
d7574cbe1b79"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\"\<qSec\>\"", " ", "stores", " ", "the", " ", "q"}], "-", 
     RowBox[{"sections", " ", 
      RowBox[{"(", 
       RowBox[{"loop", " ", "momentum", " ", "dependence"}], ")"}], " ", "of",
       " ", "terms", " ", "in", " ", "intermediate", " ", "steps", " ", "in", 
      " ", "the", " ", "CDE", " ", "procedure"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "They", " ", "are", " ", "essentially", " ", "just", " ", "functions", 
     " ", "in", " ", "the", " ", "loop", " ", "momentum", " ", 
     SubscriptBox["q", "\[Mu]"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"When", " ", "generated", " ", "by", " ", "CDE"}]}], ",", " ", 
   RowBox[{"they", " ", "are", " ", "polynomials", " ", "of", " ", 
    SubscriptBox["q", "\[Mu]"]}], ",", " ", 
   RowBox[{
    SubscriptBox["dq", "\[Mu]"], 
    RowBox[{"(", 
     RowBox[{"derivatives", " ", "on", " ", 
      SubscriptBox["q", "\[Mu]"]}], ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"and", " ", 
      SubscriptBox["\[CapitalDelta]", "i"]}], "=", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["q", "2"], "-", 
       SubsuperscriptBox["m", "i", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Note", " ", "that", " ", "in", " ", "the", " ", "context", " ", "of", 
     " ", "\"\<qSec\>\""}]}], ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "i"], " ", "is", " ", "understood", " ", 
    "as", " ", "an", " ", "ordinary", " ", "loop", " ", "propagator"}], ",", 
   " ", 
   RowBox[{
   "different", " ", "from", " ", "an", " ", "input", " ", 
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(i\)]\)\>\""}], ",", " ", 
   RowBox[{
    RowBox[{"where", " ", "it", " ", "is", " ", "interpreted", " ", "as", " ", 
     SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "later", " ", "sections"}], ")"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "Concretely"}], ",", " ", 
   RowBox[{
   "a", " ", "\"\<qSec\>\"", " ", "is", " ", "a", " ", "list", " ", "of", 
    " ", "\"\<qPart\>\""}], ",", " ", 
   RowBox[{
   "while", " ", "a", " ", "\"\<qPart\>\"", " ", "is", " ", "simply", " ", 
    "a", " ", "list", " ", "of", " ", "factors"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"such", " ", "as", "\[IndentingNewLine]", "qPart"}], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "30"], ",", 
       SubscriptBox["\[CapitalDelta]", "1"], ",", 
       SubscriptBox["q", 
        SubscriptBox["\[Mu]", "4"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "1"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "2"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "3"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "5"]], ",", 
       SubscriptBox["\[CapitalDelta]", "1"]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"In", " ", "the", " ", "end"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"the", " ", "derivatives", " ", 
      SubscriptBox["dq", "\[Mu]"], " ", "in", " ", "qSec", " ", "will", " ", 
      "be", " ", "carried", " ", "out", " ", "and", " ", "the", " ", "loop", 
      " ", "integral"}], "\[IndentingNewLine]", "-", 
     RowBox[{"i", 
      RowBox[{"\[Integral]", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "d"], "q"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], "d"]], " ", "will", " ", "be", " ", 
        "performed", " ", "on", " ", "qSec"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "The", " ", "function", " ", "LoopInt", " ", "is", " ", "parameterized", 
      " ", "as", "\[IndentingNewLine]", 
      FractionBox["1", 
       RowBox[{"16", 
        SuperscriptBox["\[Pi]", "2"]}]], 
      SubsuperscriptBox["LoopI", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["n", "1"], ",", "...", ",", 
         SubscriptBox["n", "k"]}], ")"}], 
       RowBox[{"(", "r", ")"}]], 
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["m", "1", "2"], ",", "...", ",", 
        SubsuperscriptBox["m", "k", "2"]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"-", "i"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "d"], "q"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], "d"]], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           SuperscriptBox["q", "2"], ")"}], "r"], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["q", "2"], "-", 
              SubsuperscriptBox["m", "1", "2"]}], ")"}], 
            SubscriptBox["n", "1"]], "..."}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["q", "2"], "-", 
             SubsuperscriptBox["m", "k", "2"]}], ")"}], 
           SubscriptBox["n", "k"]]}]]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "which", " ", "is", " ", "evaluated", " ", "using", " ", "dim", " ", 
     "reg", " ", 
     RowBox[{"(", 
      RowBox[{"d", "=", 
       RowBox[{"4", "-", 
        RowBox[{"2", "\[Epsilon]"}]}]}], ")"}], " ", "under", " ", "the", " ",
      "MSbar", " ", "scheme"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "When", " ", "there", " ", "are", " ", "less", " ", "than", " ", "three", 
     " ", "distinct", " ", "masses"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "LoopInt", " ", "returns", " ", "the", " ", "explicit", " ", "value"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "When", " ", "there", " ", "are", " ", "three", " ", "or", " ", "more", 
      " ", "non"}], "-", 
     RowBox[{"degenerate", " ", "masses"}]}]}], ",", " ", 
   RowBox[{
   "LoopInt", " ", "leaves", " ", "the", " ", "result", " ", "abstract", " ", 
    "as", " ", "the", " ", "LHS", " ", 
    RowBox[{"above", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.8160071909692287`*^9, 3.81600719159923*^9}, 
   3.816007364036473*^9, 3.8160076003248053`*^9, {3.8160317152538743`*^9, 
   3.816031785515973*^9}, {3.816031826242031*^9, 3.816031901353136*^9}, {
   3.8160319659432273`*^9, 3.8160320565773554`*^9}, 3.8161087286178703`*^9, {
   3.816120703984281*^9, 3.8161207101666346`*^9}, 3.8162058855672445`*^9, {
   3.8162683683122067`*^9, 
   3.816268369419809*^9}},ExpressionUUID->"efa290f8-ea2b-4368-a5c8-\
33f9b9834298"]
}, Closed]],

Cell[CellGroupData[{

Cell["qSec and qPart Arithmetic", "Subsubsection",
 CellChangeTimes->{{3.816007133930148*^9, 
  3.8160071870082235`*^9}},ExpressionUUID->"c7a07fa0-315c-46a9-9182-\
7f5bb10ea183"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "qPartCommuting", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "q2dq2\[Eta]2Rules", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SplitqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ExprqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "qPartFromExpr", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SimplifyqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "SimplifyqSec", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ScaleqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ScaleqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MultiplyqSecs", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007692918936*^9, 3.8160076931289363`*^9}, {
   3.8160081965956454`*^9, 3.8160081996066494`*^9}, 3.8161087443898926`*^9, {
   3.8162059029924746`*^9, 3.816205923834111*^9}, {3.81626838709464*^9, 
   3.8162683880150414`*^9}},ExpressionUUID->"6308cc4e-69bc-4352-9f3e-\
557e8538728f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Commuting", " ", "condition", " ", "for", " ", "two", " ", "adjacent", 
    " ", "elements", " ", "in", " ", "qPart"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qPartCommuting", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#1", ",", 
           SubscriptBox["dq", "__"]}], "]"}], "&&", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"#2", ",", 
           SubscriptBox["dq", "__"]}], "]"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"#1", ",", 
            SubscriptBox["dq", "__"]}], "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"#2", ",", 
            SubscriptBox["dq", "__"]}], "]"}]}]}], ")"}]}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Rules", " ", "for", " ", "writing", " ", 
      SubsuperscriptBox["q", "\[Nu]", "2"]}], ",", " ", 
     SubsuperscriptBox["dq", "\[Nu]", "2"], ",", " ", 
     RowBox[{"and", " ", 
      SubsuperscriptBox["\[Eta]", "a_", "2"]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2dq2\[Eta]2Rules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["q", "\[Nu]_", "2"], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "\[Nu]"], ",", 
          SubscriptBox["q", "\[Nu]"]}], "}"}]}], ",", 
       RowBox[{
        SubsuperscriptBox["dq", "\[Nu]_", "2"], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Nu]"], ",", 
          SubscriptBox["dq", "\[Nu]"]}], "}"}]}], ",", 
       RowBox[{
        SubsuperscriptBox["\[Eta]", "a__", "2"], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Eta]", "a"], ",", 
          SubscriptBox["\[Eta]", "a"]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Split", " ", "a", " ", "qPart", " ", "into", " ", "commuting", " ", 
      "segments"}], ",", " ", 
     RowBox[{
     "with", " ", "the", " ", "first", " ", "one", " ", "reserved", " ", 
      "for", " ", "coefficient"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SplitqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"coeff", ",", "myqPart", ",", "myqPartSplit"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"Cases", "[", 
            RowBox[{"qPart", ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqPart", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"qPart", ",", 
             SubscriptBox["m", "__"]}], "]"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{"qPart", ",", 
             SubscriptBox["\[Eta]", "__"]}], "]"}], ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"qPart", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "__"], "|", 
              SubscriptBox["\[Eta]", "__"]}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqPartSplit", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "coeff", "}"}], "}"}], ",", 
           RowBox[{"Split", "[", 
            RowBox[{"myqPart", ",", "qPartCommuting"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPartSplit", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "\"\<qPart expression\>\"", " ", "from", " ", "a",
      " ", "qPart", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExprqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qPartGrouped", ",", "myqPartSplit", ",", "myexpr"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPartSplit", "=", 
         RowBox[{"SplitqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qPartGrouped", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", "#"}], ")"}], "&"}], "/@", 
          "myqPartSplit"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "qPartGrouped", "]"}], ">", "2"}], ",", 
           RowBox[{
            RowBox[{
            "qPartGrouped", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], " ", 
            RowBox[{"NonCommutativeMultiply", "@@", 
             RowBox[{"qPartGrouped", "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"Times", "@@", "qPartGrouped"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myexpr", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Convert", " ", "a", " ", "\"\<qPart expression\>\"", " ", "back", " ", 
     "to", " ", "the", " ", "qPart", " ", "list"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qPartFromExpr", "[", "expr_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqPart", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPart", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"expr", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Times", "\[Rule]", "List"}], ",", 
               RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
              "}"}]}], "/.", "q2dq2\[Eta]2Rules"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "myqPart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}]}], ",", 
          RowBox[{"myqPart", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"myqPart", ",", "1", ",", "1"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "qPart", " ", "to", " ", "its", " ", 
     "canonical", " ", "form", " ", "via", " ", "\"\<qPart expression\>\""}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myexpr", ",", "myqPart"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myexpr", "=", 
         RowBox[{"ExprqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqPart", "=", 
         RowBox[{"qPartFromExpr", "[", "myexpr", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "qSec", " ", "to", " ", "its", " ", 
     "canonical", " ", "form", " ", "via", " ", "\"\<qPart expression\>\""}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qSecexpr", ",", "exprArray", ",", "myqSec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qSecexpr", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ExprqPart", "[", "#", "]"}], "&"}], "/@", "qSec"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"exprArray", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"qSecexpr", "/.", 
            RowBox[{"Plus", "\[Rule]", "List"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"qPartFromExpr", "[", "#", "]"}], "&"}], "/@", 
          "exprArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Scale", " ", "a", " ", "qPart", " ", "by", " ", "a", " ", "constant", 
      " ", "coeff"}], ",", " ", 
     RowBox[{
     "which", " ", "does", " ", "not", " ", "depend", " ", "on", " ", "q", 
      " ", "or", " ", "dq"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaleqPart", "[", 
      RowBox[{"qPart_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqPart", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPart", "=", 
         RowBox[{"SimplifyqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "myqPart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"coeff", "\[Times]", 
          RowBox[{
          "myqPart", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqPart", "=", 
         RowBox[{"SimplifyqPart", "[", "myqPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Scale", " ", "a", " ", "qSec", " ", "by", " ", "a", " ", "constant", 
      " ", "coeff"}], ",", " ", 
     RowBox[{
     "which", " ", "does", " ", "not", " ", "depend", " ", "on", " ", "q", 
      " ", "or", " ", "dq"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaleqSec", "[", 
      RowBox[{"qSec_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ScaleqPart", "[", 
            RowBox[{"#", ",", "coeff"}], "]"}], "&"}], "/@", "qSec"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Multiply", " ", "a", " ", "list", " ", "of", " ", "qSecs", " ", "into", 
     " ", "a", " ", "qSec"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiplyqSecs", "[", "qSeclist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"Tuples", "[", "qSeclist", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007082571076*^9, 3.8160070827510767`*^9}, {
   3.8160082134486694`*^9, 3.816008214938671*^9}, 3.8161087611219163`*^9, {
   3.8162059179841013`*^9, 3.816205919200903*^9}, {3.8162684035994687`*^9, 
   3.81626840436387*^9}},ExpressionUUID->"17f06e1b-0dc1-44bf-b251-\
a1b116e2a34b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivatives and Integrals", "Subsubsection",
 CellChangeTimes->{{3.8160069933259506`*^9, 3.8160069935259504`*^9}, {
  3.816007672445907*^9, 
  3.816007686717927*^9}},ExpressionUUID->"50b750bf-5604-482e-ad3f-\
6895b0cece92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "dqCommRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqLastqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqLastqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqAllqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqAllqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "qEvenTrimqSec", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Eta]ContractionRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "qContractionRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "AllPairings", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "LoopInt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IntegrateqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IntegrateqSec", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81600708536208*^9, 3.8160070856020803`*^9}, {
   3.8160082327216964`*^9, 3.816008234061698*^9}, 3.8161087834249477`*^9, {
   3.8162059406353407`*^9, 3.8162059421329436`*^9}, {3.8162684242071047`*^9, 
   3.8162684254395075`*^9}},ExpressionUUID->"2342ad68-514f-4163-b06a-\
ebd30a1e3276"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Replacement", " ", "rules", " ", "for", " ", "dq", " ", "commutators"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dqCommRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["\[Eta]", "__"]}], "}"}], "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["m", "__"]}], "}"}], "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["q", "\[Nu]_"]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}]], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["\[CapitalDelta]", "m_"]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", 
          SubscriptBox["q", "\[Mu]"], ",", 
          SubsuperscriptBox["\[CapitalDelta]", "m", "2"]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubsuperscriptBox["\[CapitalDelta]", "m_", "n_"]}], "}"}], 
        "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "n"}], ",", 
          SubscriptBox["q", "\[Mu]"], ",", 
          SubsuperscriptBox["\[CapitalDelta]", "m", 
           RowBox[{"n", "+", "1"}]]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "last", " ", "dq", " ", "in", " ", 
     "a", " ", "qPart", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqLastqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myqPart", ",", "poslist", ",", "pos", ",", "myqSec"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPart", "=", 
         RowBox[{"SimplifyqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poslist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"myqPart", ",", 
            SubscriptBox["dq", "__"]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "return", " ", "when", " ", "there", " ", "is", " ", "no", " ", "dq",
           " ", "to", " ", "carry", " ", "out"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "poslist", "]"}], "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"myqSec", "=", 
            RowBox[{"{", "myqPart", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"Last", "[", "poslist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "write", " ", "qPart", " ", "into", " ", "a", " ", "series", " ", 
          "of", " ", "dq", " ", "commutators"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"myqPart", "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{"pos", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"myqPart", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"pos", "+", "1"}], ";;", 
               RowBox[{"#", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "myqPart", "\[LeftDoubleBracket]", "pos", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "myqPart", "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}]}], "}"}], "}"}], ",", 
             RowBox[{"myqPart", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"#", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"pos", "+", "1"}], ",", 
            RowBox[{"Length", "[", "myqPart", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "carry", " ", "out", " ", "the", " ", "dq", " ", "commutators"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"(", 
           RowBox[{"myqSec", "/.", "dqCommRules"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "last", " ", "dq", " ", "in", " ", 
     "a", " ", "qSec", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqLastqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "qSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"dqLastqPart", "/@", "myqSec"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "all", " ", "dq", " ", "in", " ", "a", " ", 
     "qPart", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqAllqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ii", ",", "ndq", ",", "myqSec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ndq", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"qPart", ",", 
           SubscriptBox["dq", "__"]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"{", "qPart", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Nest", "[", 
          RowBox[{"dqLastqSec", ",", "myqSec", ",", "ndq"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "all", " ", "dq", " ", "in", " ", "a", " ", 
     "qSec", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqAllqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"dqAllqPart", "/@", "qSec"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Drop", " ", "the", " ", "qParts", " ", "in", " ", "a", " ", "qSec", " ",
       "that", " ", "are", " ", "odd", " ", "under", " ", "q"}], "\[Rule]", 
     RowBox[{"-", "q"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qEvenTrimqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"qSec", ",", 
           RowBox[{
            RowBox[{"EvenQ", "[", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"#", ",", 
                SubscriptBox["q", "__"]}], "]"}], "+", 
              RowBox[{"Count", "[", 
               RowBox[{"#", ",", 
                SubscriptBox["dq", "__"]}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"myqSec", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"\[Eta]", " ", "contraction", " ", "rules"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]ContractionRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Rho]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Rho]_", ",", "\[Mu]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Nu]_", ",", "\[Mu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Rho]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Nu]_", ",", "\[Mu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Rho]_", ",", "\[Mu]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "\[Rule]", "d"}], ",", 
       RowBox[{
        SubsuperscriptBox["\[Eta]", "__", "2"], "\[Rule]", "d"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["a__", "\[Mu]_"], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "\[Rule]", 
        SubscriptBox["a", "\[Nu]"]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["a__", "\[Mu]_"], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "\[Rule]", 
        SubscriptBox["a", "\[Nu]"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"q", " ", "contraction", " ", "rules"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qContractionRules", "=", 
     RowBox[{"{", 
      RowBox[{
       SubsuperscriptBox["q", "__", "2"], "\[Rule]", 
       SubsuperscriptBox["\[CapitalDelta]", "0", 
        RowBox[{"-", "1"}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "list", " ", "of", " ", "all", " ", "pairings", 
     " ", "for", " ", "an", " ", "even", " ", "number", " ", "of", " ", 
     "objects"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AllPairings", "[", 
      RowBox[{"{", "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AllPairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "}"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllPairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b__"}], "}"}], "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{
              RowBox[{"{", "b", "}"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "/@", 
          RowBox[{"AllPairings", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"{", "b", "}"}], ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "A", " ", "generic", " ", "Loop", " ", "Integral", " ", "evaluated", 
       " ", "with", " ", "dim"}], "-", 
      RowBox[{"reg", " ", "and", " ", "MSbar", " ", "scheme"}]}], ",", " ", 
     RowBox[{"multiplied", " ", "by", " ", "16", 
      SuperscriptBox["\[Pi]", "2"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LoopInt", "[", 
      RowBox[{"r_", ",", "nlist_", ",", "masslist_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nlen", ",", "n", ",", "M", ",", "n1", ",", "n2", ",", "M1", ",", 
         "M2", ",", "myResult"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nlen", "=", 
         RowBox[{"Length", "[", "nlist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nlen", "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nlen", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"First", "[", "nlist", "]"}]}], ";", 
           RowBox[{"M", "=", 
            RowBox[{"First", "[", "masslist", "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"dim", "-", "reg"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"coeff", 
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"4", "\[Pi]"}], ")"}], 
               RowBox[{
                RowBox[{"d", "/", "2"}], "-", "2"}]]], 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"n", "-", "r"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                SuperscriptBox["M", "2"], ")"}], 
               RowBox[{"n", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}]]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"r", "+", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"d", "/", "2"}], "]"}]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"n", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", "n", "]"}]]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"MSbar", " ", "scheme"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"SeriesCoefficient", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"4", "\[Pi]"}], ")"}], "\[Epsilon]"], 
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "+", "\[Epsilon]"}], "]"}]}]], 
               RowBox[{"(", 
                RowBox[{"myResult", "/.", 
                 RowBox[{"{", 
                  RowBox[{"d", "\[Rule]", 
                   RowBox[{"4", "-", 
                    RowBox[{"2", "\[Epsilon]"}]}]}], "}"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", "myResult", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nlen", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"n1", "=", 
            RowBox[{
            "nlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ";", 
           RowBox[{"n2", "=", 
            RowBox[{
            "nlist", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            ";", 
           RowBox[{"M1", "=", 
            RowBox[{
            "masslist", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ";", 
           RowBox[{"M2", "=", 
            RowBox[{
            "masslist", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"dim", "-", "reg"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"coeff", 
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"4", "\[Pi]"}], ")"}], 
               RowBox[{
                RowBox[{"d", "/", "2"}], "-", "2"}]]], 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"n1", "+", "n2", "-", "r"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                SuperscriptBox["M1", "2"], ")"}], 
               RowBox[{"n1", "+", "n2", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}]]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"r", "+", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"d", "/", "2"}], "]"}]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"n1", "+", "n2", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"n1", "+", "n2"}], "]"}]]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"myResult", "\[Times]", 
             RowBox[{"Hypergeometric2F1", "[", 
              RowBox[{
               RowBox[{"n1", "+", "n2", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}], ",", "n2", ",", 
               RowBox[{"n1", "+", "n2"}], ",", 
               RowBox[{"1", "-", 
                FractionBox[
                 SuperscriptBox["M2", "2"], 
                 SuperscriptBox["M1", "2"]]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"MSbar", " ", "scheme"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"SeriesCoefficient", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"4", "\[Pi]"}], ")"}], "\[Epsilon]"], 
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "+", "\[Epsilon]"}], "]"}]}]], 
               RowBox[{"(", 
                RowBox[{"myResult", "/.", 
                 RowBox[{"{", 
                  RowBox[{"d", "\[Rule]", 
                   RowBox[{"4", "-", 
                    RowBox[{"2", "\[Epsilon]"}]}]}], "}"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", "myResult", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myResult", "=", 
         RowBox[{"Subsuperscript", "[", 
          RowBox[{"LoopI", ",", 
           RowBox[{"Row", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "\"\<(\>\"", "}"}], ",", 
              RowBox[{"Riffle", "[", 
               RowBox[{"nlist", ",", "\"\<,\>\""}], "]"}], ",", 
              RowBox[{"{", "\"\<)\>\"", "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<(\>\"", ",", "r", ",", "\"\<)\>\""}], "}"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myResult", "=", 
         RowBox[{"coeff", " ", 
          RowBox[{"Row", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"myResult", ",", "\"\<(\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Row", "[", 
               RowBox[{
                SuperscriptBox["masslist", "2"], ",", "\"\<,\>\""}], "]"}], 
              "}"}], ",", 
             RowBox[{"{", "\"\<)\>\"", "}"}]}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myResult", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Symmetrize", " ", "qPart", " ", "and", " ", "expand", " ", "in", " ", 
     "hard", " ", "region", " ", "to", " ", "get", " ", "a", " ", "qSec", " ",
      "before", " ", "performing", " ", "the", " ", "q", " ", "integral"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardqPart", "[", 
      RowBox[{"qPart_", ",", "Heavylist_", ",", "LightOrd_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "q\[Mu]list", ",", "\[CapitalDelta]list", ",", "coeff", ",", "npair", 
         ",", "\[Eta]listArray", ",", "Mpattern", ",", "\[CapitalDelta]Mexpr",
          ",", "\[CapitalDelta]mexpr", ",", "\[CapitalDelta]Expr", ",", 
         "\[CapitalDelta]listArray", ",", "myqSec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "split", " ", "the", " ", "qPart", " ", "into", " ", "three", " ", 
          RowBox[{"factors", ":", " ", "q\[Mu]lsit"}]}], ",", " ", 
         "\[CapitalDelta]list", ",", " ", 
         RowBox[{
         "and", " ", "\"\<coeff\>\"", " ", "which", " ", "is", " ", "the", 
          " ", "product", " ", "of", " ", "the", " ", "rest"}]}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q\[Mu]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["q", "\[Mu]_"], "\[Rule]", "\[Mu]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "__"], "|", 
            SubsuperscriptBox["\[CapitalDelta]", "__", "__"], "|", 
            SubscriptBox["m", "__"], "|", 
            SubsuperscriptBox["m", "__", "__"]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"qPart", ",", 
            RowBox[{
             SubscriptBox["q", "__"], "|", 
             SubscriptBox["\[CapitalDelta]", "__"], "|", 
             SubsuperscriptBox["\[CapitalDelta]", "__", "__"], "|", 
             SubscriptBox["m", "__"], "|", 
             SubsuperscriptBox["m", "__", "__"]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"convert", " ", "q\[Mu]lsit", " ", "into", " ", 
           SubscriptBox["\[CapitalDelta]", "0"]}], ",", " ", 
          SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], ",", " ", 
          RowBox[{
           RowBox[{"and", " ", 
            SubscriptBox["cp", "n"]}], "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"d", "+", "2"}], ")"}]}], "..."}], 
              RowBox[{"(", 
               RowBox[{"d", "+", 
                RowBox[{"2", "n"}], "-", "2"}], ")"}]}]], " ", "for", " ", 
            "n", " ", "pair", " ", "of", " ", 
            SubscriptBox["q", "\[Mu]"]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"npair", "=", 
         RowBox[{
          RowBox[{"Length", "[", "q\[Mu]list", "]"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]list", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"\[CapitalDelta]list", ",", 
           RowBox[{"{", 
            SubsuperscriptBox["\[CapitalDelta]", "0", 
             RowBox[{"-", "npair"}]], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Eta]", ",", "#"}], "]"}], "&"}], "/@", "#"}], 
              ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Eta]", 
                RowBox[{"{", "a__", "}"}]], "\[Rule]", 
               SubscriptBox["\[Eta]", "a"]}], "}"}]}], ")"}], "&"}], "/@", 
          RowBox[{"AllPairings", "[", "q\[Mu]list", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "expand", " ", "and", " ", "truncate", " ", "\[CapitalDelta]Part", 
          " ", "expression", " ", "according", " ", "to", " ", "the", " ", 
          "given", " ", "Heavylist", " ", "and", " ", "desired", " ", 
          "LightOrd"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Mpattern", "=", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"(", 
           RowBox[{"Join", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["m", "#"], ",", 
                 SubsuperscriptBox["m", "#", "__"], ",", 
                 SubscriptBox["\[CapitalDelta]", "#"], ",", 
                 SubsuperscriptBox["\[CapitalDelta]", "#", "__"]}], "}"}], 
               "&"}], "/@", "Heavylist"}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Mexpr", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{"\[CapitalDelta]list", ",", "Mpattern"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]mexpr", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"\[CapitalDelta]list", ",", "Mpattern"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "i_"], "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "0"}], ",", 
                SubscriptBox["\[CapitalDelta]", "i"], ",", 
                RowBox[{
                 SubscriptBox["\[CapitalDelta]", "0"], 
                 FractionBox["1", 
                  RowBox[{"1", "-", 
                   RowBox[{
                    SubscriptBox["\[CapitalDelta]", "0"], 
                    SubsuperscriptBox["m", "i", "2"]}]}]]}]}], "]"}]}], 
             "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Expr", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{"\[CapitalDelta]Mexpr", "\[Times]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{
                RowBox[{"\[CapitalDelta]mexpr", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["m", "i_"], "\[Rule]", 
                   RowBox[{
                    SubscriptBox["m", "i"], "\[Epsilon]"}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Epsilon]", ",", "0", ",", "LightOrd"}], "}"}]}], 
               "]"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", "\[Rule]", "1"}], "}"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"combine", " ", "coeff"}], ",", " ", 
          SubscriptBox["cp", "npair"], ",", " ", 
          RowBox[{
          "and", " ", "the", " ", "truncated", " ", "\[CapitalDelta]Part", 
           " ", "expression", " ", "into", " ", "the", " ", "new", " ", 
           "qSec"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{"Times", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Expr", "/.", 
             RowBox[{"{", 
              RowBox[{"Plus", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"coeff", ",", 
               SubscriptBox["cp", "npair"]}], "}"}], ",", "#"}], "]"}], "&"}],
           "/@", 
          RowBox[{"(", 
           RowBox[{"Flatten", "/@", 
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{"\[Eta]listArray", ",", "\[CapitalDelta]listArray"}], 
              "}"}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Symmetrize", " ", "a", " ", "qSec", " ", "and", " ", "expand", " ", "in",
      " ", "hard", " ", "region", " ", "before", " ", "performing", " ", 
     "the", " ", "q", " ", "integral"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardqSec", "[", 
      RowBox[{"qSec_", ",", "Heavylist_", ",", "LightOrd_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"SymHardqPart", "[", 
              RowBox[{"#", ",", "Heavylist", ",", "LightOrd"}], "]"}], "&"}], 
            "/@", "qSec"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "q", " ", "integral", " ", "for", 
     " ", "a", " ", "qPart"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrateqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coeff", ",", "\[CapitalDelta]list", ",", "r", ",", "nlist", ",", 
         "masslist", ",", "LoopIparameters", ",", "myqPart"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"qPart", ",", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "__"], "|", 
             SubsuperscriptBox["\[CapitalDelta]", "__", "__"]}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["cp", "n"], "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{
              RowBox[{"d", 
               RowBox[{"(", 
                RowBox[{"d", "+", "2"}], ")"}]}], "..."}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"2", "n"}], "-", "2"}], ")"}]}]], " ", "for", " ", "n",
            " ", "pair", " ", "of", " ", 
           SubscriptBox["q", "\[Mu]"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"coeff", "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["cp", "n_"], "\[RuleDelayed]", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["1", 
                 RowBox[{"d", "+", 
                  RowBox[{"2", "#"}], "-", "2"}]], "&"}], "/@", 
               RowBox[{"Range", "[", "n", "]"}]}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "__"], "|", 
            SubsuperscriptBox["\[CapitalDelta]", "__", "__"]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"-", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"\[CapitalDelta]list", ",", 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "0"], "|", 
                SubsuperscriptBox["\[CapitalDelta]", "0", "__"]}]}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "0"], "\[Rule]", "1"}], ",", 
               RowBox[{
                SubsuperscriptBox["\[CapitalDelta]", "0", "a_"], "\[Rule]", 
                "a"}]}], "}"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LoopIparameters", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"\[CapitalDelta]list", ",", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "0"], "|", 
              SubsuperscriptBox["\[CapitalDelta]", "0", "__"]}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "imass_"], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"imass", ",", "1"}], "}"}]}], ",", 
             RowBox[{
              SubsuperscriptBox["\[CapitalDelta]", "imass_", "n_"], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"imass", ",", "n"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"masslist", "=", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "#"], "&"}], "/@", 
          RowBox[{
          "LoopIparameters", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nlist", "=", 
         RowBox[{
         "LoopIparameters", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nlist", "]"}], "<", "3"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"store", " ", "the", " ", "result", " ", "as", " ", 
             RowBox[{"{", "result", "}"}]}], ",", " ", 
            RowBox[{
            "when", " ", "there", " ", "are", " ", "two", " ", "or", " ", 
             "less", " ", "heavy", " ", "masses"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"myqPart", "=", 
           RowBox[{"{", 
            RowBox[{"LoopInt", "[", 
             RowBox[{"r", ",", "nlist", ",", "masslist", ",", "coeff"}], 
             "]"}], "}"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"store", " ", "the", " ", "result", " ", "as", " ", 
             RowBox[{"{", 
              RowBox[{"coeff", ",", " ", "LoopI"}], "}"}]}], ",", " ", 
            RowBox[{
            "when", " ", "there", " ", "are", " ", "three", " ", "or", " ", 
             "more", " ", "heavy", " ", "masses"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"myqPart", "=", 
            RowBox[{"{", 
             RowBox[{"coeff", ",", 
              RowBox[{"LoopInt", "[", 
               RowBox[{"r", ",", "nlist", ",", "masslist", ",", "1"}], 
               "]"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "q", " ", "integral", " ", "for", 
     " ", "a", " ", "qSec"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrateqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", ",", "myqSec"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"IntegrateqPart", "/@", "qSec"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"myqSec", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "myqSec", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "<", "2"}], ",", 
          RowBox[{"myqSec", "=", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Simplify", "[", 
              RowBox[{"Plus", "@@", 
               RowBox[{"Flatten", "[", "myqSec", "]"}]}], "]"}], "}"}], 
            "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160069256758547`*^9, 3.816006925855855*^9}, {
   3.8160082478147173`*^9, 3.816008249014719*^9}, 3.8161088109189863`*^9, {
   3.8162059688089905`*^9, 3.8162059698385925`*^9}, {3.816268444689941*^9, 
   3.8162684457195425`*^9}, {3.816272124366005*^9, 
   3.816272125099206*^9}},ExpressionUUID->"fe5846a3-6921-4326-9278-\
5fb983db53ea"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polynomial Manipulations", "Subsection",
 CellChangeTimes->{{3.8160069717329197`*^9, 
  3.816007001647962*^9}},ExpressionUUID->"80632c07-cf86-42a9-94d0-\
ff524be57346"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8160077260939827`*^9, 3.816007777423055*^9}, 
   3.8160078083970985`*^9},ExpressionUUID->"0c43efaa-ce28-4b9e-b00d-\
af12a4aeed5c"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "\"\<poly\>\"", " ", "and", " ", "\"\<term\>\"", " ", "are", " ", "used", 
     " ", "to", " ", "handle", " ", "the", " ", "CDE", " ", "procedure"}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
    "A", " ", "\"\<poly\>\"", " ", "is", " ", "a", " ", "list", " ", "of", 
     " ", "\"\<terms\>\""}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "while", " ", "a", " ", "\"\<term\>\"", " ", "consists", " ", "of", " ", 
      "three", " ", "lists", "\[IndentingNewLine]", "term"}], "=", 
     RowBox[{"{", 
      RowBox[{"qSec", ",", " ", "Oper", ",", " ", "Ord"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"for", " ", "example", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UCDEDim", "[", "4", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "6"], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "2"]], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "3"]]}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "2"]], ",", 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "3"]], ",", "U"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "0"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"GCDEDim", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Nu]", "1"], ",", 
          SubscriptBox["\[Nu]", "2"]}], "}"}], ",", "4"}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "8"], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "2"]]}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "2"]], ",", 
          SubscriptBox["G", 
           RowBox[{
            SubscriptBox["\[Nu]", "1"], ",", 
            SubscriptBox["\[Nu]", "2"]}]]}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "2", ",", "2"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "The", " ", "first", " ", "list", " ", "\"\<qSec\>\"", " ", "is", " ", 
      "the", " ", "q"}], "-", 
     RowBox[{"Section", " ", "of", " ", "the", " ", 
      RowBox[{"term", ".", " ", "This"}], " ", "part", " ", "will", " ", "be",
       " ", "integrated", " ", "over", " ", "eventually"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "The", " ", "second", " ", "list", " ", "\"\<Oper\>\"", " ", "stores", 
     " ", "the", " ", "effective", " ", 
     RowBox[{"operator", ".", " ", "This"}], " ", "part", " ", "will", " ", 
     "be", " ", "shown", " ", "in", " ", "the", " ", "final", " ", "result"}],
     ";", 
    RowBox[{
     RowBox[{
     "The", " ", "third", " ", "list", " ", "\"\<Ord\>\"", " ", "is", " ", 
      "a", " ", "list", " ", "of", " ", "auxiliary", " ", "parameters", 
      "\[IndentingNewLine]", "Ord"}], "=", 
     RowBox[{"{", 
      RowBox[{"dim", ",", " ", "ndummy", ",", " ", "nopen"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "with", " ", "the", " ", "following", " ", "meaning", " ", 
     "respectively"}], ";", "\[IndentingNewLine]", 
    RowBox[{"dim", "      ", "the", " ", "operator", " ", "dimension"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "ndummy", "   ", "the", " ", "number", " ", "of", " ", "dummy", " ", 
     "Lorentz", " ", "index", " ", "pairs", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Mu]", "i"], " ", "indices"}], ")"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "nopen", "    ", "the", " ", "number", " ", "of", " ", "open", " ", 
     "Lorentz", " ", "indices"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "The", " ", "numbers", " ", "of", " ", "Lorentz", " ", "indices"}]}], ",",
    " ", 
   RowBox[{"\"\<ndummy\>\"", " ", "and", " ", "\"\<nopen\>\""}], ",", " ", 
   RowBox[{
    RowBox[{
    "are", " ", "only", " ", "used", " ", "in", " ", "the", " ", "steps", " ",
      "of", " ", "generating", " ", "the", " ", "CDE", " ", "poly"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Once", " ", "we", " ", "obtain", " ", "the", " ", "poly", " ", "and", 
     " ", "move", " ", "on", " ", "to", " ", "address", " ", "the", " ", 
     "loop", " ", "integral", " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "the", " ", "main", " ", "function", " ", 
       RowBox[{"SuperTrace", "[", "]"}], " ", "below"}], ")"}]}]}], ",", " ", 
   RowBox[{
   "they", " ", "will", " ", "no", " ", "longer", " ", "be", " ", "in", " ", 
    RowBox[{"use", ".", " ", "In"}], " ", "the", " ", "final", " ", 
    "output"}], ",", " ", 
   RowBox[{"they", " ", "will", " ", "be", " ", "discarded"}], ",", " ", 
   RowBox[{
   "and", " ", "only", " ", "\"\<dim\>\"", " ", "will", " ", "be", " ", 
    RowBox[{"kept", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.8160077270849843`*^9, 3.816007746728012*^9}, 
   3.8160077943050785`*^9, 3.8161088812210855`*^9, {3.816205992801832*^9, 
   3.8162060307410994`*^9}, {3.8162060610519524`*^9, 3.816206135557683*^9}, {
   3.8162061737309504`*^9, 3.816206248236681*^9}, {3.8162684707575865`*^9, 
   3.8162684720679893`*^9}},ExpressionUUID->"334e39dd-274e-41a4-8f34-\
7b53a207a3e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Term and Poly Arithmetic", "Subsubsection",
 CellChangeTimes->{{3.8160077280149856`*^9, 3.816007728214986*^9}, 
   3.8160078167881107`*^9, {3.8160078698761854`*^9, 
   3.8160078749571924`*^9}},ExpressionUUID->"f8336a91-1c7f-4094-9638-\
53cd915bcbc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "SimplifyOperTerm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SimplifyPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ScaleTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ScalePoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SumPolys", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ShiftDummyIndicesTerm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ShiftDummyIndicesPoly", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "DistinguishDummyIndices", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MultiplyTerms", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MultiplyPolys", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ContractTermIndices", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ContractPolyIndices", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007845383151*^9, 3.816007845583151*^9}, {
   3.8160082832997675`*^9, 3.8160082850197697`*^9}, 3.8161089070151215`*^9, {
   3.8162062763479304`*^9, 3.8162062975483675`*^9}, {3.816268509055654*^9, 
   3.816268510303656*^9}},ExpressionUUID->"f646f439-d369-4c36-af8a-\
49d9f16ade2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Move", " ", "all", " ", "commuting", " ", "factors"}], ",", " ", 
    RowBox[{"such", " ", "as", " ", "constants"}], ",", " ", 
    SubscriptBox["m", "i"], ",", " ", 
    RowBox[{"and", " ", 
     SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], " ", "in", " ", "Oper", " ", "to", 
     " ", "qSec"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyOperTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myqSec", ",", "coeffOper", ",", "myOper", ",", "myterm"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"coeffOper", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", 
                SubscriptBox["m", "__"], "|", 
                SubscriptBox["\[Eta]", "__"]}]}], "]"}], "&"}], "/@", 
            "myOper"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "__"], "|", 
              SubscriptBox["\[Eta]", "__"]}]}], "]"}], "&"}], "/@", 
          "myOper"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"myOper", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"ScaleqSec", "[", 
          RowBox[{
           RowBox[{
           "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "coeffOper"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "myqSec"}], ",", 
             RowBox[{"2", "\[Rule]", "myOper"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "poly", " ", "by", " ", "collecting", " ", 
     "and", " ", "simplifying", " ", "its", " ", "terms"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyOperTerm", "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Join", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "&"}], "/@", "#"}], ")"}]}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{"mypoly", ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"SimplifyqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Scale", " ", "a", " ", "term", " ", "by", " ", "a", " ", "constant", 
      " ", "coeff"}], ",", " ", 
     RowBox[{
     "which", " ", "does", " ", "not", " ", "depend", " ", "on", " ", "q", 
      " ", "or", " ", "dq"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaleTerm", "[", 
      RowBox[{"term_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myqSec", ",", "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"ScaleqSec", "[", 
          RowBox[{
           RowBox[{
           "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "coeff"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Scale", " ", "a", " ", "poly", " ", "by", " ", "a", " ", "constant", 
      " ", "coeff"}], ",", " ", 
     RowBox[{
     "which", " ", "does", " ", "not", " ", "depend", " ", "on", " ", "q", 
      " ", "or", " ", "dq"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScalePoly", "[", 
      RowBox[{"poly_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ScaleTerm", "[", 
            RowBox[{"#", ",", "coeff"}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Sum", " ", "a", " ", "list", " ", "of", " ", "polys", " ", "into", " ", 
     "a", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SumPolys", "[", "polylist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", "polylist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Shift", " ", "all", " ", "the", " ", "dummy", " ", "indices", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Mu]", "i"], " ", "indices"}], ")"}], " ", "in", " ", 
     "a", " ", "term", " ", "by", " ", "n"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ShiftDummyIndicesTerm", "[", 
      RowBox[{"term_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myterm", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myterm", "=", 
         RowBox[{"term", "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Mu]", "m_"], "\[Rule]", 
            SubscriptBox["\[Mu]", 
             RowBox[{"m", "+", "n"}]]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Shift", " ", "all", " ", "the", " ", "dummy", " ", "indices", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Mu]", "i"], " ", "indices"}], ")"}], " ", "in", " ", 
     "a", " ", "poly", " ", "by", " ", "n"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ShiftDummyIndicesPoly", "[", 
      RowBox[{"poly_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ShiftDummyIndicesTerm", "[", 
            RowBox[{"#", ",", "n"}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Before", " ", "multiplying", " ", "a", " ", "list", " ", "of", " ", 
      "terms"}], ",", " ", 
     RowBox[{
     "distinguish", " ", "their", " ", "dummy", " ", "indices", " ", "by", 
      " ", "shifting", " ", "the", " ", "ones", " ", "appearing", " ", 
      "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DistinguishDummyIndices", "[", "termlist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"shiftlist", ",", "mytermlist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"shiftlist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"Accumulate", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ")"}], "&"}], "/@", "termlist"}], ")"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mytermlist", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ShiftDummyIndicesTerm", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"termlist", ",", "shiftlist"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mytermlist", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Multiply", " ", "a", " ", "list", " ", "of", " ", "terms", " ", "into", 
     " ", "a", " ", "term"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiplyTerms", "[", "termlist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mytermlist", ",", "qSec", ",", "Oper", ",", "Ord", ",", "myterm"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mytermlist", "=", 
         RowBox[{"DistinguishDummyIndices", "[", "termlist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"MultiplyqSecs", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "mytermlist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Oper", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "mytermlist"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ord", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "mytermlist"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"{", 
          RowBox[{"qSec", ",", "Oper", ",", "Ord"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Multiply", " ", "a", " ", "list", " ", "of", " ", "polys", " ", "into", 
     " ", "a", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiplyPolys", "[", "polylist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MultiplyTerms", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", "polylist", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Detect", " ", "Lorentz", " ", "index", " ", "pairs", " ", "of", " ", 
      "the", " ", "type", " ", "in", " ", "\[Nu]list", " ", "in", " ", "a", 
      " ", "term"}], ",", " ", 
     RowBox[{"and", " ", "rewrite", " ", "them", " ", "into", " ", 
      SubscriptBox["\[Mu]", "i"], " ", "pairs"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContractTermIndices", "[", 
      RowBox[{"term_", ",", "\[Nu]list_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "my\[Nu]list", ",", "mylist", ",", "n\[Mu]", ",", "nOpen", ",", 
         "indices", ",", "dummylist", ",", "ndummy", ",", "rules", ",", 
         "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"my\[Nu]list", "=", "\[Nu]list"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "if", " ", "\[Nu]list", " ", "contains", " ", "\"\<\[Mu]\>\""}], 
          ",", " ", 
          RowBox[{"remove", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"my\[Nu]list", ",", "\[Mu]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ContractTermIndices[] called with invalid input \[Nu]list=\>\
\"", ",", "my\[Nu]list"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Mu] is reserved for default dummy indices, and need not be \
further contracted.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"my\[Nu]list", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"my\[Nu]list", ",", "\[Mu]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Proceeding with \[Nu]list=\>\"", ",", "my\[Nu]list"}], "]"}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Put", " ", 
          RowBox[{
          "qSec", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ",
           "and", " ", "Oper", " ", "together", " ", "to", " ", "find", " ", 
          "dummy", " ", "indices", " ", "to", " ", "contract"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
            "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n\[Mu]", "=", 
         RowBox[{
          RowBox[{
          "term", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nOpen", "=", 
         RowBox[{
          RowBox[{
          "term", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{"my\[Nu]list", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "nOpen"}], "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dummylist", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"mylist", ",", 
                  SubscriptBox[
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]], ",", "All"}], "]"}], 
                "\[Equal]", "2"}], ",", 
               RowBox[{"{", 
                SubscriptBox[
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]],
                 "}"}], ",", 
               RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", "indices"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndummy", "=", 
         RowBox[{"Length", "[", "dummylist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rules", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "\[Rule]", 
             SubscriptBox["\[Mu]", 
              RowBox[{"n\[Mu]", "+", "#2"}]]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"dummylist", ",", 
             RowBox[{"Range", "[", "ndummy", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"term", "/.", "rules"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "myterm", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"n\[Mu]", "+", "ndummy"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "myterm", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"nOpen", "-", 
          RowBox[{"2", "ndummy"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Detect", " ", "Lorentz", " ", "index", " ", "pairs", " ", "of", " ", 
      "the", " ", "type", " ", "in", " ", "\[Nu]list", " ", "in", " ", "a", 
      " ", "poly"}], ",", " ", 
     RowBox[{"and", " ", "rewrite", " ", "them", " ", "into", " ", 
      SubscriptBox["\[Mu]", "i"], " ", "pairs"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContractPolyIndices", "[", 
      RowBox[{"poly_", ",", "\[Nu]list_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"my\[Nu]list", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"my\[Nu]list", "=", "\[Nu]list"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "if", " ", "\[Nu]list", " ", "contains", " ", "\"\<\[Mu]\>\""}], 
          ",", " ", 
          RowBox[{"remove", " ", "it"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"my\[Nu]list", ",", "\[Mu]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ContractTermIndices[] called with invalid input \[Nu]list=\>\
\"", ",", "my\[Nu]list"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Mu] is reserved for default dummy indices, and need not be \
further contracted.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"my\[Nu]list", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"my\[Nu]list", ",", "\[Mu]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Proceeding with \[Nu]list=\>\"", ",", "my\[Nu]list"}], "]"}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ContractTermIndices", "[", 
            RowBox[{"#", ",", "my\[Nu]list"}], "]"}], "&"}], "/@", "poly"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007728904987*^9, 3.816007729104987*^9}, {
   3.816008298041788*^9, 3.8160082990417895`*^9}, {3.816015500242739*^9, 
   3.81601550060274*^9}, 3.816108928508152*^9, {3.81620629296196*^9, 
   3.816206293632761*^9}, {3.8162685263404846`*^9, 
   3.8162685271048856`*^9}},ExpressionUUID->"38764350-d5a0-40b1-9a7f-\
56794740bdc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trimmings", "Subsubsection",
 CellChangeTimes->{{3.8160078381121407`*^9, 3.8160078431821475`*^9}, {
  3.8160078803382*^9, 3.8160078821482024`*^9}, {3.816108943480173*^9, 
  3.8161089472911787`*^9}},ExpressionUUID->"c7bdf295-fdfd-40d8-b887-\
12e215d347cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "qPartFVanish", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FTrimqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FTrimTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FTrimPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "qEvenTrimTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "qEvenTrimPoly", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Eta]pairTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Contract\[Eta]Term", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPAllTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPAllPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFpattern0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFpattern1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFrules1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFOrgTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FIndexOrgOper", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "OperIndexOrgTerm", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "All\[Gamma]Pairings", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Trace\[Gamma]Term", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160077299049883`*^9, 3.8160077300849886`*^9}, {
   3.816008324085825*^9, 3.8160083251958265`*^9}, 3.8161089685342083`*^9, {
   3.816206313850396*^9, 3.8162063151919985`*^9}, {3.8162685619241467`*^9, 
   3.8162685634373493`*^9}, {3.8162721629760723`*^9, 
   3.8162721640524745`*^9}},ExpressionUUID->"a64d70ff-6dd2-4a3a-b965-\
d045fc25ce5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "if", " ", "a", " ", "qPart", " ", "vanishes", " ", "upon", 
    " ", "contracting", " ", "with", " ", "a", " ", "given", " ", 
    SubscriptBox["F", "\[Mu]\[Nu]"]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"qPartFVanish", "[", 
      RowBox[{"qPart_", ",", "F\[Mu]pair_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myqPartSplit", ",", "q\[Mu]listArray", ",", "dq\[Mu]listArray", ",", 
         "\[Eta]\[Mu]pairlist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPartSplit", "=", 
         RowBox[{"SplitqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "if", " ", "qPart", " ", "vanishes", " ", "due", " ", 
          "to", " ", 
          SubscriptBox["q", "\[Mu]"], 
          SubscriptBox["q", "\[Nu]"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"q\[Mu]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SubscriptBox["q", "sub__"], "\[Rule]", "sub"}]}], "]"}], "&"}], 
          "/@", "myqPartSplit"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "F\[Mu]pair"}], "]"}], "&"}], "/@", 
             "q\[Mu]listArray"}], ")"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "if", " ", "qPart", " ", "vanishes", " ", "due", " ", 
          "to", " ", 
          SubscriptBox["dq", "\[Mu]"], 
          SubscriptBox["dq", "\[Nu]"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dq\[Mu]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SubscriptBox["dq", "sub__"], "\[Rule]", "sub"}]}], "]"}], "&"}],
           "/@", "myqPartSplit"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "F\[Mu]pair"}], "]"}], "&"}], "/@", 
             "dq\[Mu]listArray"}], ")"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "if", " ", "qPart", " ", "vanishes", " ", "due", " ", 
          "to", " ", 
          SubscriptBox["\[Eta]", "\[Mu]\[Nu]"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]\[Mu]pairlist", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["\[Eta]", "sub__"], "\[Rule]", 
            RowBox[{"{", "sub", "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"\[Eta]\[Mu]pairlist", ",", "F\[Mu]pair"}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"\[Eta]\[Mu]pairlist", ",", 
             RowBox[{"Reverse", "[", "F\[Mu]pair", "]"}]}], "]"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"FTrim", " ", "a", " ", "qSec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FTrimqSec", "[", 
      RowBox[{"qSec_", ",", "F\[Mu]pair_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"qSec", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"qPartFVanish", "[", 
              RowBox[{"#", ",", "F\[Mu]pair"}], "]"}]}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"myqSec", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", "myqSec"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"FTrim", " ", "a", " ", "term"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FTrimTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"F\[Mu]pairlist", ",", "myqSec", ",", "myterm"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"F\[Mu]pairlist", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
            "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            SubscriptBox["F", "a__"], "\[Rule]", 
            RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Fold", "[", 
          RowBox[{"FTrimqSec", ",", 
           RowBox[{
           "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "F\[Mu]pairlist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"FTrim", " ", "a", " ", "poly"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FTrimPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"FTrimTerm", "/@", "poly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Trim", " ", "a", " ", "term", " ", "by", " ", "keeping", " ", "only", 
      " ", "even", " ", "parts", " ", "under", " ", "q"}], "\[Rule]", 
     RowBox[{"-", "q"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qEvenTrimTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myqSec", ",", "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"qEvenTrimqSec", "[", 
          RowBox[{
          "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Trim", " ", "a", " ", "poly", " ", "by", " ", "keeping", " ", "only", 
      " ", "even", " ", "parts", " ", "under", " ", "q"}], "\[Rule]", 
     RowBox[{"-", "q"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qEvenTrimPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"qEvenTrimTerm", "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Contract", " ", "a", " ", "term", " ", "with", " ", "an", " ", 
     SubscriptBox["\[Eta]", "\[Mu]\[Nu]"]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Eta]pairTerm", "[", 
      RowBox[{"term_", ",", "\[Eta]pair_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myOper", ",", "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"myOper", ",", 
             RowBox[{
             "\[Eta]pair", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "All"}], "]"}], "\[Equal]", 
           "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"myOper", "=", 
           RowBox[{"myOper", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\[Eta]pair", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "\[Eta]pair", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"myOper", ",", 
                RowBox[{
                "\[Eta]pair", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "All"}], "]"}], "\[Equal]", 
              "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"myOper", "=", 
              RowBox[{"myOper", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "\[Eta]pair", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{
                 "\[Eta]pair", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myOper", "=", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", 
                    SubscriptBox["\[Eta]", "\[Eta]pair"], "}"}], "}"}], ",", 
                  "myOper"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["\[Eta]", 
                   RowBox[{"{", "a__", "}"}]], "\[Rule]", 
                  SubscriptBox["\[Eta]", "a"]}], "}"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"2", "\[Rule]", "myOper"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Contract", " ", "all", " ", 
     SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], " ", "in", " ", "the", " ", "qSec",
      " ", "of", " ", "a", " ", "term", " ", "with", " ", "its", " ", "Oper", 
     " ", "to", " ", "get", " ", "a", " ", "poly"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Contract\[Eta]Term", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myqSec", ",", "\[Eta]pairsArray", ",", "mypoly"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"1", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"#", ",", 
                SubscriptBox["\[Eta]", "__"]}], "]"}], "}"}], "&"}], "/@", 
            "myqSec"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]pairsArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SubscriptBox["\[Eta]", "a__"], "\[Rule]", 
              RowBox[{"{", "a", "}"}]}]}], "]"}], "&"}], "/@", "myqSec"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Fold", "[", 
             RowBox[{"\[Eta]pairTerm", ",", "#1", ",", "#2"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"mypoly", ",", "\[Eta]pairsArray"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "term", " ", "to", " ", 
     "remove", " ", "one", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper", " ", "to", " ", "get", " ", "a", " ", 
     "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myOper", ",", "len", ",", "myOperArray", ",", "mypoly"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "myOper", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"len", "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "term", "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"myOper", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             SubscriptBox["P", "__"]}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "term", "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myOperArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"myOper", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "\[Rule]", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"myOper", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                   "}"}], ",", 
                  RowBox[{
                  "myOper", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "\[Rule]", 
                RowBox[{"Delete", "[", 
                 RowBox[{
                  RowBox[{"myOper", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "1"}], 
                 "]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"len", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"2", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          "myOperArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "poly", " ", "to", " ", 
     "remove", " ", "one", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"IBPTerm", "/@", "poly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "term", " ", "to", " ", 
     "remove", " ", "all", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper", " ", "to", " ", "get", " ", "a", " ", 
     "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPAllTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nIBP", ",", "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nIBP", "=", 
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
           SubscriptBox["P", "__"]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"{", "term", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Nest", "[", 
          RowBox[{"IBPPoly", ",", "mypoly", ",", "nIBP"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "poly", " ", "to", " ", 
     "move", " ", "all", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPAllPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"IBPAllTerm", "/@", "poly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PPF", " ", "paterns", " ", "and", " ", "their", " ", "simplification", 
     " ", "rules"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PPFpattern0", "=", 
     RowBox[{"Alternatives", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PPFpattern1", "=", 
     RowBox[{"Alternatives", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PPFrules1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            SubscriptBox["P", "\[Nu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a__", ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"-", "1"}], ",", 
            SubscriptBox["P", "\[Nu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[ImaginaryI]"}], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}]}], "}"}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "PPF", " ", "simplification", " ", "rules", " ", "on", " ", 
     "a", " ", "term", " ", "to", " ", "get", " ", "a", " ", "poly"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PPFOrgTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"operArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{
             "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "PPFpattern0"}], "]"}], "\[NotEqual]", " ", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"operArray", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{"#", ",", "PPFpattern1"}], "]"}], ",", "#", ",", 
                RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", 
             RowBox[{
             "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
             ")"}], "/.", "PPFrules1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"2", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          "operArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Organize", " ", "the", " ", "indices", " ", "of", " ", "the", " ", "nth",
      " ", 
     SubscriptBox["F", "\[Mu]\[Nu]"], " ", "in", " ", "an", " ", "Oper"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FIndexOrgOper", "[", 
      RowBox[{"oper_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mylist", ",", "partNolist", ",", "partNo", ",", "\[Mu]pair", ",", 
         "indices", ",", "dummyindices", ",", "\[Mu]pairother", ",", 
         "myOper"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mylist", "=", 
         RowBox[{"Flatten", "[", "oper", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"partNolist", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Tuples", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "oper", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}], "]"}], "]"}]}], "}"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "oper", "]"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"partNo", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"partNolist", ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oper", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "\[RightDoubleBracket]"}], ",", 
                 SubscriptBox["F", "__"]}], "]"}], "&"}], ")"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]pair", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mylist", ",", 
            RowBox[{
             SubscriptBox["F", "a__"], "\[Rule]", 
             RowBox[{"{", "a", "}"}]}]}], "]"}], "\[LeftDoubleBracket]", "n", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"mylist", ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dummyindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"indices", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], "&"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "If", " ", "\[Mu]pair", " ", "are", " ", "not", " ", "both", " ", 
           "dummy", " ", "indices"}], ",", " ", 
          RowBox[{"put", " ", "indices", " ", "in", " ", 
           SubscriptBox["F", "\[Mu]\[Nu]"], " ", "in", " ", "canonical", " ", 
           "order", " ", "using", " ", "its", " ", "antisymmetry"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"SubsetQ", "[", 
            RowBox[{"dummyindices", ",", "\[Mu]pair"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", "\[Mu]pair", "]"}], "===", "\[Mu]pair"}], 
             ",", 
             RowBox[{"Return", "[", "oper", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myOper", "=", 
            RowBox[{"Flatten", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplacePart", "[", 
                RowBox[{"oper", ",", 
                 RowBox[{"partNo", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    SubscriptBox["F", 
                    RowBox[{"Reverse", "[", "\[Mu]pair", "]"}]]}], "}"}]}]}], 
                "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["F", 
                  RowBox[{"{", "a__", "}"}]], "\[Rule]", 
                 SubscriptBox["F", "a"]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "myOper", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "If", " ", "\[Mu]pair", " ", "are", " ", "both", " ", "dummy", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "canonically", " ", "order", " ", "both", " ", "dummy", " ", 
           "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Mu]pairother", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Delete", "[", 
               RowBox[{"oper", ",", "partNo"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"\[Mu]pair", ",", "#"}], "]"}], "&"}], ")"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Mu]pair", "===", "\[Mu]pairother"}], ",", 
          RowBox[{"Return", "[", "oper", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", "\[Mu]pair", "]"}], "=!=", "\[Mu]pair"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myOper", "=", 
            RowBox[{"Flatten", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplacePart", "[", 
                RowBox[{"oper", ",", 
                 RowBox[{"partNo", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    SubscriptBox["F", 
                    RowBox[{"Reverse", "[", "\[Mu]pair", "]"}]]}], "}"}]}]}], 
                "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["F", 
                  RowBox[{"{", "a__", "}"}]], "\[Rule]", 
                 SubscriptBox["F", "a"]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "myOper", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"oper", ",", 
              RowBox[{"partNo", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 SubscriptBox["F", 
                  RowBox[{"Reverse", "[", "\[Mu]pair", "]"}]]}], "}"}]}]}], 
             "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["F", 
               RowBox[{"{", "a__", "}"}]], "\[Rule]", 
              SubscriptBox["F", "a"]}], "}"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"myOper", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myOper", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Organize", " ", "the", " ", "indices", " ", "of", " ", "Oper", " ", "in",
      " ", "a", " ", "term"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OperIndexOrgTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myOper", ",", "indices", ",", "dummyindices", ",", "openindices", 
         ",", "Fpairs", ",", "ndummy", ",", "nopen", ",", "nF", ",", 
         "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "indices", " ", "in", " ", "Oper"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dummyindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"indices", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], "&"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"openindices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"indices", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], "&"}], 
             ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndummy", "=", 
         RowBox[{"Length", "[", "dummyindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nopen", "=", 
         RowBox[{"Length", "[", "openindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"openindices", ",", 
             SubscriptBox["\[Mu]", "_"]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<OperIndexOrgTerm called with open indices containing \
\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\).\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<open indices=\>\"", ",", "openindices"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<term=\>\"", ",", "term"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"canonically", " ", "order", " ", "dummy", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"term", "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "\[Rule]", 
              SubscriptBox["\[Mu]", "#2"]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"dummyindices", ",", 
              RowBox[{"Range", "[", "ndummy", "]"}]}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"canonically", " ", "order", " ", 
          SubscriptBox["F", "\[Mu]\[Nu]"], " ", "indices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{
         "myterm", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nF", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"myOper", ",", 
           SubscriptBox["F", "__"], ",", "All"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Fold", "[", 
          RowBox[{"FIndexOrgOper", ",", "myOper", ",", 
           RowBox[{"Range", "[", "nF", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"myterm", ",", 
           RowBox[{"2", "\[Rule]", "myOper"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "\[Eta]expr", " ", "from", " ", "all", " ", 
     "\[Gamma]", " ", "pairings", " ", 
     RowBox[{"(", 
      RowBox[{"alternating", " ", "pairings"}], ")"}], " ", "of", " ", "an", 
     " ", "even", " ", "number", " ", "of", " ", "indices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"All\[Gamma]Pairings", "[", 
      RowBox[{"{", "}"}], "]"}], ":=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"All\[Gamma]Pairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
     SubscriptBox["\[Eta]", 
      RowBox[{"a", ",", "b"}]]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"All\[Gamma]Pairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b__"}], "}"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"k", "-", "1"}]], 
        SubscriptBox["\[Eta]", 
         RowBox[{"a", ",", 
          RowBox[{
           RowBox[{"{", "b", "}"}], "\[LeftDoubleBracket]", "k", 
           "\[RightDoubleBracket]"}]}]], 
        RowBox[{"All\[Gamma]Pairings", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"{", "b", "}"}], ",", "k"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "term", " ", "to", " ", "get", " ", "a", " ", 
     "poly", " ", "when", " ", "the", " ", "Ulist", " ", "has", " ", "no", 
     " ", "\[Gamma]", " ", "dependence"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Trace\[Gamma]Term", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myOper", ",", "n\[Mu]", ",", "\[Mu]starts", ",", "coeff", ",", 
         "\[Gamma]\[Mu]list", ",", "\[Eta]expr", ",", "\[Eta]pairArray", ",", 
         "coeffArray", ",", "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"replace", " ", "\[Sigma]F", " ", "with", " ", 
          SubscriptBox["\[ImaginaryI]\[Gamma]", "\[Mu]"], 
          SubscriptBox["\[Gamma]", "\[Nu]"], 
          SubscriptBox["F", "\[Mu]\[Nu]"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"n\[Mu]", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
                RowBox[{
                 SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
              RowBox[{
               SubscriptBox["\[Mu]", "b_"], "\[Rule]", "b"}]}], "]"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Mu]starts", "=", 
         RowBox[{"n\[Mu]", "+", 
          RowBox[{"2", "\[Times]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{
              RowBox[{"Accumulate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Count", "[", 
                  RowBox[{"#", ",", "\[Sigma]F"}], "]"}], "&"}], "/@", 
                "myOper"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "/.", 
              RowBox[{"{", 
               RowBox[{"\[Sigma]F", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\[ImaginaryI]", ",", 
                  SubscriptBox["\[Gamma]", 
                   SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "1"}]]], ",", 
                  SubscriptBox["\[Gamma]", 
                   SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "2"}]]], ",", 
                  SubscriptBox["F", 
                   RowBox[{
                    SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "1"}]], ",", 
                    SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "2"}]]}]]}], "}"}]}], "}"}]}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"myOper", ",", "\[Mu]starts"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"extract", " ", "constants", " ", "and", " ", "\[Gamma]"}], 
          ",", " ", 
          RowBox[{
          "and", " ", "carry", " ", "out", " ", "trace", " ", "of", " ", 
           "\[Gamma]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]\[Mu]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
             SubscriptBox["\[Gamma]", "__"]}], "]"}], ",", 
           RowBox[{
            SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]expr", "=", 
         RowBox[{
          RowBox[{"coeff", " ", 
           RowBox[{"All\[Gamma]Pairings", "[", "\[Gamma]\[Mu]list", "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Eta]", 
             RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "\[Rule]", "d"}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]pairArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{"Times", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}], 
            ")"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"\[Eta]expr", "/.", 
             RowBox[{"{", 
              RowBox[{"Plus", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "multiply", " ", "\[Eta]expr", " ", "with", " ", "Oper", " ", "to", 
          " ", "get", " ", "a", " ", "poly"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coeffArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", "d"}]}], "]"}]}], ")"}], 
           "&"}], "/@", "\[Eta]pairArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["\[Gamma]", "__"]}]}], "]"}], "&"}], "/@", 
          "myOper"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "\[Rule]", 
                RowBox[{"ScaleqSec", "[", 
                 RowBox[{
                  RowBox[{
                  "term", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "#"}], "]"}]}], ",", 
               RowBox[{"2", "\[Rule]", "myOper"}]}], "}"}]}], "]"}], "&"}], "/@",
           "coeffArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]pairArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", "d"}]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["\[Eta]", "a__"], "\[Rule]", 
              RowBox[{"{", "a", "}"}]}]}], "]"}], "&"}], "/@", 
          "\[Eta]pairArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Fold", "[", 
             RowBox[{"\[Eta]pairTerm", ",", "#1", ",", "#2"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"mypoly", ",", "\[Eta]pairArray"}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160078360011377`*^9, 3.816007836231138*^9}, {
   3.8160083363488426`*^9, 3.8160083371388435`*^9}, 3.8161090006582537`*^9, {
   3.8162063400896425`*^9, 3.816206345612052*^9}, {3.8162513391741915`*^9, 
   3.8162513401101933`*^9}, {3.816268588444194*^9, 3.816268589395795*^9}, {
   3.816272186142113*^9, 
   3.8162721881077166`*^9}},ExpressionUUID->"fd2c1008-ef7f-4173-978d-\
bc73b1c42f98"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivatives and Integrals", "Subsubsection",
 CellChangeTimes->{{3.8160069212548485`*^9, 3.816006921474849*^9}, 
   3.8160078275601254`*^9, {3.8160078886792116`*^9, 
   3.816007892490217*^9}},ExpressionUUID->"df59bf6f-f431-4a87-a6fb-\
837a698bf05f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "dqAllPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IntegratePoly", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007821789118*^9, 3.816007821959118*^9}, {
   3.8160083572118716`*^9, 3.8160083581118727`*^9}, 3.8161090209712825`*^9, {
   3.816206362631682*^9, 3.8162063650028863`*^9}, {3.8162686106898327`*^9, 
   3.8162686114698343`*^9}, {3.816272219260971*^9, 
   3.8162722201501727`*^9}},ExpressionUUID->"188379d3-bc30-4362-a4fb-\
f1ca146bd118"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Carrying", " ", "out", " ", "all", " ", "the", " ", "dq", " ", 
    "derivatives", " ", "in", " ", "a", " ", "poly"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dqAllPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"dqAllqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Symmetrize", " ", "a", " ", "term", " ", "and", " ", "expand", " ", "in",
      " ", "hard", " ", "region", " ", "to", " ", "get", " ", "a", " ", 
     "poly", " ", "before", " ", "performing", " ", "the", " ", "q", " ", 
     "integral"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardTerm", "[", 
      RowBox[{"term_", ",", "dim_", ",", "Heavylist_", ",", "SoftOrd_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myqSec", ",", "myexprArray", ",", "\[Eta]pairsArray", ",", "myterm", 
         ",", "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "contract", " ", "all", " ", "the", " ", "Lorentz", " ", "indices", 
         " ", "in", " ", "qSec"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myexprArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Times", "@@", "#"}], ")"}], "//.", 
               "\[Eta]ContractionRules"}], ")"}], "/.", "qContractionRules"}],
             ")"}], "&"}], "/@", "myqSec"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myexprArray", "=", 
         RowBox[{
          RowBox[{"myexprArray", "/.", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Eta]", 
              RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], "\[RuleDelayed]", 
             SubscriptBox["\[Eta]", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "]"}]]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Eta]", 
             RowBox[{"{", "a__", "}"}]], "\[Rule]", 
            SubscriptBox["\[Eta]", "a"]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"qPartFromExpr", "[", "#", "]"}], "&"}], "/@", 
          "myexprArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"FTrim", " ", "the", " ", "qSec"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{"FTrimTerm", "[", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "symmetrize", " ", "and", " ", "expand", " ", "in", " ", "hard", " ",
           "region"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SymHardqSec", "[", 
          RowBox[{"myqSec", ",", "Heavylist", ",", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{
             "term", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            "SoftOrd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Contract\[Eta]Term", "[", "myterm", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Symmetrize", " ", "a", " ", "poly"}], ",", " ", 
     RowBox[{"expand", " ", "in", " ", "hard", " ", "region"}], ",", " ", 
     RowBox[{
     "and", " ", "organize", " ", "it", " ", "before", " ", "performing", " ",
       "the", " ", "q", " ", "integral"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardPoly", "[", 
      RowBox[{
      "poly_", ",", "dim_", ",", "Heavylist_", ",", "SoftOrd_", ",", 
       "No\[Gamma]inU_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"SymHardTerm", "[", 
              RowBox[{"#", ",", "dim", ",", "Heavylist", ",", "SoftOrd"}], 
              "]"}], "&"}], "/@", "poly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"IBPAllPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Simplify", " ", "the", " ", "result", " ", "when", " ", "Ulist", 
          " ", "has", " ", "no", " ", "\[Gamma]", " ", "dependence"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"No\[Gamma]inU", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "delete", " ", "terms", " ", "with", " ", "odd", " ", "numbers", 
            " ", "of", " ", 
            SubscriptBox["\[Gamma]", "\[Mu]"], " ", "or", " ", "only", " ", 
            "one", " ", "\[Sigma]F"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mypoly", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"mypoly", ",", 
              RowBox[{
               RowBox[{"EvenQ", "[", 
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  SubscriptBox["\[Gamma]", "__"], ",", "All"}], "]"}], "]"}], 
               "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mypoly", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"mypoly", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    SubscriptBox["\[Gamma]", "__"], ",", "All"}], "]"}], 
                    "\[Equal]", "0"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "\[Sigma]F", ",", "All"}],
                     "]"}], "\[Equal]", "1"}], ")"}]}], ")"}]}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "carry", " ", "out", " ", "trace", " ", "of", " ", "\[Gamma]"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"mypoly", "=", 
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{"Trace\[Gamma]Term", "/@", "mypoly"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mypoly", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"mypoly", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{
                   RowBox[{"{", 
                    SubscriptBox["F", 
                    RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "}"}], "|", 
                   RowBox[{"{", 
                    RowBox[{"__", ",", 
                    SubscriptBox["F", 
                    RowBox[{"\[Mu]_", ",", "\[Mu]_"}]]}], "}"}]}]}], "]"}], 
                "\[Equal]", "0"}], "&"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"organize", " ", "and", " ", "simplify"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"OperIndexOrgTerm", "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"PPFOrgTerm", "/@", "mypoly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"OperIndexOrgTerm", "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carrying", " ", "out", " ", "the", " ", "q", " ", "integral", " ", "of", 
     " ", "a", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegratePoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"IntegrateqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160027725212107`*^9, 3.816002772741211*^9}, {
   3.8160083713038917`*^9, 3.8160083719338923`*^9}, 3.8161090374433055`*^9, {
   3.8162063839101195`*^9, 3.8162063847525206`*^9}, 3.816248799813424*^9, {
   3.816268624074656*^9, 3.8162686247922573`*^9}, {3.816272236639402*^9, 
   3.8162722393538065`*^9}},ExpressionUUID->"99889dd9-6210-468a-9f65-\
afaf4d9aef27"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CDE Quantities", "Subsection",
 CellChangeTimes->{{3.81600701429998*^9, 
  3.8160070253809958`*^9}},ExpressionUUID->"cda4f997-7331-40fc-8f1b-\
3aeb043e6dde"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8160079264542646`*^9, 3.8160079458772926`*^9}, 
   3.81600801542739*^9},ExpressionUUID->"ae6cec36-564b-48b4-b042-\
7d8345edc971"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "The", " ", "CDE", " ", "quantities", " ", "are", " ", "defined", " ", 
    "below"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["U", "i", "CDE"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"n", "=", "0"}], "\[Infinity]"], 
       RowBox[{
        FractionBox["1", 
         RowBox[{"n", "!"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["P", 
            SubscriptBox["\[Mu]", "1"]], "..."}], 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "n"]], 
          SubscriptBox["U", "i"]}], ")"}], 
        SubscriptBox["dq", 
         SubscriptBox["\[Mu]", "1"]]}]}], "..."}], 
     SubscriptBox["dq", 
      SubscriptBox["\[Mu]", "n"]]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["G", 
     RowBox[{
      SubscriptBox["\[Nu]", "i"], 
      SubscriptBox["\[Nu]", "j"]}], "CDE"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "i"}], 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"n", "=", "0"}], "\[Infinity]"], 
        RowBox[{
         FractionBox[
          RowBox[{"n", "+", "1"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "!"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["P", 
             SubscriptBox["\[Mu]", "1"]], "..."}], 
           SubscriptBox["P", 
            SubscriptBox["\[Mu]", "n"]], 
           SubscriptBox["F", 
            RowBox[{
             SubscriptBox["\[Nu]", "i"], 
             SubscriptBox["\[Nu]", "j"]}]]}], ")"}], 
         SubscriptBox["dq", 
          SubscriptBox["\[Mu]", "1"]]}]}]}], "..."}], 
     SubscriptBox["dq", 
      SubscriptBox["\[Mu]", "n"]]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["P", 
     SubscriptBox["\[Nu]", "1"], "CDE"], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["q", 
       SubscriptBox["\[Nu]", "1"]]}], "+", 
     RowBox[{
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "2"]}], "CDE"], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SuperscriptBox["X", "CDE"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "1"]], " ", 
         SubsuperscriptBox["G", 
          RowBox[{
           SubscriptBox["\[Nu]", "1"], 
           SubscriptBox["\[Nu]", "2"]}], "CDE"]}], " ", "+", " ", 
        RowBox[{
         SubsuperscriptBox["G", 
          RowBox[{
           SubscriptBox["\[Nu]", "1"], 
           SubscriptBox["\[Nu]", "2"]}], "CDE"], " ", 
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "1"]]}]}], ")"}], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]]}], " ", "-", " ", 
     RowBox[{
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "2"]}], "CDE"], " ", 
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "3"]}], "CDE"], " ", 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]], " ", 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "3"]]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["q", "2"], "-", 
       SubsuperscriptBox["m", "i", "2"], "-", 
       SuperscriptBox["X", "CDE"]}]], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], "+", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]", "i"], 
          SuperscriptBox["X", "CDE"], 
          SubscriptBox["\[CapitalDelta]", "i"]}], "+", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]", "i"], 
          SuperscriptBox["X", "CDE"], 
          SubscriptBox["\[CapitalDelta]", "i"], 
          SuperscriptBox["X", "CDE"], 
          SubscriptBox["\[CapitalDelta]", "i"]}], "+"}], "..."}], "   ", 
       "with", " ", 
       SubscriptBox["\[CapitalDelta]", "i"]}], "=", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["q", "2"], "-", 
        SubsuperscriptBox["m", "i", "2"]}]]}]}]}], ";"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.8160079186432543`*^9, 3.8160079458772926`*^9}, 
   3.816008033250415*^9, {3.8160319458801994`*^9, 3.816031947370201*^9}, 
   3.816109074610358*^9, {3.8161209468321714`*^9, 3.816120955566671*^9}, 
   3.816123261856216*^9, 3.8162064021465516`*^9, {3.8162686436526904`*^9, 
   3.816268645134693*^9}},ExpressionUUID->"69d289b3-53bf-469e-a667-\
f307d355cd6b"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "i", "CDE"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f1641604-4e80-4bfa-a9de-564802e46e0c"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["G", "\[Mu]\[Nu]", "CDE"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "93f6be34-4ec6-4692-8591-13569d6666b2"]
}], "Subsubsection",
 CellChangeTimes->{{3.816007919553255*^9, 3.8160079197432556`*^9}, {
  3.816007952768302*^9, 
  3.8160079837233458`*^9}},ExpressionUUID->"551674e6-9cac-4ab0-9907-\
c1beb2e1cd92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "UCDEDim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "GCDEDim", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160079204432564`*^9, 3.816007920674257*^9}, {
   3.8160083903179183`*^9, 3.81600839132792*^9}, 3.81610909035338*^9, {
   3.816206418978981*^9, 3.8162064353434095`*^9}, {3.816268664915528*^9, 
   3.8162686657891293`*^9}},ExpressionUUID->"21842918-828f-4d3d-b287-\
a9d88a208908"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Generate", " ", "the", " ", "poly", " ", 
    SubsuperscriptBox["U", "i", "CDE"], " ", "at", " ", "a", " ", "given", 
    " ", "operator", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"UCDEDim", "[", 
      RowBox[{"dim_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Udim", "\[Rule]", "1"}], ",", 
          RowBox[{"Uoper", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Uexpr", ",", "n", ",", "coeff", ",", "UArray", ",", "qSec", ",", 
         "OperArray", ",", "OrdArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Uexpr", "=", 
         RowBox[{"OptionValue", "[", "Uoper", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Uexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Uexpr", "===", 
            RowBox[{"{", "}"}]}], ",", "U", ",", "Uexpr"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Uexpr", "===", "1"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"dim", "\[Equal]", "0"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", "1", "}"}], "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "}"}], 
             "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"dim", "-", 
          RowBox[{"OptionValue", "[", "Udim", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "n", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"n", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         FractionBox["1", 
          RowBox[{"n", "!"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "coeff", "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"dq", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "n"}], "]"}]}]}], "]"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"(", 
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Times", "\[Rule]", "List"}], ",", 
                 RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
                "}"}]}], ")"}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"(", 
             RowBox[{"Uexpr", "/.", 
              RowBox[{"Plus", "\[Rule]", "List"}]}], ")"}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"OrdArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dim", ",", "n", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                    SubscriptBox["__", "a__"], "\[Rule]", 
                    RowBox[{"{", "a", "}"}]}]}], "]"}], "]"}], ",", 
                RowBox[{"_", "?", "NumericQ"}]}], "]"}], "]"}]}], "}"}], 
           "&"}], "/@", "UArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OperArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"P", ",", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", "n", "]"}]}], ",", "#"}], "]"}], "}"}], 
           "&"}], "/@", "UArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qSec", ",", "#1", ",", "#2"}], "}"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"OperArray", ",", "OrdArray"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Generate", " ", "the", " ", "poly", " ", 
     SubsuperscriptBox["G", 
      RowBox[{
       SubscriptBox["\[Nu]", "i"], 
       SubscriptBox["\[Nu]", "j"]}], "CDE"], " ", "at", " ", "a", " ", 
     "given", " ", "operator", " ", "dimension"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GCDEDim", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Nu]i_", ",", "\[Nu]j_"}], "}"}], ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", "coeff", ",", "expr", ",", "qSec", ",", "Oper", ",", "Ord", 
         ",", "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Abort", " ", "if", " ", 
         RowBox[{"{", 
          RowBox[{"\[Nu]i", ",", " ", "\[Nu]j"}], "}"}], " ", "contiains", 
         " ", 
         SubscriptBox["\[Mu]", "__"]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Nu]i", ",", "\[Nu]j"}], "}"}], ",", 
            SubscriptBox["\[Mu]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<GCDEDim[] called with invalid input {\[Nu]i, \[Nu]j}=\>\"", 
             ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]i", ",", "\[Nu]j"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Mu] is reserved for dummy indices and cannot be used as \
open indices for GCDEDim[].\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"dim", "-", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "n", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"n", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], 
          FractionBox[
           RowBox[{"n", "+", "1"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "2"}], ")"}], "!"}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "coeff", "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"dq", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "n"}], "]"}]}]}], "]"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Oper", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"P", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "n"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Subscript", "[", 
              RowBox[{"F", ",", "\[Nu]i", ",", "\[Nu]j"}], "]"}], "}"}]}], 
           "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ord", "=", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "n", ",", "2"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"qSec", ",", "Oper", ",", "Ord"}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007921374258*^9, 3.816007921584258*^9}, {
   3.816008400958933*^9, 3.8160084015389338`*^9}, 3.8161091023753967`*^9, {
   3.8162064312406025`*^9, 3.8162064319894037`*^9}, {3.8162686788463526`*^9, 
   3.816268679439153*^9}},ExpressionUUID->"a3f91c65-5820-4822-a416-\
495060333323"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fc3cdd42-7f22-4a72-95a6-69c0e117e210"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["P", "\[Mu]", "CDE"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "005d59e1-755c-402c-bdf0-7296df5e89b9"]
}], "Subsubsection",
 CellChangeTimes->{{3.8160079233642607`*^9, 3.816007923544261*^9}, 
   3.8160079574793086`*^9, {3.816007992484358*^9, 
   3.8160080069363785`*^9}},ExpressionUUID->"644d597e-91a5-4683-94ff-\
2d8d46323a58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "XCDEDim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]XStrDimPar", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]XStrnX", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]CDEDimGen", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Load\[CapitalDelta]CDEPolyCache", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]CDEDim", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PCDEDim", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81600691496384*^9, 3.816006915653841*^9}, {
   3.8160084174619565`*^9, 3.816008418361958*^9}, 3.816109121818424*^9, {
   3.8162064489778337`*^9, 3.816206473048676*^9}, {3.816268696973584*^9, 
   3.8162686978159857`*^9}},ExpressionUUID->"72807c16-161b-441f-850a-\
0fe088c296bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Generate", " ", "the", " ", "poly", " ", 
     SuperscriptBox["X", "CDE"]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "1"]], 
         SubsuperscriptBox["G", 
          RowBox[{
           SubscriptBox["\[Nu]", "1"], 
           SubscriptBox["\[Nu]", "2"]}], "CDE"]}], "+", 
        RowBox[{
         SubsuperscriptBox["G", 
          RowBox[{
           SubscriptBox["\[Nu]", "1"], 
           SubscriptBox["\[Nu]", "2"]}], "CDE"], 
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "1"]]}]}], ")"}], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]]}], "-", 
     RowBox[{
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "2"]}], "CDE"], 
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "3"]}], "CDE"], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "3"]], " ", "at", " ", "a", " ", "given", " ", 
      "operator", " ", "dimension"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"XCDEDim", "[", "dim_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "polyT1", ",", "polyT2", ",", "polyT3", ",", "polyArray", ",", 
         "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", "2"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"the", " ", "firt", " ", "two", " ", "terms", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", 
              SubscriptBox["\[Nu]", "1"]], 
             SubsuperscriptBox["G", 
              RowBox[{
               SubscriptBox["\[Nu]", "1"], 
               SubscriptBox["\[Nu]", "2"]}], "CDE"]}], "+", 
            RowBox[{
             SubsuperscriptBox["G", 
              RowBox[{
               SubscriptBox["\[Nu]", "1"], 
               SubscriptBox["\[Nu]", "2"]}], "CDE"], 
             SubscriptBox["q", 
              SubscriptBox["\[Nu]", "1"]]}]}], ")"}], 
          SubscriptBox["dq", 
           SubscriptBox["\[Nu]", "2"]]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"polyT1", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["q", 
               SubscriptBox["\[Nu]", "1"]], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT2", "=", 
         RowBox[{"GCDEDim", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Nu]", "1"], ",", 
             SubscriptBox["\[Nu]", "2"]}], "}"}], ",", "dim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT3", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["dq", 
               SubscriptBox["\[Nu]", "2"]], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SumPolys", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MultiplyPolys", "[", 
             RowBox[{"{", 
              RowBox[{"polyT1", ",", "polyT2", ",", "polyT3"}], "}"}], "]"}], 
            ",", 
            RowBox[{"MultiplyPolys", "[", 
             RowBox[{"{", 
              RowBox[{"polyT2", ",", "polyT1", ",", "polyT3"}], "}"}], 
             "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"ContractPolyIndices", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{"{", "\[Nu]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"the", " ", "last", " ", "term"}], " ", "-", 
          RowBox[{
           SubsuperscriptBox["G", 
            RowBox[{
             SubscriptBox["\[Nu]", "1"], 
             SubscriptBox["\[Nu]", "2"]}], "CDE"], 
           SubsuperscriptBox["G", 
            RowBox[{
             SubscriptBox["\[Nu]", "1"], 
             SubscriptBox["\[Nu]", "3"]}], "CDE"], 
           SubscriptBox["dq", 
            SubscriptBox["\[Nu]", "2"]], 
           SubscriptBox["dq", 
            SubscriptBox["\[Nu]", "3"]]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MultiplyPolys", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GCDEDim", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["\[Nu]", "1"], ",", 
                  SubscriptBox["\[Nu]", "2"]}], "}"}], ",", "#"}], "]"}], ",", 
              RowBox[{"GCDEDim", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["\[Nu]", "1"], ",", 
                  SubscriptBox["\[Nu]", "3"]}], "}"}], ",", 
                RowBox[{"dim", "-", "#"}]}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"2", ",", 
            RowBox[{"dim", "-", "2"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT1", "=", 
         RowBox[{"SumPolys", "[", "polyArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT2", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               SubscriptBox["dq", 
                SubscriptBox["\[Nu]", "2"]], ",", 
               SubscriptBox["dq", 
                SubscriptBox["\[Nu]", "3"]]}], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT3", "=", 
         RowBox[{"MultiplyPolys", "[", 
          RowBox[{"{", 
           RowBox[{"polyT1", ",", "polyT2"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT3", "=", 
         RowBox[{"ContractPolyIndices", "[", 
          RowBox[{"polyT3", ",", 
           RowBox[{"{", "\[Nu]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"sum", " ", "the", " ", "above", " ", "terms"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SumPolys", "[", 
          RowBox[{"{", 
           RowBox[{"mypoly", ",", "polyT3"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Compute", " ", "the", " ", "poly", " ", 
       SubscriptBox["\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"]}], "..."}], 
     SubscriptBox["X\[CapitalDelta]", "i"], " ", "for", " ", "a", " ", 
     "given", " ", "dimpar", " ", "of", " ", "X"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]XStrDimPar", "[", 
      RowBox[{"imass_", ",", "dimpar_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polyDelta", ",", "polyArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polyDelta", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["\[CapitalDelta]", "imass"], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MultiplyPolys", "[", 
            RowBox[{"{", 
             RowBox[{"polyDelta", ",", 
              RowBox[{"XCDEDim", "[", "#", "]"}]}], "}"}], "]"}], "&"}], "/@",
           "dimpar"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MultiplyPolys", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"polyArray", ",", 
            RowBox[{"{", "polyDelta", "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Compute", " ", "the", " ", "poly", " ", 
       SubscriptBox["\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"]}], "..."}], 
     SubscriptBox["X\[CapitalDelta]", "i"], " ", "with", " ", "nX", " ", "of",
      " ", "X", " ", "at", " ", "a", " ", "given", " ", "operator", " ", 
     "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]XStrnX", "[", 
      RowBox[{"imass_", ",", "nX_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mydimparlist", ",", "polyArray", ",", "mypoly"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", 
             RowBox[{"2", "nX"}]}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mydimparlist", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Permutations", "/@", 
             RowBox[{"IntegerPartitions", "[", 
              RowBox[{
               RowBox[{"dim", "-", "nX"}], ",", 
               RowBox[{"{", "nX", "}"}]}], "]"}]}], ",", "1"}], "]"}], "+", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]XStrDimPar", "[", 
            RowBox[{"imass", ",", "#"}], "]"}], "&"}], "/@", 
          "mydimparlist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SumPolys", "[", "polyArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Generate", " ", "the", " ", "poly", " ", 
      SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "i"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], 
         SuperscriptBox["X", "CDE"], 
         SubscriptBox["\[CapitalDelta]", "i"]}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], 
         SuperscriptBox["X", "CDE"], 
         SubscriptBox["\[CapitalDelta]", "i"], 
         SuperscriptBox["X", "CDE"], 
         SubscriptBox["\[CapitalDelta]", "i"]}], "+"}], "..."}], " ", "at", 
      " ", "a", " ", "given", " ", "operator", " ", "dimension"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]CDEDimGen", "[", 
      RowBox[{"imass_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polyArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]XStrnX", "[", 
            RowBox[{"imass", ",", "#", ",", "dim"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Floor", "[", 
             RowBox[{"dim", "/", "2"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SumPolys", "[", "polyArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Load", " ", "the", " ", "quantity", " ", "\[CapitalDelta]CDEPolyCache", 
      " ", "that", " ", "stores", " ", "the", " ", "pre"}], "-", 
     RowBox[{"evaluated", " ", "\[CapitalDelta]CDE", " ", "polys"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Load\[CapitalDelta]CDEPolyCache", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]CDEPolyCache", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]CDEDimGen", "[", 
            RowBox[{"1", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "10"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Get", " ", "the", " ", "poly", " ", 
     SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], " ", "at", " ", "a", 
     " ", "given", " ", "operator", " ", "dimension"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]CDEDim", "[", 
      RowBox[{"imass_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"ValueQ", "[", "\[CapitalDelta]CDEPolyCache", "]"}]}], 
            ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", ">", "10"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"\[CapitalDelta]CDEDimGen", "[", 
            RowBox[{"imass", ",", "dim"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"\[CapitalDelta]CDEPolyCache", "\[LeftDoubleBracket]", 
           RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "1"], "\[Rule]", 
            SubscriptBox["\[CapitalDelta]", "imass"]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Generate", " ", "the", " ", "poly", " ", 
      SubsuperscriptBox["P", 
       SubscriptBox["\[Nu]", "i"], "CDE"]}], "=", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["q", 
        SubscriptBox["\[Nu]", "i"]]}], "+", 
      RowBox[{
       SubsuperscriptBox["G", 
        RowBox[{
         SubscriptBox["\[Nu]", "i"], 
         SubscriptBox["\[Nu]", "0"]}], "CDE"], 
       SubscriptBox["dq", 
        SubscriptBox["\[Nu]", "0"]], " ", "at", " ", "a", " ", "given", " ", 
       "operator", " ", "dimension"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PCDEDim", "[", 
      RowBox[{"\[Nu]i_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polyT1", ",", "polyT2", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Abort", " ", "if", " ", "\[Nu]i", " ", "is", " ", 
         SubscriptBox["\[Mu]", "__"]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"\[Nu]i", ",", 
            SubscriptBox["\[Mu]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<PCDEDim[] called with invalid input \[Nu]i=\>\"", ",", 
             "\[Nu]i"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Mu] is reserved for dummy indices and cannot be used as \
open indices for PCDEDim[].\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 SubscriptBox["q", "\[Nu]i"]}], "}"}], "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"polyT1", "=", 
         RowBox[{"GCDEDim", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Nu]i", ",", 
             SubscriptBox["\[Nu]", "0"]}], "}"}], ",", "dim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyT2", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["dq", 
               SubscriptBox["\[Nu]", "0"]], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MultiplyPolys", "[", 
          RowBox[{"{", 
           RowBox[{"polyT1", ",", "polyT2"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"ContractPolyIndices", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{"{", "\[Nu]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007032793006*^9, 3.8160070329830065`*^9}, {
   3.816008429833974*^9, 3.816008430963976*^9}, 3.816109140691451*^9, {
   3.8162064679786673`*^9, 3.8162064690238686`*^9}, {3.8162687176436205`*^9, 
   3.8162687183768215`*^9}},ExpressionUUID->"ee002501-f39e-4524-ad0a-\
61b5b06545d6"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Supertrace Manipulations", "Subsection",
 CellChangeTimes->{{3.816007030722003*^9, 
  3.8160070594470434`*^9}},ExpressionUUID->"6a7ecdc7-48e4-4374-9591-\
f45918c2c25f"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.816008052933443*^9, 3.816008071196469*^9}, 
   3.8160081352855587`*^9},ExpressionUUID->"ad2752cf-bc7d-465d-a31f-\
b462801143a3"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "STrEAM", " ", "evaluates", " ", "functional", " ", "supertraces", " ", 
       "of", " ", "the", " ", "form"}], "\[IndentingNewLine]", "  ", "-", 
      RowBox[{"iSTr", "[", "f", "]"}]}], 
     SubscriptBox["|", "hard"]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "where", " ", "f", " ", "a", " ", "product", " ", "sequence", " ", "of", 
     " ", 
     SubscriptBox["P", "\[Mu]"]}]}], ",", " ", 
   SubscriptBox["U", "k"], ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "i"], " ", "and", " ", 
    SubscriptBox["\[CapitalLambda]", "i"]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "consisting", " ", "of", " ", "an", " ", "arbitrary", " ", "number", " ",
       "of", " ", "\"\<propagator blocks\>\"", "\[IndentingNewLine]", "f"}], 
     "=", 
     RowBox[{"[", " ", 
      RowBox[{
       RowBox[{"...", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["P", 
            SubscriptBox["\[Mu]", "1"], "CDE"], "..."}], 
          SubsuperscriptBox["P", 
           SubscriptBox["\[Mu]", "n"], "CDE"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], " ", "or", " ", 
          SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["P", 
            SubscriptBox["\[Nu]", "1"], "CDE"], "..."}], 
          SubsuperscriptBox["P", 
           SubscriptBox["\[Nu]", "m"], "CDE"]}], ")"}], 
        SubsuperscriptBox["U", "k", "CDE"]}], " ", "..."}], " ", "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
    "where", " ", "the", " ", "propagator", " ", "can", " ", "be", " ", 
     "either", " ", "bosonic", " ", 
     SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}]}], ",", " ", 
   RowBox[{
    RowBox[{"or", " ", "fermionic", " ", 
     SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], ";", " ", 
    RowBox[{"the", " ", "last", " ", 
     SubsuperscriptBox["U", "k", "CDE"], " ", "factor", " ", "is", " ", 
     "allowed", " ", "to", " ", "be", " ", "absent"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Fermionic", " ", "propagators", " ", "are", " ", "addressed", " ", "by",
       "\[IndentingNewLine]", " ", 
      SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Pslash", "-", 
        SubscriptBox["m", "i"]}]], "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["P", "2"], "-", 
          SubsuperscriptBox["m", "i", "2"], "-", "\[CapitalSigma]"}]], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "i"], "+", 
          RowBox[{
           SubscriptBox["P", "\[Rho]"], 
           SubscriptBox["\[Gamma]", "\[Rho]"]}]}], ")"}]}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], "+", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
            SuperscriptBox["\[CapitalSigma]", "CDE"], 
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
            SuperscriptBox["\[CapitalSigma]", "CDE"], 
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
            SuperscriptBox["\[CapitalSigma]", "CDE"], 
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "+"}], 
          "..."}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "i"], "+", 
          RowBox[{
           SubscriptBox["P", "\[Rho]"], 
           SubscriptBox["\[Gamma]", "\[Rho]"]}]}], ")"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"with", "\[IndentingNewLine]", "\[CapitalSigma]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       SuperscriptBox["\[Sigma]", "\[Alpha]\[Beta]"], 
       SubscriptBox["F", "\[Alpha]\[Beta]"]}], "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "\[Sigma]F"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "We", " ", "call", " ", "the", " ", "supertrace", " ", "\"\<bosonic\>\"", 
     " ", "when", " ", "it", " ", "contains", " ", "no", " ", "fermionic", 
     " ", "propagators"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
    "Mandatory", " ", "input", " ", "parameters", " ", "for", " ", "the", " ",
      "main", " ", "function", " ", 
     RowBox[{"SuperTrace", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "dim", "          ", "Desired", " ", "operator", " ", "dimension", " ", 
     "in", " ", "the", " ", "result"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "flist", "        ", "Functional", " ", "operator", " ", "f", " ", "to", 
     " ", "trace", " ", "over"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Options", " ", "for", " ", "the", " ", "main", " ", "function", " ", 
     RowBox[{"SuperTrace", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Udimlist", "     ", "default", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "...", ",", "1"}], "}"}], "    ", "Minimum", " ", 
     "operator", " ", "dimensions", " ", "of", " ", 
     RowBox[{"{", 
      SubscriptBox["U", "k"], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Heavylist", "    ", "default", "    ", 
     RowBox[{"{", "1", "}"}], "       ", "Heavy", " ", "mass", " ", 
     "labels"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "SoftOrd", "      ", "default", "     ", "0", "        ", "Additional", 
     " ", "power", 
     RowBox[{"(", "s", ")"}], " ", "of", " ", 
     RowBox[{
      SubscriptBox["m", "light"], "/", 
      SubscriptBox["m", "heavy"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "No\[Gamma]inU", "       ", "default", "   ", "False", "      ", "No", 
     " ", "Dirac", " ", "matrices", " ", 
     SubscriptBox["\[Gamma]", "\[Mu]"], " ", "in", " ", 
     RowBox[{"{", 
      SubscriptBox["U", "k"], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "display", "      ", "default", "   ", "False", "      ", "Print", " ", 
     "result"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "Alternatively"}], ",", " ", 
   RowBox[{
   "one", " ", "can", " ", "use", " ", "the", " ", "function", " ", 
    "SuperTraceFromExpr"}], ",", " ", 
   RowBox[{
    RowBox[{
    "which", " ", "takes", " ", "an", " ", "expression", " ", "fexpr", " ", 
     "as", " ", "input", " ", "for", " ", "the", " ", "functional", " ", 
     "operator", " ", "f"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "The", " ", "set", " ", "of", " ", "underlying", " ", "supertrace", " ", 
     "\"\<parameters\>\"", " ", "for", " ", "the", " ", "functional", " ", 
     "operator", " ", "f", " ", 
     RowBox[{"(", 
      RowBox[{
      "only", " ", "used", " ", "in", " ", "private", " ", "context"}], 
      ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "masslabels", "   ", "List", " ", "of", " ", "propagator", " ", 
     "masses"}]}], ",", " ", 
   RowBox[{
    RowBox[{"namely", " ", "the", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["i", "1"], ",", 
       SubscriptBox["i", "2"], ",", "..."}], "}"}], " ", "in", " ", "f"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "typelist", "     ", "List", " ", "of", " ", "propagator", " ", 
      "types"}], " ", "+", 
     RowBox[{"1", " ", "for", " ", 
      SubscriptBox["\[CapitalDelta]", "i"]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], " ", "or", " ", 
     SubscriptBox["\[CapitalLambda]", "i"]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "coeff", "        ", "Coefficient", " ", "multiplying", " ", "the", " ", 
     "supertrace"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Ulist", "        ", "List", " ", "of", " ", 
     SubscriptBox["U", "k"], " ", "factors"}]}], ",", " ", 
   RowBox[{
    RowBox[{"with", " ", "default", " ", "value", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["U", "1"], ",", 
       SubscriptBox["U", "2"], ",", 
       SubscriptBox["U", "3"], ",", "..."}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Plocations", "   ", "List", " ", "of", " ", "locations", " ", "of", " ", 
     SubsuperscriptBox["P", 
      SubscriptBox["\[Nu]", "i"], "CDE"]}]}], ",", " ", 
   RowBox[{
    RowBox[{"with", " ", "-", 
     RowBox[{"n", 
      RowBox[{"(", 
       RowBox[{"+", "n"}], ")"}], " ", "indicating", " ", "before", 
      RowBox[{"(", "after", ")"}], " ", "the", " ", "nth", " ", 
      "propagator"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Pindices", "     ", "List", " ", "of", " ", "Lorentz", " ", "indices", 
     " ", 
     SubscriptBox["\[Nu]", "i"], " ", "in", " ", "the", " ", "open", " ", 
     "covariant", " ", "derivatives", " ", 
     SubsuperscriptBox["P", 
      SubscriptBox["\[Nu]", "i"], "CDE"]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Udimlist", "     ", "List", " ", "of", " ", "minimum", " ", "operator", 
     " ", "dimensions", " ", "of", " ", 
     RowBox[{"{", 
      SubscriptBox["U", "k"], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.816008053813444*^9, 3.816008071196469*^9}, 
   3.81600812888455*^9, {3.8160306428873634`*^9, 3.8160307299604855`*^9}, {
   3.816030762335531*^9, 3.8160308122646017`*^9}, {3.8160309478357925`*^9, 
   3.8160309914638543`*^9}, {3.816031023417899*^9, 3.81603103123991*^9}, {
   3.8160310802189794`*^9, 3.816031098762006*^9}, 3.816031131237051*^9, {
   3.8160320835913935`*^9, 3.8160320854213953`*^9}, {3.8160326388721757`*^9, 
   3.8160326417921796`*^9}, {3.816109250268605*^9, 3.8161092617206216`*^9}, 
   3.816110417943656*^9, {3.816121004248455*^9, 3.8161210219684687`*^9}, 
   3.816121115656827*^9, 3.816206491987109*^9, {3.8162687536484833`*^9, 
   3.8162687548184853`*^9}, {3.816277818356944*^9, 
   3.816277819526945*^9}},ExpressionUUID->"55f5f427-aa2a-4041-b005-\
a4cb4a70cf0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bosonic Supertrace CDE Poly Generation", "Subsubsection",
 CellChangeTimes->{{3.816008040851426*^9, 3.8160080411214266`*^9}, {
  3.8160080761874757`*^9, 
  3.816008098990508*^9}},ExpressionUUID->"42f376e2-aa8c-46d0-9887-\
694db618bc6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "STrPrint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "STrParameters", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "STrBflists", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "STrflistUFrame", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "DimparsBSTrDim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "BSTrPolyDimPar", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "BSTrPolyGen", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816008041971428*^9, 3.8160080421614275`*^9}, {
   3.816008454268008*^9, 3.8160084553580103`*^9}, 3.816110436355682*^9, {
   3.816206514825549*^9, 3.816206515917551*^9}, {3.816268787391343*^9, 
   3.816268788561345*^9}},ExpressionUUID->"9405443e-4adb-4d8e-8552-\
8715e7d83fb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "the", " ", "input", " ", "supertrace"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"STrPrint", "[", "flist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mylist", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mylist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Times", "\[Rule]", "List"}], ",", 
                  RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
                 "}"}]}], "]"}], "}"}], "]"}], "&"}], "/@", "flist"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{"Select", "[", 
               RowBox[{"mylist", ",", "NumericQ"}], "]"}], ")"}]}], "}"}], 
           ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"mylist", ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "mylist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===",
            "1"}], ",", 
          RowBox[{"mylist", "=", 
           RowBox[{"mylist", "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "mylist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"mylist", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"mylist", ",", 
             RowBox[{"1", "\[Rule]", "\"\<-\>\""}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"mylist", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "i_"], "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "0"}], ",", 
               FractionBox["1", 
                SuperscriptBox["P", "2"]], ",", 
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox["P", "2"], "-", 
                 SubsuperscriptBox["m", "i", "2"]}]]}], "]"}]}], ",", 
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "j_"], "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "\[Equal]", "0"}], ",", 
               "\"\<\!\(\*FractionBox[\(1\), \(\(Pslash\)\(\\\ \)\)]\)\>\"", 
               ",", 
               FractionBox["1", 
                RowBox[{"Pslash", " ", "-", " ", 
                 SubscriptBox["m", "j"]}]]}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<-iSTr[\>\"", "}"}], ",", "mylist", ",", 
           RowBox[{
           "{", "\"\<]\!\(\*SubscriptBox[\(|\), \(hard\)]\)\>\"", "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Row", "[", "mylist", "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "set", " ", "of", " ", "underlying", " ", 
     "supertrace", " ", "\"\<parameters\>\"", " ", "for", " ", "flist"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STrParameters", "[", 
      RowBox[{"flist_", ",", "Udimlist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myflist", ",", "masslabels", ",", "mytypelist", ",", 
         "my\[CapitalDelta]split", ",", "mycoeff", ",", "Ucoefflist", ",", 
         "Uoperlist", ",", "myUlist", ",", "myUdimlist", ",", 
         "myP\[CapitalDelta]PUlist", ",", "myP\[CapitalDelta]PUsplit", ",", 
         "myPlocations", ",", "myPindices", ",", "myParameters"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"canonicalize", " ", "flist", " ", "into", " ", "myflist"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myflist", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Times", "\[Rule]", "List"}], ",", 
                   RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
                  "}"}]}], "]"}], "}"}], "]"}], "&"}], "/@", "flist"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "myflist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}]}], ",", 
          RowBox[{"myflist", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"myflist", ",", "1", ",", "1"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"masslabels", " ", "and", " ", "propagator", " ", "types"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"masslabels", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "i_"], "|", 
             SubscriptBox["\[CapitalLambda]", "i_"]}], "\[Rule]", "i"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mytypelist", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"myflist", ",", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "__"], "|", 
             SubscriptBox["\[CapitalLambda]", "__"]}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "__"], "\[Rule]", "1"}], ",", 
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "__"], "\[Rule]", 
             RowBox[{"-", "1"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"masslabels", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<No propagators detected in the input flist.\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"coeff", ",", " ", "Ulist", ",", " ", 
          RowBox[{"and", " ", "Udimlist"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SequenceCount", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{"myflist", ",", 
                RowBox[{
                 RowBox[{"_", "?", "NumericQ"}], "|", 
                 SubscriptBox["m", "__"], "|", 
                 SubscriptBox["\[Eta]", "__"], "|", 
                 SubscriptBox["\[Gamma]", "__"], "|", 
                 SubscriptBox["P", "__"]}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalDelta]", "__"], "|", 
                 SubscriptBox["\[CapitalLambda]", "__"]}], "\[Rule]", 
                "\[CapitalDelta]"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalDelta]", ",", "\[CapitalDelta]"}], "}"}]}], 
            "]"}], ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Missing U factor between \[CapitalDelta]|\[CapitalLambda] in \
the input flist.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"my\[CapitalDelta]split", "=", 
         RowBox[{"Split", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"#2", ",", 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "__"], "|", 
                SubscriptBox["\[CapitalLambda]", "__"]}]}], "]"}]}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mycoeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
            "my\[CapitalDelta]split", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            SubscriptBox["P", "__"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"my\[CapitalDelta]split", "=", 
         RowBox[{"my\[CapitalDelta]split", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ucoefflist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", 
                SubscriptBox["m", "__"], "|", 
                SubscriptBox["\[Eta]", "__"]}]}], "]"}]}], ")"}], "&"}], "/@",
           "my\[CapitalDelta]split"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Uoperlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "__"], "|", 
              SubscriptBox["\[Eta]", "__"], "|", 
              SubscriptBox["\[CapitalDelta]", "__"], "|", 
              SubscriptBox["\[CapitalLambda]", "__"], "|", 
              SubscriptBox["P", "__"]}]}], "]"}], "&"}], "/@", 
          "my\[CapitalDelta]split"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Uoperlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
             RowBox[{"#", "/.", 
              RowBox[{"List", "\[Rule]", "NonCommutativeMultiply"}]}], ",", 
             RowBox[{"#", "/.", 
              RowBox[{"List", "\[Rule]", "Times"}]}]}], "]"}], "&"}], "/@", 
          "Uoperlist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myUlist", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"Ucoefflist", ",", "Uoperlist"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "Udimlist", "]"}], "\[NotEqual]", "0"}], 
            ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "Udimlist", "]"}], "\[NotEqual]", 
             RowBox[{"Length", "[", "myUlist", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Mismatch between the length of U and Udim: Ulist=\>\"", ",", 
             "myUlist", ",", "\"\<, Udimlist=\>\"", ",", "Udimlist"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Udimlist", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"myUdimlist", "=", 
           RowBox[{
            RowBox[{"1", "&"}], "/@", "myUlist"}]}], ",", 
          RowBox[{"myUdimlist", "=", "Udimlist"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "myUlist", "]"}], "===", "1"}], ",", 
          RowBox[{
           RowBox[{"myUdimlist", "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", "0"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Plocations", " ", "and", " ", "Pindices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myP\[CapitalDelta]PUlist", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"myflist", ",", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], "|", 
             SubscriptBox["m", "__"], "|", 
             SubscriptBox["\[Eta]", "__"], "|", 
             SubscriptBox["\[Gamma]", "__"]}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", "__"], "\[Rule]", "P"}], ",", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "__"], "|", 
              SubscriptBox["\[CapitalLambda]", "__"]}], "\[Rule]", 
             "\[CapitalDelta]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myP\[CapitalDelta]PUsplit", "=", 
         RowBox[{"Split", "[", 
          RowBox[{"myP\[CapitalDelta]PUlist", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"\[CapitalDelta]", "|", "P"}]}], "]"}], "||", 
              RowBox[{"!", 
               RowBox[{"MatchQ", "[", 
                RowBox[{"#2", ",", 
                 RowBox[{"\[CapitalDelta]", "|", "P"}]}], "]"}]}]}], ")"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myP\[CapitalDelta]PUsplit", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"P", "|", "\[CapitalDelta]"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"P", "\[Rule]", "0"}], ",", 
                RowBox[{"\[CapitalDelta]", "\[Rule]", "#2"}]}], "}"}]}], 
             ")"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"myP\[CapitalDelta]PUsplit", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "myP\[CapitalDelta]PUsplit", "]"}], 
              "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myPlocations", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Accumulate", "[", "#", "]"}], "-", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Accumulate", "[", 
                  RowBox[{"Reverse", "[", "#", "]"}], "]"}], "]"}]}], ",", 
               "0"}], "]"}], "&"}], "/@", "myP\[CapitalDelta]PUsplit"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myPindices", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            SubscriptBox["P", "\[Nu]_"], "\[Rule]", "\[Nu]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "put", " ", "all", " ", "the", " ", "inputs", " ", "together"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myParameters", "=", 
         RowBox[{"{", 
          RowBox[{
          "masslabels", ",", "mytypelist", ",", "mycoeff", ",", "myUlist", 
           ",", "myPlocations", ",", "myPindices", ",", "myUdimlist"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myParameters", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "set", " ", "of", " ", "bosonic", " ", "flists", 
     " ", "from", " ", "a", " ", "given", " ", "flist"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STrBflists", "[", 
      RowBox[{"flist_", ",", "n\[CapitalSigma]cap_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myParameters", ",", "bflistTuples", ",", "\[Rho]shiftArray", ",", 
         "bflistArray"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bflistTuples", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{"#", ",", 
                  SubscriptBox["\[CapitalLambda]", "__"]}], "]"}], ",", "#", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", "#", "}"}], "}"}]}], "]"}], "&"}], "/@", 
             "flist"}], ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "i_"], "\[RuleDelayed]", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Tuples", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NestList", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ",", "\[Sigma]F", ",", 
                    SubscriptBox["\[CapitalDelta]", "i"]}], "}"}]}], "]"}], 
                    "&"}], ",", 
                   RowBox[{"{", 
                    SubscriptBox["\[CapitalDelta]", "i"], "}"}], ",", 
                   "n\[CapitalSigma]cap"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["m", "i"], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["P", 
                    SubscriptBox["\[Rho]", "0"]], ",", "1", ",", 
                    SubscriptBox["\[Gamma]", 
                    SubscriptBox["\[Rho]", "0"]]}], "}"}]}], "}"}], ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["m", "0"]}], "]"}], "&"}], ")"}]}]}], 
                  "]"}]}], "}"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]shiftArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{
              RowBox[{"Accumulate", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["\[Rho]", "0"], ",", "All"}], "]"}], "&"}], "/@",
                   "#"}], ")"}], "\[LeftDoubleBracket]", 
                RowBox[{";;", 
                 RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
              "2"}]}], "]"}], "&"}], "/@", "bflistTuples"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["\[Rho]", "0"], "\[Rule]", 
                   SubscriptBox["\[Rho]", 
                    RowBox[{"#2", "+", "1"}]]}], "}"}]}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"bflistTuples", ",", "\[Rho]shiftArray"}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"bflistArray", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"#", ",", "\[Sigma]F"}], "]"}], "\[LessEqual]", 
              "n\[CapitalSigma]cap"}], ")"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "bflistArray", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Obtain", " ", "the", " ", "UFrame", " ", "of", " ", "flist"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STrflistUFrame", "[", 
      RowBox[{
      "masslabels_", ",", "typelist_", ",", "coeff_", ",", "Plocations_", ",",
        "Pindices_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myUlist", ",", "\[CapitalDelta]lsit", ",", "\[CapitalDelta]Ulist", 
         ",", "poslist", ",", "Porders", ",", "myflist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myUlist", "=", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "#"], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "masslabels", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]lsit", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#2", ">", "0"}], ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"\[CapitalDelta]", ",", "#1"}], "]"}], ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"\[CapitalLambda]", ",", "#1"}], "]"}]}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"masslabels", ",", "typelist"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Ulist", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"\[CapitalDelta]lsit", ",", "myUlist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poslist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0"}], ",", 
              RowBox[{"2", "#"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "#"}], "-", "1"}]}], "]"}], "}"}], "&"}], 
          "/@", "Plocations"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myflist", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"\[CapitalDelta]Ulist", ",", "P", ",", "poslist"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Porders", "=", 
         RowBox[{"Accumulate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "===", "P"}], ",", "1", ",", "0"}], "]"}], "&"}], "/@",
            "myflist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myflist", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#1", "===", "P"}], ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"P", ",", 
                RowBox[{
                "Pindices", "\[LeftDoubleBracket]", "#2", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", "#1"}], "]"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"myflist", ",", "Porders"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myflist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "coeff", "}"}], ",", "myflist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myflist", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "list", " ", "of", " ", "dimension", " ", 
     "partitions", " ", "of", " ", "a", " ", "given", " ", "dim", " ", "for", 
     " ", "a", " ", "bosonic", " ", "supertrace"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DimparsBSTrDim", "[", 
      RowBox[{
      "dim_", ",", "masslabels_", ",", "Plocations_", ",", "Udimlist_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]mindim", ",", "Umindim", ",", "mindimlist", ",", 
         "poslist", ",", "ULastdim", ",", "dimparshift", ",", "dimeff", ",", 
         "mydimparlist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]mindim", "=", 
         RowBox[{
          RowBox[{"0", "&"}], "/@", "masslabels"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Umindim", "=", "Udimlist"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindimlist", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"\[CapitalDelta]mindim", ",", "Umindim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poslist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0"}], ",", 
              RowBox[{"2", "#"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "#"}], "-", "1"}]}], "]"}], "}"}], "&"}], 
          "/@", "Plocations"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindimlist", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"mindimlist", ",", "0", ",", "poslist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ULastdim", "=", 
         RowBox[{"Last", "[", "Udimlist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindimlist", "=", 
         RowBox[{"mindimlist", "\[LeftDoubleBracket]", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimparshift", "=", 
         RowBox[{"mindimlist", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dimeff", "=", 
         RowBox[{"dim", "-", "ULastdim", "-", 
          RowBox[{"(", 
           RowBox[{"Plus", "@@", "dimparshift"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mydimparlist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Permutations", "/@", 
            RowBox[{"IntegerPartitions", "[", 
             RowBox[{"dimeff", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", "mindimlist", "]"}], "}"}]}], "]"}]}], 
           ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mydimparlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"#", "+", "dimparshift"}], ",", 
             RowBox[{"{", "ULastdim", "}"}]}], "]"}], "&"}], "/@", 
          "mydimparlist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "trimings", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"Plocations", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"mydimparlist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"mydimparlist", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", "2"}], "&"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"Plocations", ",", 
             RowBox[{"Length", "[", "masslabels", "]"}]}], "]"}]}], ",", 
          RowBox[{"mydimparlist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"mydimparlist", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
               "2"}], "&"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mydimparlist", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generate", " ", "the", " ", "poly", " ", "of", " ", "a", " ", "bosonic", 
     " ", "supertrace", " ", "for", " ", "a", " ", "given", " ", "dimpar"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSTrPolyDimPar", "[", 
      RowBox[{
      "dimpar_", ",", "masslabels_", ",", "coeff_", ",", "Ulist_", ",", 
       "Plocations_", ",", "Pindices_", ",", "Udimlist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mytypelist", ",", "mylist", ",", "myexpr", ",", "polyArray", ",", 
         "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mytypelist", "=", 
         RowBox[{
          RowBox[{"1", "&"}], "/@", "masslabels"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"STrflistUFrame", "[", 
          RowBox[{
          "masslabels", ",", "mytypelist", ",", "1", ",", "Plocations", ",", 
           "Pindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"mylist", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#1", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalDelta]", "imass_"], "\[RuleDelayed]", 
                 RowBox[{"\[CapitalDelta]CDEDim", "[", 
                  RowBox[{"imass", ",", "#2"}], "]"}]}], ",", 
                RowBox[{
                 SubscriptBox["U", "i_"], "\[RuleDelayed]", " ", 
                 RowBox[{"UCDEDim", "[", 
                  RowBox[{"#2", ",", 
                   RowBox[{"Udim", "\[Rule]", 
                    RowBox[{
                    "Udimlist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{"Uoper", "\[Rule]", 
                    RowBox[{
                    "Ulist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
                RowBox[{
                 SubscriptBox["P", "\[Nu]_"], "\[RuleDelayed]", 
                 RowBox[{"PCDEDim", "[", 
                  RowBox[{"\[Nu]", ",", "#2"}], "]"}]}]}], "}"}]}], ")"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"mylist", ",", "dimpar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MultiplyPolys", "[", "polyArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"ContractPolyIndices", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "\[Rho]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"FTrimPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"ScalePoly", "[", 
          RowBox[{"mypoly", ",", "coeff"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generate", " ", "the", " ", "poly", " ", "of", " ", "a", " ", "bosonic", 
     " ", "supertrace", " ", "up", " ", "to", " ", "a", " ", "given", " ", 
     "operator", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSTrPolyGen", "[", 
      RowBox[{
      "dim_", ",", "masslabels_", ",", "coeff_", ",", "Ulist_", ",", 
       "Plocations_", ",", "Pindices_", ",", "Udimlist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mydimparlist", ",", "polyArray", ",", "myexpr", ",", "mypoly"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mydimparlist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DimparsBSTrDim", "[", 
              RowBox[{
              "#", ",", "masslabels", ",", "Plocations", ",", "Udimlist"}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Length", "[", "masslabels", "]"}], ",", "dim"}], 
             "]"}]}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"BSTrPolyDimPar", "[", 
            RowBox[{
            "#", ",", "masslabels", ",", "coeff", ",", "Ulist", ",", 
             "Plocations", ",", "Pindices", ",", "Udimlist"}], "]"}], "&"}], "/@",
           "mydimparlist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SumPolys", "[", "polyArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816008042912429*^9, 3.816008043132429*^9}, {
   3.8160084683600283`*^9, 3.81600846920103*^9}, 3.8161104558697095`*^9, {
   3.816206533342782*^9, 3.8162065341851835`*^9}, {3.816268804566973*^9, 
   3.8162688052377744`*^9}},ExpressionUUID->"c6874162-0482-4f51-9ebd-\
b4352288b2be"]
}, Closed]],

Cell[CellGroupData[{

Cell["General Supertrace (Main Functions)", "Subsubsection",
 CellChangeTimes->{{3.8160080438124304`*^9, 3.8160080439924307`*^9}, {
  3.816008081367483*^9, 
  3.8160081151325307`*^9}},ExpressionUUID->"20b994b2-621d-4d9b-ab1b-\
78d1c790ae91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "SuperTrace", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SuperTraceFromExpr", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816007028702*^9, 3.8160070288720007`*^9}, {
   3.81600848369205*^9, 3.816008484603051*^9}, 3.816110474872736*^9, {
   3.816206554434019*^9, 3.8162065552920203`*^9}, {3.816268822756605*^9, 
   3.8162688235678062`*^9}},ExpressionUUID->"ec562c91-1171-45fc-b464-\
359865337757"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Compute", " ", "a", " ", "functional", " ", "supertrace"}], " ",
      "-", 
     RowBox[{"iSTr", "[", "f", "]"}]}], 
    SubscriptBox["|", "hard"], " ", 
    RowBox[{
    "up", " ", "to", " ", "a", " ", "given", " ", "operator", " ", 
     "dimension", " ", "dim"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SuperTrace", "[", 
      RowBox[{"dim_", ",", "flist_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Udimlist", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Heavylist", "\[Rule]", 
           RowBox[{"{", "1", "}"}]}], ",", 
          RowBox[{"SoftOrd", "\[Rule]", "0"}], ",", 
          RowBox[{"No\[Gamma]inU", "\[Rule]", "False"}], ",", 
          RowBox[{"display", "\[Rule]", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myflist", ",", "myParameters", ",", "masslabels", ",", "typelist", 
         ",", "coeff", ",", "Ulist", ",", "Plocations", ",", "Pindices", ",", 
         "myUdimlist", ",", "myHeavylist", ",", "mySoftOrd", ",", "n\[Nu]", 
         ",", "\[Mu]start", ",", "\[Rho]start", ",", "supersign", ",", 
         "flistU", ",", "n\[CapitalSigma]cap", ",", "bflistArray", ",", 
         "UdimlistArray", ",", "BSTrInputArray", ",", "polyArray", ",", 
         "mypoly", ",", "myInput", ",", "myPrint", ",", "mystr"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "**",
          "**", "**", "**"}], "********)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**"}], "*", " ", "Interpret", " ", 
         RowBox[{"Inputs", " ", "**", "**", "**"}], "*", "*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "**",
          "**"}], "************)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myflist", "=", "flist"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myParameters", "=", 
         RowBox[{"STrParameters", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{"OptionValue", "[", "Udimlist", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"masslabels", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"typelist", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "3", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ulist", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "4", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plocations", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "5", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Pindices", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "6", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myUdimlist", "=", 
         RowBox[{
         "myParameters", "\[LeftDoubleBracket]", "7", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
           "**", "**", "**", "**"}], "********)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", " ", "Check"}], " ", "Validity", " ", "of", " ", 
          RowBox[{
          "Inputs", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", "**", "**", "**"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
           "**", "**"}], "************)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "masslabels", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"AllTrue", "[", 
              RowBox[{"masslabels", ",", "IntegerQ"}], "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Min", "[", "masslabels", "]"}], "<", "0"}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with invalid mass labels:\>\"", ",", 
             "masslabels"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<mass labels must be non-negative integers.\>\"",
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Ulist", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "Ulist", "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "masslabels", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with different numbers of \
\[CapitalDelta]|\[CapitalLambda] and U: propagators=\>\"", ",", 
             RowBox[{"Cases", "[", 
              RowBox[{"flist", ",", 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "i_"], "|", 
                SubscriptBox["\[CapitalLambda]", "i_"]}]}], "]"}], ",", 
             "\"\<, Ulist=\>\"", ",", "Ulist"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Plocations", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Max", "[", "Plocations", "]"}], ">", 
             RowBox[{"Length", "[", "masslabels", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Min", "[", "Plocations", "]"}], "<", 
             RowBox[{"-", 
              RowBox[{"Length", "[", "masslabels", "]"}]}]}], ")"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"Plocations", ",", "0"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with invalid Plocations=\>\"", ",", 
             "Plocations"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Pindices", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Tally", "[", "Pindices", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ">", "2"}], "&"}]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with invalid P Lorentz indies:\>\"", ",",
              "Pindices"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<The same Lorentz index should not appear more than \
twice.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Pindices", ":", " ", 
          RowBox[{
          "replace", " ", "\[Mu]", " ", "indices", " ", "in", " ", "the", " ",
            "input", " ", "with", " ", "\[Nu]", " ", "indices"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Pindices", ",", 
            SubscriptBox["\[Mu]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n\[Nu]", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"Cases", "[", 
                RowBox[{"Pindices", ",", 
                 RowBox[{
                  SubscriptBox["\[Nu]", "i_"], "\[Rule]", "i"}]}], "]"}]}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Mu]start", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"Pindices", ",", 
               RowBox[{
                SubscriptBox["\[Mu]", "i_"], "\[Rule]", "i"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Mu] indices are reserved by the code. Proceeding with the \
following indices replacements:\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               SubscriptBox["\[Mu]", "#"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "#", "-", "\[Mu]start", "+", "1"}]]}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Sort", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"Pindices", ",", 
                RowBox[{
                 SubscriptBox["\[Mu]", "i_"], "\[Rule]", "i"}]}], "]"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Pindices", "=", 
            RowBox[{"Pindices", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "i_"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "i", "-", "\[Mu]start", "+", "1"}]]}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"myflist", "=", 
            RowBox[{"myflist", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "i_"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "i", "-", "\[Mu]start", "+", "1"}]]}], 
              "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Pindices", ":", " ", 
          RowBox[{
          "replace", " ", "\[Rho]", " ", "indices", " ", "in", " ", "the", 
           " ", "input", " ", "with", " ", "\[Nu]", " ", "indices"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Pindices", ",", 
            SubscriptBox["\[Rho]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n\[Nu]", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"Cases", "[", 
                RowBox[{"Pindices", ",", 
                 RowBox[{
                  SubscriptBox["\[Nu]", "i_"], "\[Rule]", "i"}]}], "]"}]}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Rho]start", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"Pindices", ",", 
               RowBox[{
                SubscriptBox["\[Rho]", "i_"], "\[Rule]", "i"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Rho] indices are reserved by the code. Proceeding with the \
following indices replacements:\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               SubscriptBox["\[Rho]", "#"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "#", "-", "\[Rho]start", "+", "1"}]]}],
               "]"}], "&"}], "/@", 
            RowBox[{"Sort", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"Pindices", ",", 
                RowBox[{
                 SubscriptBox["\[Rho]", "i_"], "\[Rule]", "i"}]}], "]"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Pindices", "=", 
            RowBox[{"Pindices", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Rho]", "i_"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "i", "-", "\[Rho]start", "+", "1"}]]}],
               "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"myflist", "=", 
            RowBox[{"myflist", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Rho]", "i_"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "i", "-", "\[Rho]start", "+", "1"}]]}],
               "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Heavylist", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myHeavylist", "=", 
         RowBox[{"OptionValue", "[", "Heavylist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"masslabels", ",", "myHeavylist"}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<flist contains no heavy mass: Heavylist=\>\"", ",", 
             "myHeavylist", ",", "\"\<, while masslabels=\>\"", ",", 
             "masslabels"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Supertrace vanishes.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "SoftOrd", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"mySoftOrd", "=", 
         RowBox[{"OptionValue", "[", "SoftOrd", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "mySoftOrd", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"mySoftOrd", "<", "0"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with invalid SoftOrd=\>\"", ",", 
             "mySoftOrd"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
           "**", "**", "**", "**"}], "********)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", " ", "Evaluate"}], " ", "the", " ", 
          RowBox[{"SuperTrace", " ", "**", "**", "**", "**"}], "*", 
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
           "**", "**"}], "************)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Address", " ", "the", " ", "\"\<super\>\"", " ", "in", " ", "STr"}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"supersign", "=", 
         RowBox[{
         "typelist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"supersign", "\[Times]", "coeff"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Address", " ", "fermionic", " ", "propagators"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"flistU", "=", 
         RowBox[{"STrflistUFrame", "[", 
          RowBox[{
          "masslabels", ",", "typelist", ",", "coeff", ",", "Plocations", ",",
            "Pindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n\[CapitalSigma]cap", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dim", "-", 
             RowBox[{"(", 
              RowBox[{"Plus", "@@", "myUdimlist"}], ")"}]}], ")"}], "/", 
           "2"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n\[CapitalSigma]cap", "<", "0"}], ",", 
          RowBox[{"n\[CapitalSigma]cap", "=", "0"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{"STrBflists", "[", 
          RowBox[{"flistU", ",", "n\[CapitalSigma]cap"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UdimlistArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"\[Sigma]F", "|", 
                SubscriptBox["U", "__"]}]}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]F", "\[Rule]", "2"}], ",", 
               RowBox[{
                SubscriptBox["U", "i_"], "\[RuleDelayed]", 
                RowBox[{
                "myUdimlist", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ")"}], "&"}], "/@", 
          "bflistArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["U", "i_"], "\[RuleDelayed]", 
               RowBox[{
               "Ulist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "}"}]}], ")"}], "&"}], "/@", 
          "bflistArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BSTrInputArray", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"STrParameters", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"bflistArray", ",", "UdimlistArray"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"BSTrInputArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"Delete", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], "]"}], "&"}], "/@", 
          "BSTrInputArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Perform", " ", "original", " ", "CDE"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SumPolys", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"BSTrPolyGen", "@@", "#"}], ")"}], "&"}], "/@", 
           "BSTrInputArray"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Perform", " ", "loop", " ", "integrals"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"qEvenTrimPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"dqAllPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"FTrimPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SymHardPoly", "[", 
          RowBox[{
          "mypoly", ",", "dim", ",", "myHeavylist", ",", "mySoftOrd", ",", 
           RowBox[{"OptionValue", "[", "No\[Gamma]inU", "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"IntegratePoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mystr", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"3", "\[Rule]", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
            "]"}], "&"}], "/@", "mypoly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mystr", "=", 
         RowBox[{"mystr", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             SubsuperscriptBox["m", "i_", "2"], "]"}], "\[Rule]", 
            RowBox[{"Log", "[", 
             FractionBox[
              SubsuperscriptBox["m", "i", "2"], 
              SuperscriptBox["\[Mu]", "2"]], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Print", " ", "results"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "display", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myInput", "=", 
            RowBox[{"STrPrint", "[", "myflist", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myPrint", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#", ",", 
                RowBox[{"2", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "\"\<(\>\"", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Row", "[", "#", "]"}], "}"}], ",", 
                    RowBox[{"{", "\"\<)\>\"", "}"}]}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ")"}]}], "]"}], "}"}], 
                  "}"}]}]}], "]"}], "&"}], "/@", "mystr"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myPrint", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#", ",", 
                RowBox[{"3", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(dim-\>\"", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "\"\<)\>\""}], "}"}], 
                    "]"}], "}"}], "}"}]}]}], "]"}], "&"}], "/@", 
             "myPrint"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "myInput", ",", 
             "\"\< = \[Integral]\!\(\*SuperscriptBox[\(d\), \(4\)]\)x \
\!\(\*FractionBox[\(1\), \(16 \*SuperscriptBox[\(\[Pi]\), \(2\)]\)]\) \
tr{\\n\>\"", ",", 
             RowBox[{"TableForm", "[", 
              RowBox[{"myPrint", ",", 
               RowBox[{"TableSpacing", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "5", ",", "2"}], "}"}]}]}], "]"}]}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<}\>\"", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mystr", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Compute", " ", "a", " ", "functional", " ", "supertrace"}], 
      " ", "-", 
      RowBox[{"iSTr", "[", "f", "]"}]}], 
     SubscriptBox["|", "hard"], " ", 
     RowBox[{
     "up", " ", "to", " ", "a", " ", "given", " ", "operator", " ", 
      "dimension", " ", "dim"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperTraceFromExpr", "[", 
      RowBox[{"dim_", ",", "fexpr_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Udimlist", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Heavylist", "\[Rule]", 
           RowBox[{"{", "1", "}"}]}], ",", 
          RowBox[{"SoftOrd", "\[Rule]", "0"}], ",", 
          RowBox[{"No\[Gamma]inU", "\[Rule]", "False"}], ",", 
          RowBox[{"display", "\[Rule]", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myflist", ",", "mystr"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myflist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"fexpr", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Times", "\[Rule]", "List"}], ",", 
              RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
             "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mystr", "=", 
         RowBox[{"SuperTrace", "[", 
          RowBox[{"dim", ",", "myflist", ",", 
           RowBox[{"Udimlist", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Udimlist", "]"}]}], ",", 
           RowBox[{"Heavylist", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Heavylist", "]"}]}], ",", 
           RowBox[{"SoftOrd", "\[Rule]", 
            RowBox[{"OptionValue", "[", "SoftOrd", "]"}]}], ",", 
           RowBox[{"No\[Gamma]inU", "\[Rule]", 
            RowBox[{"OptionValue", "[", "No\[Gamma]inU", "]"}]}], ",", 
           RowBox[{"display", "\[Rule]", 
            RowBox[{"OptionValue", "[", "display", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mystr", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002773411212*^9, 3.816002773611212*^9}, {
  3.8160084963350677`*^9, 3.81600849771507*^9}, {3.816110495575765*^9, 
  3.8161104968657675`*^9}, {3.816123621503723*^9, 3.8161236229837255`*^9}, {
  3.816206573091652*^9, 3.816206597115694*^9}, {3.816208720917427*^9, 
  3.816208722040629*^9}, {3.816251414974725*^9, 3.816251416191527*^9}, {
  3.8162688668110824`*^9, 3.8162688701494884`*^9}, {3.816272296340707*^9, 
  3.81627229810351*^9}},ExpressionUUID->"4cdbb6c7-0cec-4a0b-8fb9-\
1b5acf5f45f6"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the `Private context", "Section",
 CellChangeTimes->{{3.8160027743112135`*^9, 3.816002774501213*^9}, {
  3.816003492488225*^9, 
  3.816003505450243*^9}},ExpressionUUID->"d026c125-4cd0-4bf5-ab2c-\
8af0d0e23649"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160027752722144`*^9, 3.816002775482215*^9}, 
   3.8160035233432684`*^9},ExpressionUUID->"9335ac77-39b9-408f-9a83-\
0212ded97cfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the package context", "Section",
 CellChangeTimes->{{3.8160027761622157`*^9, 3.816002776382216*^9}, {
  3.816003498309233*^9, 
  3.816003511071251*^9}},ExpressionUUID->"5d8aefe4-887d-42c8-8424-\
15dd8de32d3b"],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002777072217*^9, 3.8160027772922173`*^9}, 
   3.8160035185122614`*^9},ExpressionUUID->"1e8c0adf-e8c8-4630-9847-\
da31be531f19"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949., 469.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "12.1 for Microsoft Windows (64-bit) (March 18, 2020)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"83b9b376-570e-4548-a0c6-767d85dcaa1c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 253, 3, 98, "Title",ExpressionUUID->"662a8f3a-d1ee-4f63-9c1d-149fdaf6ec99"],
Cell[836, 27, 487, 10, 78, "Text",ExpressionUUID->"0b01acb2-667c-458b-b768-a2dcb353bb45"],
Cell[CellGroupData[{
Cell[1348, 41, 217, 4, 67, "Section",ExpressionUUID->"082fd18a-95b5-45c0-99f6-6246c1805f02"],
Cell[1568, 47, 257, 5, 44, "Input",ExpressionUUID->"c20b3ed0-afb0-41b1-8870-a49d70cb20d3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1850, 56, 242, 4, 54, "Subsection",ExpressionUUID->"865fc571-d6ad-414e-b93b-4d97f5764f89"],
Cell[2095, 62, 6527, 135, 550, "Input",ExpressionUUID->"f5b27e81-fee2-43bf-8b72-a4fefe5d4e9c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8671, 203, 224, 4, 67, "Section",ExpressionUUID->"b6c86209-c710-4b00-971b-6d0c93cd8fb0"],
Cell[8898, 209, 249, 5, 44, "Input",ExpressionUUID->"68b24e7e-ba8d-467b-8952-fce34710afed",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[9172, 218, 174, 3, 54, "Subsection",ExpressionUUID->"fbe5098c-431d-4c92-91e9-cc1bf085f178"],
Cell[CellGroupData[{
Cell[9371, 225, 312, 5, 34, "Text",ExpressionUUID->"f255be19-dfdc-4664-a83e-d7574cbe1b79",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[9686, 232, 6760, 169, 432, "Input",ExpressionUUID->"efa290f8-ea2b-4368-a5c8-33f9b9834298",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[16483, 406, 178, 3, 36, "Subsubsection",ExpressionUUID->"c7a07fa0-315c-46a9-9182-7f5bb10ea183"],
Cell[16664, 411, 1258, 30, 219, "Input",ExpressionUUID->"6308cc4e-69bc-4352-9f3e-557e8538728f",
 InitializationCell->True],
Cell[17925, 443, 12597, 329, 1293, "Input",ExpressionUUID->"17f06e1b-0dc1-44bf-b251-a1b116e2a34b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[30559, 777, 229, 4, 36, "Subsubsection",ExpressionUUID->"50b750bf-5604-482e-ad3f-6895b0cece92"],
Cell[30791, 783, 1617, 38, 316, "Input",ExpressionUUID->"2342ad68-514f-4163-b06a-ebd30a1e3276",
 InitializationCell->True],
Cell[32411, 823, 40905, 1023, 3228, "Input",ExpressionUUID->"fe5846a3-6921-4326-9278-5fb983db53ea",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73365, 1852, 174, 3, 54, "Subsection",ExpressionUUID->"80632c07-cf86-42a9-94d0-ff524be57346"],
Cell[CellGroupData[{
Cell[73564, 1859, 236, 4, 34, "Text",ExpressionUUID->"0c43efaa-ce28-4b9e-b00d-af12a4aeed5c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[73803, 1865, 6152, 150, 442, "Input",ExpressionUUID->"334e39dd-274e-41a4-8f34-7b53a207a3e2",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79992, 2020, 256, 4, 36, "Subsubsection",ExpressionUUID->"f8336a91-1c7f-4094-9638-53cd915bcbc9"],
Cell[80251, 2026, 1443, 35, 258, "Input",ExpressionUUID->"f646f439-d369-4c36-af8a-49d9f16ade2c",
 InitializationCell->True],
Cell[81697, 2063, 23731, 596, 2260, "Input",ExpressionUUID->"38764350-d5a0-40b1-9a7f-56794740bdc2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[105465, 2664, 261, 4, 36, "Subsubsection",ExpressionUUID->"c7bdf295-fdfd-40d8-b887-12e215d347cf"],
Cell[105729, 2670, 2234, 53, 452, "Input",ExpressionUUID->"a64d70ff-6dd2-4a3a-b965-d045fc25ce5b",
 InitializationCell->True],
Cell[107966, 2725, 55868, 1417, 3983, "Input",ExpressionUUID->"fd2c1008-ef7f-4173-978d-bc73b1c42f98",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[163871, 4147, 255, 4, 36, "Subsubsection",ExpressionUUID->"df59bf6f-f431-4a87-a6fb-837a698bf05f"],
Cell[164129, 4153, 735, 15, 103, "Input",ExpressionUUID->"188379d3-bc30-4362-a4fb-f1ca146bd118",
 InitializationCell->True],
Cell[164867, 4170, 12405, 303, 1018, "Input",ExpressionUUID->"99889dd9-6210-468a-9f65-afaf4d9aef27",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177321, 4479, 163, 3, 54, "Subsection",ExpressionUUID->"cda4f997-7331-40fc-8f1b-3aeb043e6dde"],
Cell[CellGroupData[{
Cell[177509, 4486, 235, 4, 34, "Text",ExpressionUUID->"ae6cec36-564b-48b4-b042-7d8345edc971",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[177747, 4492, 5113, 151, 305, "Input",ExpressionUUID->"69d289b3-53bf-469e-a667-f307d355cd6b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[182897, 4648, 585, 16, 39, "Subsubsection",ExpressionUUID->"551674e6-9cac-4ab0-9907-c1beb2e1cd92"],
Cell[183485, 4666, 495, 10, 64, "Input",ExpressionUUID->"21842918-828f-4d3d-b287-a9d88a208908",
 InitializationCell->True],
Cell[183983, 4678, 10376, 267, 843, "Input",ExpressionUUID->"a3f91c65-5820-4822-a416-495060333323",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[194396, 4950, 620, 16, 39, "Subsubsection",ExpressionUUID->"644d597e-91a5-4683-94ff-2d8d46323a58"],
Cell[195019, 4968, 1011, 25, 161, "Input",ExpressionUUID->"72807c16-161b-441f-850a-0fe088c296bd",
 InitializationCell->True],
Cell[196033, 4995, 20870, 541, 1532, "Input",ExpressionUUID->"ee002501-f39e-4524-ad0a-61b5b06545d6",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[216952, 5542, 174, 3, 54, "Subsection",ExpressionUUID->"6a7ecdc7-48e4-4374-9591-f45918c2c25f"],
Cell[CellGroupData[{
Cell[217151, 5549, 234, 4, 34, "Text",ExpressionUUID->"ad2752cf-bc7d-465d-a31f-b462801143a3",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[217388, 5555, 10348, 246, 750, "Input",ExpressionUUID->"55f5f427-aa2a-4041-b005-a4cb4a70cf0d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[227773, 5806, 242, 4, 44, "Subsubsection",ExpressionUUID->"42f376e2-aa8c-46d0-9887-694db618bc6c"],
Cell[228018, 5812, 943, 20, 161, "Input",ExpressionUUID->"9405443e-4adb-4d8e-8552-8715e7d83fb1",
 InitializationCell->True],
Cell[228964, 5834, 35554, 871, 2610, "Input",ExpressionUUID->"c6874162-0482-4f51-9ebd-b4352288b2be",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[264555, 6710, 241, 4, 36, "Subsubsection",ExpressionUUID->"20b994b2-621d-4d9b-ab1b-78d1c790ae91"],
Cell[264799, 6716, 527, 12, 64, "Input",ExpressionUUID->"ec562c91-1171-45fc-b464-359865337757",
 InitializationCell->True],
Cell[265329, 6730, 30378, 693, 2736, "Input",ExpressionUUID->"4cdbb6c7-0cec-4a0b-8fb9-1b5acf5f45f6",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[295768, 7430, 220, 4, 67, "Section",ExpressionUUID->"d026c125-4cd0-4bf5-ab2c-8af0d0e23649"],
Cell[295991, 7436, 231, 5, 44, "Input",ExpressionUUID->"9335ac77-39b9-408f-9a83-0212ded97cfd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[296259, 7446, 219, 4, 67, "Section",ExpressionUUID->"5d8aefe4-887d-42c8-8424-15dd8de32d3b"],
Cell[296481, 7452, 238, 5, 44, "Input",ExpressionUUID->"1e8c0adf-e8c8-4630-9847-da31be531f19",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

