(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    324511,       7998]
NotebookOptionsPosition[    317080,       7849]
NotebookOutlinePosition[    317691,       7869]
CellTagsIndexPosition[    317648,       7866]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["STrEAM.m Package", "Title",
 CellChangeTimes->{{3.8160027659802012`*^9, 3.816002803366254*^9}, {
   3.816002851023321*^9, 3.8160028597243333`*^9}, 3.81600696458191*^9},
 TextAlignment->Center,ExpressionUUID->"662a8f3a-d1ee-4f63-9c1d-149fdaf6ec99"],

Cell["\<\
SuperTrace Evaluation Automated for Matching
by Timothy Cohen, Xiaochuan Lu, and Zhengkang Zhang
Last edited on December 11, 2020.\
\>", "Text",
 CellChangeTimes->{{3.816121221217865*^9, 3.8161212671024895`*^9}, {
  3.8161235733176556`*^9, 3.8161235777876616`*^9}, {3.816205806537505*^9, 
  3.8162058494687805`*^9}, {3.8162066234953403`*^9, 3.8162066388769674`*^9}, {
  3.816251307147335*^9, 3.8162513072721357`*^9}, {3.816542191695504*^9, 
  3.8165421920955048`*^9}, {3.816704468231604*^9, 
  3.816704468840005*^9}},ExpressionUUID->"0b01acb2-667c-458b-b768-\
a2dcb353bb45"],

Cell[CellGroupData[{

Cell["Begin the package", "Section",
 CellChangeTimes->{{3.816002767090203*^9, 3.8160027864742303`*^9}, {
  3.8160028786273603`*^9, 
  3.8160028861293707`*^9}},ExpressionUUID->"082fd18a-95b5-45c0-99f6-\
6246c1805f02"],

Cell[BoxData[
 RowBox[{"BeginPackage", "[", "\"\<STrEAM`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002768031204*^9, 3.8160027682212043`*^9}, 
   3.816002903341395*^9},ExpressionUUID->"c20b3ed0-afb0-41b1-8870-\
a49d70cb20d3"],

Cell[CellGroupData[{

Cell["Usage messages for the public functions", "Subsection",
 CellChangeTimes->{{3.8160027689612055`*^9, 3.816002769161206*^9}, {
  3.8160029456174545`*^9, 
  3.8160029475184574`*^9}},ExpressionUUID->"865fc571-d6ad-414e-b93b-\
4d97f5764f89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Reserved", " ", "for", " ", "input", " ", "recognition"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"P", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(P\), \(\[Mu]\)]\)=\!\(\*SubscriptBox[\(iD\), \
\(\[Mu]\)]\) denote the Hermitian covariant derivatives in input and \
output.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(i\)]\)=\!\(\*FractionBox[\
\(1\), \(\*SuperscriptBox[\(P\), \(2\)] - \*SubsuperscriptBox[\(m\), \(i\), \
\(2\)]\)]\) denotes bosonic covariant propagators in input and its \
print.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalLambda]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[CapitalLambda]\), \
\(i\)]\)=\!\(\*FractionBox[\(1\), \(Pslash - \*SubscriptBox[\(m\), \
\(i\)]\)]\) denotes fermionic covariant propagators in input and its print.\>\
\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Reserved", " ", "as", " ", "dummy", " ", "indices"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Mu]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\) denote dummy indices in \
output.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Reserved", " ", "for", " ", "output"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(m\), \(i\)]\) with i non-negative integers \
denote particle masses.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "::", "usage"}], "=", 
     "\"\<d denotes the spacetime dimension in dimensional \
regularization.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Eta]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu], \[Nu]\)]\)=diag(1,-1,-1,-1) \
denotes the spacetime metric.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(F\), \(\[Mu], \
\[Nu]\)]\)=-i[\!\(\*SubscriptBox[\(P\), \
\(\[Mu]\)]\),\!\(\*SubscriptBox[\(P\), \
\(\[Nu]\)]\)]=\!\(\*SubscriptBox[\(g\), \
\(a\)]\)\!\(\*SubsuperscriptBox[\(G\), \(\[Mu]\[Nu]\), \
\(a\)]\)\!\(\*SuperscriptBox[\(T\), \(a\)]\) denotes the sum of field \
strengths.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]", "::", "usage"}], "=", 
     "\"\<\!\(\*SubscriptBox[\(\[Gamma]\), \(\[Mu]\)]\) denote Dirac \
matrices.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]F", "::", "usage"}], "=", 
     "\"\<\[Sigma]F denotes \!\(\*SuperscriptBox[\(\[Sigma]\), \
\(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(F\), \
\(\[Mu]\[Nu]\)]\)=\!\(\*FractionBox[\(i\), \(2\)]\)[\!\(\*SuperscriptBox[\(\
\[Gamma]\), \(\[Mu]\)]\),\!\(\*SuperscriptBox[\(\[Gamma]\), \(\[Nu]\)]\)]\!\(\
\*SubscriptBox[\(F\), \(\[Mu]\[Nu]\)]\) in the dipole factor \
\[CapitalSigma]=-\!\(\*FractionBox[\(1\), \(2\)]\)\!\(\*SuperscriptBox[\(\
\[Sigma]\), \(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(F\), \
\(\[Mu]\[Nu]\)]\).\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Pslash", "::", "usage"}], "=", 
     "\"\<Pslash=\!\(\*SubscriptBox[\(P\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[\(\[Gamma]\), \(\[Mu]\)]\)\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LoopI", "::", "usage"}], "=", 
     "\"\<\!\(\*FractionBox[\(1\), \(16 \*SuperscriptBox[\(\[Pi]\), \(2\)]\)]\
\)\!\(\*SubsuperscriptBox[\(LoopI\), \((\*SubscriptBox[\(n\), \(1\)],  ... , \
\*SubscriptBox[\(n\), \(k\)])\), \((r)\)]\)(\!\(\*SubsuperscriptBox[\(m\), \
\(1\), \(2\)]\),...,\!\(\*SubsuperscriptBox[\(m\), \(k\), \(2\)]\))=-i\
\[Integral]\!\(\*FractionBox[\(\*SuperscriptBox[\(d\), \(d\)] q\), \
SuperscriptBox[\((2  \[Pi])\), \
\(d\)]]\)\!\(\*FractionBox[SuperscriptBox[\((\*SuperscriptBox[\(q\), \
\(2\)])\), \(r\)], \(\(\*SuperscriptBox[\((\*SuperscriptBox[\(q\), \(2\)] - \
\*SubsuperscriptBox[\(m\), \(1\), \(2\)])\), SubscriptBox[\(n\), \(1\)]] ... \
\) \*SuperscriptBox[\((\*SuperscriptBox[\(q\), \(2\)] - \
\*SubsuperscriptBox[\(m\), \(k\), \(2\)])\), SubscriptBox[\(n\), \(k\)]]\)]\)\
\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Main", " ", "Functions"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperTrace", "::", "usage"}], "=", 
     "\"\<SuperTrace[dim,flist] evaluates -iSTr[f]\!\(\*SubscriptBox[\(|\), \
\(hard\)]\) up to operator dimension dim.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperTraceFromExpr", "::", "usage"}], "=", 
     "\"\<SuperTraceFromExpr[dim,fexpr] evaluates -iSTr[f]\!\(\*SubscriptBox[\
\(|\), \(hard\)]\) up to operator dimension dim.\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160027698712068`*^9, 3.816002770071207*^9}, 
   3.816002993465522*^9, {3.8160035475373025`*^9, 3.816003547747303*^9}, {
   3.816006687356519*^9, 3.8160068569847584`*^9}, {3.8160093172702246`*^9, 
   3.8160093308122435`*^9}, {3.8160160311964874`*^9, 3.816016060683529*^9}, 
   3.8160163604249506`*^9, {3.816031268898245*^9, 3.8160314095314436`*^9}, {
   3.8160314695925283`*^9, 3.8160314779545403`*^9}, {3.816031635550762*^9, 
   3.8160316893098373`*^9}, {3.8161059911770144`*^9, 3.816106078591138*^9}, {
   3.816106111726184*^9, 3.816106128148207*^9}, {3.8161061873082905`*^9, 
   3.8161062769924173`*^9}, {3.8161063240104833`*^9, 
   3.8161064076526012`*^9}, {3.8161064448576536`*^9, 
   3.8161066300759144`*^9}, {3.8161066917260013`*^9, 
   3.8161067381340666`*^9}, {3.8161067721301146`*^9, 3.816106805365161*^9}, {
   3.8161086983828278`*^9, 3.8161087033428345`*^9}, {3.816112068700985*^9, 
   3.8161121080970407`*^9}, {3.816121218105687*^9, 3.816121219274754*^9}, {
   3.816191568564397*^9, 3.816191596987647*^9}, {3.8161916307149057`*^9, 
   3.816191660542158*^9}, {3.816191709822645*^9, 3.8161918181492352`*^9}, {
   3.8167044753296165`*^9, 3.8167045196492944`*^9}, {3.816704558532563*^9, 
   3.8167045587197633`*^9}},ExpressionUUID->"f5b27e81-fee2-43bf-8b72-\
a4fefe5d4e9c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin the `Private context", "Section",
 CellChangeTimes->{{3.816002770761208*^9, 3.8160027709812083`*^9}, {
  3.8160029723524923`*^9, 
  3.816002974512495*^9}},ExpressionUUID->"b6c86209-c710-4b00-971b-\
6d0c93cd8fb0"],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002771651209*^9, 3.81600277186121*^9}, 
   3.816003478506205*^9},ExpressionUUID->"68b24e7e-ba8d-467b-8952-\
fce34710afed"],

Cell[CellGroupData[{

Cell["qSection Manipulations", "Subsection",
 CellChangeTimes->{{3.8165388536637974`*^9, 
  3.816538898391861*^9}},ExpressionUUID->"095daa73-311e-4a5f-8ce4-\
891e55b8ebbe"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8165389960669985`*^9, 3.8165390032580085`*^9}, 
   3.8165390572860847`*^9},ExpressionUUID->"632c0ae8-f1d2-4065-ae01-\
bd1f4bf25f2d"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\"\<qSec\>\"", " ", "stores", " ", "the", " ", "q"}], "-", 
     RowBox[{"sections", " ", 
      RowBox[{"(", 
       RowBox[{"loop", " ", "momentum", " ", "dependence"}], ")"}], " ", "of",
       " ", "terms", " ", "in", " ", "intermediate", " ", "steps", " ", "in", 
      " ", "the", " ", "CDE", " ", "procedure"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "They", " ", "are", " ", "essentially", " ", "just", " ", "functions", 
     " ", "in", " ", "the", " ", "loop", " ", "momentum", " ", 
     SubscriptBox["q", "\[Mu]"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"When", " ", "generated", " ", "by", " ", "CDE"}]}], ",", " ", 
   RowBox[{"they", " ", "are", " ", "polynomials", " ", "of", " ", 
    SubscriptBox["q", "\[Mu]"]}], ",", " ", 
   RowBox[{
    SubscriptBox["dq", "\[Mu]"], 
    RowBox[{"(", 
     RowBox[{"derivatives", " ", "on", " ", 
      SubscriptBox["q", "\[Mu]"]}], ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"and", " ", 
      SubscriptBox["\[CapitalDelta]", "i"]}], "=", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["q", "2"], "-", 
       SubsuperscriptBox["m", "i", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Note", " ", "that", " ", "in", " ", "the", " ", "context", " ", "of", 
     " ", "\"\<qSec\>\""}]}], ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "i"], " ", "is", " ", "understood", " ", 
    "as", " ", "an", " ", "ordinary", " ", "loop", " ", "propagator"}], ",", 
   " ", 
   RowBox[{
   "different", " ", "from", " ", "an", " ", "input", " ", 
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(i\)]\)\>\""}], ",", " ", 
   RowBox[{
    RowBox[{"where", " ", "it", " ", "is", " ", "interpreted", " ", "as", " ", 
     SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "later", " ", "sections"}], ")"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "Concretely"}], ",", " ", 
   RowBox[{
   "a", " ", "\"\<qSec\>\"", " ", "is", " ", "a", " ", "list", " ", "of", 
    " ", "\"\<qPart\>\""}], ",", " ", 
   RowBox[{
   "while", " ", "a", " ", "\"\<qPart\>\"", " ", "is", " ", "simply", " ", 
    "a", " ", "list", " ", "of", " ", "factors"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"such", " ", "as", "\[IndentingNewLine]", "qPart"}], "=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "30"], ",", 
       SubscriptBox["\[CapitalDelta]", "1"], ",", 
       SubscriptBox["q", 
        SubscriptBox["\[Mu]", "4"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "1"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "2"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "3"]], ",", 
       SubscriptBox["dq", 
        SubscriptBox["\[Mu]", "5"]], ",", 
       SubscriptBox["\[CapitalDelta]", "1"]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"In", " ", "the", " ", "end"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"the", " ", "derivatives", " ", 
      SubscriptBox["dq", "\[Mu]"], " ", "in", " ", "qSec", " ", "will", " ", 
      "be", " ", "carried", " ", "out", " ", "and", " ", "the", " ", "loop", 
      " ", "integral"}], "\[IndentingNewLine]", "-", 
     RowBox[{"i", 
      RowBox[{"\[Integral]", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "d"], "q"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], "d"]], " ", "will", " ", "be", " ", 
        "performed", " ", "on", " ", "qSec"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "The", " ", "function", " ", "LoopInt", " ", "is", " ", "parameterized", 
      " ", "as", "\[IndentingNewLine]", 
      FractionBox["1", 
       RowBox[{"16", 
        SuperscriptBox["\[Pi]", "2"]}]], 
      SubsuperscriptBox["LoopI", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["n", "1"], ",", "...", ",", 
         SubscriptBox["n", "k"]}], ")"}], 
       RowBox[{"(", "r", ")"}]], 
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["m", "1", "2"], ",", "...", ",", 
        SubsuperscriptBox["m", "k", "2"]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"-", "i"}], 
      RowBox[{"\[Integral]", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["d", "d"], "q"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], "d"]], 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           SuperscriptBox["q", "2"], ")"}], "r"], 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["q", "2"], "-", 
              SubsuperscriptBox["m", "1", "2"]}], ")"}], 
            SubscriptBox["n", "1"]], "..."}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["q", "2"], "-", 
             SubsuperscriptBox["m", "k", "2"]}], ")"}], 
           SubscriptBox["n", "k"]]}]]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "which", " ", "is", " ", "evaluated", " ", "using", " ", "dim", " ", 
     "reg", " ", 
     RowBox[{"(", 
      RowBox[{"d", "=", 
       RowBox[{"4", "-", 
        RowBox[{"2", "\[Epsilon]"}]}]}], ")"}], " ", "under", " ", "the", " ",
      "MSbar", " ", "scheme"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "When", " ", "there", " ", "are", " ", "less", " ", "than", " ", "three", 
     " ", "distinct", " ", "masses"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "LoopInt", " ", "returns", " ", "the", " ", "explicit", " ", "value"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "When", " ", "there", " ", "are", " ", "three", " ", "or", " ", "more", 
      " ", "non"}], "-", 
     RowBox[{"degenerate", " ", "masses"}]}]}], ",", " ", 
   RowBox[{
   "LoopInt", " ", "leaves", " ", "the", " ", "result", " ", "abstract", " ", 
    "as", " ", "the", " ", "LHS", " ", 
    RowBox[{"above", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.8165389918369923`*^9, 3.816538992026993*^9}, 
   3.8165390572860847`*^9, 3.816539810621147*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"73803775-ea8e-4e6c-b56d-8a4b670a479b"]
}, Closed]],

Cell[CellGroupData[{

Cell["qPart and qSec Arithmetic", "Subsubsection",
 CellChangeTimes->{{3.8165390750191097`*^9, 3.81653907518911*^9}, {
  3.8165391949502783`*^9, 
  3.816539215822308*^9}},ExpressionUUID->"9f8c6a2e-df40-4f84-a982-\
a7d84825c4ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "qPartCommuting", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "q2dq2\[Eta]2Rules", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SplitqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ExprqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "qPartFromExpr", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SimplifyqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "SimplifyqSec", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "ScaleqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MultiplyqSecs", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816539246167351*^9, 3.816539246367351*^9}, {
  3.8165398287351723`*^9, 3.816539843617193*^9}, {3.8166272789156*^9, 
  3.8166272790556*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"f18b13b2-0e28-4129-807a-4f79c9ac56dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Commuting", " ", "condition", " ", "for", " ", "two", " ", "adjacent", 
    " ", "elements", " ", "in", " ", "qPart"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qPartCommuting", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#1", ",", 
           SubscriptBox["dq", "__"]}], "]"}], "&&", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"#2", ",", 
           SubscriptBox["dq", "__"]}], "]"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"#1", ",", 
            SubscriptBox["dq", "__"]}], "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"#2", ",", 
            SubscriptBox["dq", "__"]}], "]"}]}]}], ")"}]}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Rules", " ", "for", " ", "writing", " ", 
      SubsuperscriptBox["q", "\[Nu]", "2"]}], ",", " ", 
     SubsuperscriptBox["dq", "\[Nu]", "2"], ",", " ", 
     RowBox[{"and", " ", 
      SubsuperscriptBox["\[Eta]", "a_", "2"]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2dq2\[Eta]2Rules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["q", "\[Nu]_", "2"], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["q", "\[Nu]"], ",", 
          SubscriptBox["q", "\[Nu]"]}], "}"}]}], ",", 
       RowBox[{
        SubsuperscriptBox["dq", "\[Nu]_", "2"], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Nu]"], ",", 
          SubscriptBox["dq", "\[Nu]"]}], "}"}]}], ",", 
       RowBox[{
        SubsuperscriptBox["\[Eta]", "a__", "2"], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Eta]", "a"], ",", 
          SubscriptBox["\[Eta]", "a"]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Split", " ", "a", " ", "qPart", " ", "into", " ", "commuting", " ", 
      "segments"}], ",", " ", 
     RowBox[{
     "with", " ", "the", " ", "first", " ", "one", " ", "reserved", " ", 
      "for", " ", "coefficient"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SplitqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"coeff", ",", "myqPart", ",", "myqPartSplit"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{"Cases", "[", 
            RowBox[{"qPart", ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqPart", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"qPart", ",", 
             SubscriptBox["m", "__"]}], "]"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{"qPart", ",", 
             SubscriptBox["\[Eta]", "__"]}], "]"}], ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"qPart", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "__"], "|", 
              SubscriptBox["\[Eta]", "__"]}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqPartSplit", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "coeff", "}"}], "}"}], ",", 
           RowBox[{"Split", "[", 
            RowBox[{"myqPart", ",", "qPartCommuting"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPartSplit", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "\"\<qPart expression\>\"", " ", "from", " ", "a",
      " ", "qPart", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExprqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qPartGrouped", ",", "myqPartSplit", ",", "myexpr"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPartSplit", "=", 
         RowBox[{"SplitqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qPartGrouped", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", "#"}], ")"}], "&"}], "/@", 
          "myqPartSplit"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myexpr", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "qPartGrouped", "]"}], ">", "2"}], ",", 
           RowBox[{
            RowBox[{
            "qPartGrouped", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], " ", 
            RowBox[{"NonCommutativeMultiply", "@@", 
             RowBox[{"qPartGrouped", "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"Times", "@@", "qPartGrouped"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myexpr", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Convert", " ", "a", " ", "\"\<qPart expression\>\"", " ", "back", " ", 
     "to", " ", "the", " ", "qPart", " ", "list"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qPartFromExpr", "[", "expr_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqPart", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPart", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"expr", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Times", "\[Rule]", "List"}], ",", 
               RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
              "}"}]}], "/.", "q2dq2\[Eta]2Rules"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "myqPart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}]}], ",", 
          RowBox[{"myqPart", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"myqPart", ",", "1", ",", "1"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "qPart", " ", "to", " ", "its", " ", 
     "canonical", " ", "form", " ", "via", " ", "\"\<qPart expression\>\""}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myexpr", ",", "myqPart"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myexpr", "=", 
         RowBox[{"ExprqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqPart", "=", 
         RowBox[{"qPartFromExpr", "[", "myexpr", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "qSec", " ", "to", " ", "its", " ", 
     "canonical", " ", "form", " ", "via", " ", "\"\<qPart expression\>\""}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qSecexpr", ",", "exprArray", ",", "myqSec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qSecexpr", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ExprqPart", "[", "#", "]"}], "&"}], "/@", "qSec"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"exprArray", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"qSecexpr", "/.", 
            RowBox[{"Plus", "\[Rule]", "List"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"qPartFromExpr", "[", "#", "]"}], "&"}], "/@", 
          "exprArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Scale", " ", "a", " ", "qSec", " ", "by", " ", "a", " ", "constant", 
      " ", "coeff"}], ",", " ", 
     RowBox[{
     "which", " ", "does", " ", "not", " ", "depend", " ", "on", " ", "q", 
      " ", "or", " ", "dq"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaleqSec", "[", 
      RowBox[{"qSec_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Insert", "[", 
            RowBox[{"#", ",", "coeff", ",", "1"}], "]"}], "&"}], "/@", 
          "qSec"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SimplifyqPart", "[", "#", "]"}], "&"}], "/@", 
          "myqSec"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Multiply", " ", "a", " ", "list", " ", "of", " ", "qSecs", " ", "into", 
     " ", "a", " ", "qSec"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiplyqSecs", "[", "qSeclist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"Tuples", "[", "qSeclist", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165389928369937`*^9, 3.8165389931969943`*^9}, {
  3.816539839837188*^9, 3.816539847638199*^9}, {3.816626966854808*^9, 
  3.8166269796268253`*^9}, {3.8166270748019595`*^9, 3.8166271307420387`*^9}, {
  3.816627214562509*^9, 3.816627271332589*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"35ebacf4-796e-433b-9335-cfd99a3efb17"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivatives and Integrals", "Subsubsection",
 CellChangeTimes->{{3.8165392221833167`*^9, 
  3.816539232905332*^9}},ExpressionUUID->"b901be8c-fdfc-448c-97f7-\
344842bbc09b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "dqCommRules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqLastqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqLastqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "dqAllqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "dqAllqSec", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Eta]ContractionRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "qContractionRules", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "AllPairings", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "LoopInt", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IntegrateqPart", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IntegrateqSec", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816539249128355*^9, 3.816539249298355*^9}, {
  3.8165398822042475`*^9, 3.81653988386525*^9}, {3.8166274636618605`*^9, 
  3.816627463811861*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"6acf400e-9beb-4b3c-9f9c-9b5b9a69f95c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Replacement", " ", "rules", " ", "for", " ", "dq", " ", "commutators"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dqCommRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}], "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["\[Eta]", "__"]}], "}"}], "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["m", "__"]}], "}"}], "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["q", "\[Nu]_"]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]", ",", "\[Nu]"}]], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubscriptBox["\[CapitalDelta]", "m_"]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", 
          SubscriptBox["q", "\[Mu]"], ",", 
          SubsuperscriptBox["\[CapitalDelta]", "m", "2"]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["dq", "\[Mu]_"], ",", 
          SubsuperscriptBox["\[CapitalDelta]", "m_", "n_"]}], "}"}], 
        "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "n"}], ",", 
          SubscriptBox["q", "\[Mu]"], ",", 
          SubsuperscriptBox["\[CapitalDelta]", "m", 
           RowBox[{"n", "+", "1"}]]}], "}"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "last", " ", "dq", " ", "in", " ", 
     "a", " ", "qPart", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqLastqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myqPart", ",", "poslist", ",", "pos", ",", "myqSec"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPart", "=", 
         RowBox[{"SimplifyqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poslist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"myqPart", ",", 
            SubscriptBox["dq", "__"]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "return", " ", "when", " ", "there", " ", "is", " ", "no", " ", "dq",
           " ", "to", " ", "carry", " ", "out"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "poslist", "]"}], "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"myqSec", "=", 
            RowBox[{"{", "myqPart", "}"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"Last", "[", "poslist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "write", " ", "qPart", " ", "into", " ", "a", " ", "series", " ", 
          "of", " ", "dq", " ", "commutators"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"myqPart", "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{"pos", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"myqPart", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"pos", "+", "1"}], ";;", 
               RowBox[{"#", "-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "myqPart", "\[LeftDoubleBracket]", "pos", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "myqPart", "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}]}], "}"}], "}"}], ",", 
             RowBox[{"myqPart", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"#", "+", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"pos", "+", "1"}], ",", 
            RowBox[{"Length", "[", "myqPart", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "carry", " ", "out", " ", "the", " ", "dq", " ", "commutators"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"(", 
           RowBox[{"myqSec", "/.", "dqCommRules"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "last", " ", "dq", " ", "in", " ", 
     "a", " ", "qSec", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqLastqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "qSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"dqLastqPart", "/@", "myqSec"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "all", " ", "dq", " ", "in", " ", "a", " ", 
     "qPart", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqAllqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ii", ",", "ndq", ",", "myqSec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ndq", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"qPart", ",", 
           SubscriptBox["dq", "__"]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"{", "qPart", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Nest", "[", 
          RowBox[{"dqLastqSec", ",", "myqSec", ",", "ndq"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "all", " ", "dq", " ", "in", " ", "a", " ", 
     "qSec", " ", "to", " ", "obtain", " ", "a", " ", "qSec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dqAllqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"dqAllqPart", "/@", "qSec"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"\[Eta]", " ", "contraction", " ", "rules"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]ContractionRules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Rho]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Rho]_", ",", "\[Mu]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Nu]_", ",", "\[Mu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Rho]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Nu]_", ",", "\[Mu]_"}]], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Rho]_", ",", "\[Mu]_"}]]}], "\[Rule]", 
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Nu]", ",", "\[Rho]"}]]}], ",", 
       RowBox[{
        SubscriptBox["\[Eta]", 
         RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "\[Rule]", "d"}], ",", 
       RowBox[{
        SubsuperscriptBox["\[Eta]", "__", "2"], "\[Rule]", "d"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["a__", "\[Mu]_"], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "\[Rule]", 
        SubscriptBox["a", "\[Nu]"]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["a__", "\[Mu]_"], 
         SubscriptBox["\[Eta]", 
          RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "\[Rule]", 
        SubscriptBox["a", "\[Nu]"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"q", " ", "contraction", " ", "rules"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qContractionRules", "=", 
     RowBox[{"{", 
      RowBox[{
       SubsuperscriptBox["q", "__", "2"], "\[Rule]", 
       SubsuperscriptBox["\[CapitalDelta]", "0", 
        RowBox[{"-", "1"}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "list", " ", "of", " ", "all", " ", "pairings", 
     " ", "for", " ", "an", " ", "even", " ", "number", " ", "of", " ", 
     "objects"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AllPairings", "[", 
      RowBox[{"{", "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AllPairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "}"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"AllPairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b__"}], "}"}], "]"}], ":=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{
              RowBox[{"{", "b", "}"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], "/@", 
          RowBox[{"AllPairings", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"{", "b", "}"}], ",", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "A", " ", "generic", " ", "Loop", " ", "Integral", " ", "evaluated", 
       " ", "with", " ", "dim"}], "-", 
      RowBox[{"reg", " ", "and", " ", "MSbar", " ", "scheme"}]}], ",", " ", 
     RowBox[{"multiplied", " ", "by", " ", "16", 
      SuperscriptBox["\[Pi]", "2"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LoopInt", "[", 
      RowBox[{"r_", ",", "nlist_", ",", "masslist_", ",", "coeff_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "nlen", ",", "n", ",", "M", ",", "n1", ",", "n2", ",", "M1", ",", 
         "M2", ",", "myResult"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nlen", "=", 
         RowBox[{"Length", "[", "nlist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nlen", "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nlen", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"First", "[", "nlist", "]"}]}], ";", 
           RowBox[{"M", "=", 
            RowBox[{"First", "[", "masslist", "]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"dim", "-", "reg"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"coeff", 
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"4", "\[Pi]"}], ")"}], 
               RowBox[{
                RowBox[{"d", "/", "2"}], "-", "2"}]]], 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"n", "-", "r"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                SuperscriptBox["M", "2"], ")"}], 
               RowBox[{"n", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}]]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"r", "+", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"d", "/", "2"}], "]"}]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"n", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", "n", "]"}]]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"MSbar", " ", "scheme"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"SeriesCoefficient", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"4", "\[Pi]"}], ")"}], "\[Epsilon]"], 
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "+", "\[Epsilon]"}], "]"}]}]], 
               RowBox[{"(", 
                RowBox[{"myResult", "/.", 
                 RowBox[{"{", 
                  RowBox[{"d", "\[Rule]", 
                   RowBox[{"4", "-", 
                    RowBox[{"2", "\[Epsilon]"}]}]}], "}"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", "myResult", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nlen", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"n1", "=", 
            RowBox[{
            "nlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ";", 
           RowBox[{"n2", "=", 
            RowBox[{
            "nlist", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            ";", 
           RowBox[{"M1", "=", 
            RowBox[{
            "masslist", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ";", 
           RowBox[{"M2", "=", 
            RowBox[{
            "masslist", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"dim", "-", "reg"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"coeff", 
             FractionBox["1", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"4", "\[Pi]"}], ")"}], 
               RowBox[{
                RowBox[{"d", "/", "2"}], "-", "2"}]]], 
             FractionBox[
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"n1", "+", "n2", "-", "r"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                SuperscriptBox["M1", "2"], ")"}], 
               RowBox[{"n1", "+", "n2", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}]]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"r", "+", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"d", "/", "2"}], "]"}]], 
             FractionBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"n1", "+", "n2", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}], "]"}], 
              RowBox[{"Gamma", "[", 
               RowBox[{"n1", "+", "n2"}], "]"}]]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"myResult", "\[Times]", 
             RowBox[{"Hypergeometric2F1", "[", 
              RowBox[{
               RowBox[{"n1", "+", "n2", "-", "r", "-", 
                RowBox[{"d", "/", "2"}]}], ",", "n2", ",", 
               RowBox[{"n1", "+", "n2"}], ",", 
               RowBox[{"1", "-", 
                FractionBox[
                 SuperscriptBox["M2", "2"], 
                 SuperscriptBox["M1", "2"]]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", " ", 
            RowBox[{"MSbar", " ", "scheme"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"myResult", "=", 
            RowBox[{"SeriesCoefficient", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"4", "\[Pi]"}], ")"}], "\[Epsilon]"], 
                 RowBox[{"Gamma", "[", 
                  RowBox[{"1", "+", "\[Epsilon]"}], "]"}]}]], 
               RowBox[{"(", 
                RowBox[{"myResult", "/.", 
                 RowBox[{"{", 
                  RowBox[{"d", "\[Rule]", 
                   RowBox[{"4", "-", 
                    RowBox[{"2", "\[Epsilon]"}]}]}], "}"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Return", "[", "myResult", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myResult", "=", 
         RowBox[{"Subsuperscript", "[", 
          RowBox[{"LoopI", ",", 
           RowBox[{"Row", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "\"\<(\>\"", "}"}], ",", 
              RowBox[{"Riffle", "[", 
               RowBox[{"nlist", ",", "\"\<,\>\""}], "]"}], ",", 
              RowBox[{"{", "\"\<)\>\"", "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<(\>\"", ",", "r", ",", "\"\<)\>\""}], "}"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myResult", "=", 
         RowBox[{"coeff", " ", 
          RowBox[{"Row", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"myResult", ",", "\"\<(\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Row", "[", 
               RowBox[{
                SuperscriptBox["masslist", "2"], ",", "\"\<,\>\""}], "]"}], 
              "}"}], ",", 
             RowBox[{"{", "\"\<)\>\"", "}"}]}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myResult", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Symmetrize", " ", "qPart", " ", "and", " ", "expand", " ", "in", " ", 
     "hard", " ", "region", " ", "to", " ", "get", " ", "a", " ", "qSec", " ",
      "before", " ", "performing", " ", "the", " ", "q", " ", "integral"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardqPart", "[", 
      RowBox[{"qPart_", ",", "Heavylist_", ",", "LightOrd_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "q\[Mu]list", ",", "\[CapitalDelta]list", ",", "coeff", ",", "npair", 
         ",", "\[Eta]listArray", ",", "Mpattern", ",", "\[CapitalDelta]Mexpr",
          ",", "\[CapitalDelta]mexpr", ",", "\[CapitalDelta]Expr", ",", 
         "\[CapitalDelta]listArray", ",", "myqSec"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "split", " ", "the", " ", "qPart", " ", "into", " ", "three", " ", 
          RowBox[{"factors", ":", " ", "q\[Mu]lsit"}]}], ",", " ", 
         "\[CapitalDelta]list", ",", " ", 
         RowBox[{
         "and", " ", "\"\<coeff\>\"", " ", "which", " ", "is", " ", "the", 
          " ", "product", " ", "of", " ", "the", " ", "rest"}]}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q\[Mu]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["q", "\[Mu]_"], "\[Rule]", "\[Mu]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "__"], "|", 
            SubsuperscriptBox["\[CapitalDelta]", "__", "__"], "|", 
            SubscriptBox["m", "__"], "|", 
            SubsuperscriptBox["m", "__", "__"]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"qPart", ",", 
            RowBox[{
             SubscriptBox["q", "__"], "|", 
             SubscriptBox["\[CapitalDelta]", "__"], "|", 
             SubsuperscriptBox["\[CapitalDelta]", "__", "__"], "|", 
             SubscriptBox["m", "__"], "|", 
             SubsuperscriptBox["m", "__", "__"]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"convert", " ", "q\[Mu]lsit", " ", "into", " ", 
           SubscriptBox["\[CapitalDelta]", "0"]}], ",", " ", 
          SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], ",", " ", 
          RowBox[{
           RowBox[{"and", " ", 
            SubscriptBox["cp", "n"]}], "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{
               RowBox[{"d", 
                RowBox[{"(", 
                 RowBox[{"d", "+", "2"}], ")"}]}], "..."}], 
              RowBox[{"(", 
               RowBox[{"d", "+", 
                RowBox[{"2", "n"}], "-", "2"}], ")"}]}]], " ", "for", " ", 
            "n", " ", "pair", " ", "of", " ", 
            SubscriptBox["q", "\[Mu]"]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"npair", "=", 
         RowBox[{
          RowBox[{"Length", "[", "q\[Mu]list", "]"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]list", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"\[CapitalDelta]list", ",", 
           RowBox[{"{", 
            SubsuperscriptBox["\[CapitalDelta]", "0", 
             RowBox[{"-", "npair"}]], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Eta]", ",", "#"}], "]"}], "&"}], "/@", "#"}], 
              ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Eta]", 
                RowBox[{"{", "a__", "}"}]], "\[Rule]", 
               SubscriptBox["\[Eta]", "a"]}], "}"}]}], ")"}], "&"}], "/@", 
          RowBox[{"AllPairings", "[", "q\[Mu]list", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "expand", " ", "and", " ", "truncate", " ", "\[CapitalDelta]Part", 
          " ", "expression", " ", "according", " ", "to", " ", "the", " ", 
          "given", " ", "Heavylist", " ", "and", " ", "desired", " ", 
          "LightOrd"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Mpattern", "=", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"(", 
           RowBox[{"Join", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["m", "#"], ",", 
                 SubsuperscriptBox["m", "#", "__"], ",", 
                 SubscriptBox["\[CapitalDelta]", "#"], ",", 
                 SubsuperscriptBox["\[CapitalDelta]", "#", "__"]}], "}"}], 
               "&"}], "/@", "Heavylist"}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Mexpr", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{"\[CapitalDelta]list", ",", "Mpattern"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]mexpr", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"\[CapitalDelta]list", ",", "Mpattern"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "i_"], "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[Equal]", "0"}], ",", 
                SubscriptBox["\[CapitalDelta]", "i"], ",", 
                RowBox[{
                 SubscriptBox["\[CapitalDelta]", "0"], 
                 FractionBox["1", 
                  RowBox[{"1", "-", 
                   RowBox[{
                    SubscriptBox["\[CapitalDelta]", "0"], 
                    SubsuperscriptBox["m", "i", "2"]}]}]]}]}], "]"}]}], 
             "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Expr", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{"\[CapitalDelta]Mexpr", "\[Times]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{
                RowBox[{"\[CapitalDelta]mexpr", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["m", "i_"], "\[Rule]", 
                   RowBox[{
                    SubscriptBox["m", "i"], "\[Epsilon]"}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Epsilon]", ",", "0", ",", "LightOrd"}], "}"}]}], 
               "]"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", "\[Rule]", "1"}], "}"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"combine", " ", "coeff"}], ",", " ", 
          SubscriptBox["cp", "npair"], ",", " ", 
          RowBox[{
          "and", " ", "the", " ", "truncated", " ", "\[CapitalDelta]Part", 
           " ", "expression", " ", "into", " ", "the", " ", "new", " ", 
           "qSec"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{"Times", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Expr", "/.", 
             RowBox[{"{", 
              RowBox[{"Plus", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"coeff", ",", 
               SubscriptBox["cp", "npair"]}], "}"}], ",", "#"}], "]"}], "&"}],
           "/@", 
          RowBox[{"(", 
           RowBox[{"Flatten", "/@", 
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{"\[Eta]listArray", ",", "\[CapitalDelta]listArray"}], 
              "}"}], "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Symmetrize", " ", "a", " ", "qSec", " ", "and", " ", "expand", " ", "in",
      " ", "hard", " ", "region", " ", "before", " ", "performing", " ", 
     "the", " ", "q", " ", "integral"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardqSec", "[", 
      RowBox[{"qSec_", ",", "Heavylist_", ",", "LightOrd_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"SymHardqPart", "[", 
              RowBox[{"#", ",", "Heavylist", ",", "LightOrd"}], "]"}], "&"}], 
            "/@", "qSec"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", "myqSec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "q", " ", "integral", " ", "for", 
     " ", "a", " ", "qPart"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrateqPart", "[", "qPart_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coeff", ",", "\[CapitalDelta]list", ",", "r", ",", "nlist", ",", 
         "masslist", ",", "LoopIparameters", ",", "myqPart"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"qPart", ",", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "__"], "|", 
             SubsuperscriptBox["\[CapitalDelta]", "__", "__"]}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          SubscriptBox["cp", "n"], "=", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             RowBox[{
              RowBox[{"d", 
               RowBox[{"(", 
                RowBox[{"d", "+", "2"}], ")"}]}], "..."}], 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"2", "n"}], "-", "2"}], ")"}]}]], " ", "for", " ", "n",
            " ", "pair", " ", "of", " ", 
           SubscriptBox["q", "\[Mu]"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"coeff", "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["cp", "n_"], "\[RuleDelayed]", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["1", 
                 RowBox[{"d", "+", 
                  RowBox[{"2", "#"}], "-", "2"}]], "&"}], "/@", 
               RowBox[{"Range", "[", "n", "]"}]}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "__"], "|", 
            SubsuperscriptBox["\[CapitalDelta]", "__", "__"]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"-", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"\[CapitalDelta]list", ",", 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "0"], "|", 
                SubsuperscriptBox["\[CapitalDelta]", "0", "__"]}]}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "0"], "\[Rule]", "1"}], ",", 
               RowBox[{
                SubsuperscriptBox["\[CapitalDelta]", "0", "a_"], "\[Rule]", 
                "a"}]}], "}"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LoopIparameters", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"\[CapitalDelta]list", ",", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "0"], "|", 
              SubsuperscriptBox["\[CapitalDelta]", "0", "__"]}]}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "i_"], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1"}], "}"}]}], ",", 
             RowBox[{
              SubsuperscriptBox["\[CapitalDelta]", "i_", "n_"], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "n"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"masslist", "=", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "#"], "&"}], "/@", 
          RowBox[{
          "LoopIparameters", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nlist", "=", 
         RowBox[{
         "LoopIparameters", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nlist", "]"}], "<", "3"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"store", " ", "the", " ", "result", " ", "as", " ", 
             RowBox[{"{", "result", "}"}]}], ",", " ", 
            RowBox[{
            "when", " ", "there", " ", "are", " ", "two", " ", "or", " ", 
             "less", " ", "heavy", " ", "masses"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"myqPart", "=", 
           RowBox[{"{", 
            RowBox[{"LoopInt", "[", 
             RowBox[{"r", ",", "nlist", ",", "masslist", ",", "coeff"}], 
             "]"}], "}"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"store", " ", "the", " ", "result", " ", "as", " ", 
             RowBox[{"{", 
              RowBox[{"coeff", ",", " ", "LoopI"}], "}"}]}], ",", " ", 
            RowBox[{
            "when", " ", "there", " ", "are", " ", "three", " ", "or", " ", 
             "more", " ", "heavy", " ", "masses"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"myqPart", "=", 
            RowBox[{"{", 
             RowBox[{"coeff", ",", 
              RowBox[{"LoopInt", "[", 
               RowBox[{"r", ",", "nlist", ",", "masslist", ",", "1"}], 
               "]"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqPart", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carry", " ", "out", " ", "the", " ", "q", " ", "integral", " ", "for", 
     " ", "a", " ", "qSec"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrateqSec", "[", "qSec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", ",", "myqSec"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"IntegrateqPart", "/@", "qSec"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"myqSec", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
            "myqSec", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "<", "2"}], ",", 
          RowBox[{"myqSec", "=", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Simplify", "[", 
              RowBox[{"Plus", "@@", 
               RowBox[{"Flatten", "[", "myqSec", "]"}]}], "]"}], "}"}], 
            "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165388352307715`*^9, 3.816538835440772*^9}, {
  3.8165399045782795`*^9, 3.816539905808281*^9}, {3.8166274563498497`*^9, 
  3.816627456999851*^9}, {3.8166372993424997`*^9, 3.8166373054889107`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"cd4e4332-93fe-4c3a-8078-c308224fdf96"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Polynomial Manipulations", "Subsection",
 CellChangeTimes->{{3.816538863114811*^9, 3.8165388633258114`*^9}, {
  3.81653890509287*^9, 
  3.8165389216748934`*^9}},ExpressionUUID->"96de1123-f0ea-46f5-a4be-\
2232f07f929f"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8165390126300216`*^9, 3.8165390194700313`*^9}, 
   3.8165390613970904`*^9, 
   3.816539270471385*^9},ExpressionUUID->"39635031-1306-4260-9bdf-\
14da131d6241"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "\"\<poly\>\"", " ", "and", " ", "\"\<term\>\"", " ", "are", " ", "used", 
     " ", "to", " ", "handle", " ", "the", " ", "CDE", " ", "procedure"}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
    "A", " ", "\"\<poly\>\"", " ", "is", " ", "a", " ", "list", " ", "of", 
     " ", "\"\<terms\>\""}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "while", " ", "a", " ", "\"\<term\>\"", " ", "consists", " ", "of", " ", 
      "three", " ", "lists", "\[IndentingNewLine]", "term"}], "=", 
     RowBox[{"{", 
      RowBox[{"qSec", ",", " ", "Oper", ",", " ", "Ord"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"for", " ", "example", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UCDEDim", "[", "4", "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "6"], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "2"]], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "3"]]}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "2"]], ",", 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "3"]], ",", "U"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]",
     "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"GCDEDim", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Nu]", "1"], ",", 
          SubscriptBox["\[Nu]", "2"]}], "}"}], ",", "4"}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["\[ImaginaryI]", "8"]}], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "2"]]}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "1"]], ",", 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "2"]], ",", 
          SubscriptBox["F", 
           RowBox[{
            SubscriptBox["\[Nu]", "1"], ",", 
            SubscriptBox["\[Nu]", "2"]}]]}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "2"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "The", " ", "first", " ", "list", " ", "\"\<qSec\>\"", " ", "is", " ", 
      "the", " ", "q"}], "-", 
     RowBox[{"Section", " ", "of", " ", "the", " ", 
      RowBox[{"term", ".", " ", "This"}], " ", "part", " ", "will", " ", "be",
       " ", "integrated", " ", "over", " ", "eventually"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "The", " ", "second", " ", "list", " ", "\"\<Oper\>\"", " ", "stores", 
     " ", "the", " ", "effective", " ", 
     RowBox[{"operator", ".", " ", "This"}], " ", "part", " ", "will", " ", 
     "be", " ", "shown", " ", "in", " ", "the", " ", "final", " ", "result"}],
     ";", 
    RowBox[{
     RowBox[{
     "The", " ", "third", " ", "list", " ", "\"\<Ord\>\"", " ", "consists", 
      " ", "of", " ", "two", " ", "auxiliary", " ", "parameters", 
      "\[IndentingNewLine]", "Ord"}], "=", 
     RowBox[{"{", 
      RowBox[{"dim", ",", " ", "ndummy"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "respectively"}], ",", " ", 
   RowBox[{
    RowBox[{"they", " ", "are"}], ";", "\[IndentingNewLine]", 
    RowBox[{"dim", "      ", "the", " ", "operator", " ", "dimension"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "ndummy", "   ", "the", " ", "number", " ", "of", " ", "dummy", " ", 
     "Lorentz", " ", "index", " ", "pairs", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Mu]", "i"], " ", "indices"}], ")"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
    "The", " ", "numbers", " ", "of", " ", "dummy", " ", "Lorentz", " ", 
     "indices"}]}], ",", " ", "\"\<ndummy\>\"", ",", " ", 
   RowBox[{
    RowBox[{
    "is", " ", "only", " ", "used", " ", "in", " ", "the", " ", "steps", " ", 
     "of", " ", "generating", " ", "the", " ", "CDE", " ", "poly"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Once", " ", "we", " ", "obtain", " ", "the", " ", "poly", " ", "and", 
     " ", "move", " ", "on", " ", "to", " ", "address", " ", "the", " ", 
     "loop", " ", "integral", " ", 
     RowBox[{"(", 
      RowBox[{"see", " ", "the", " ", "main", " ", "function", " ", 
       RowBox[{"SuperTrace", "[", "]"}], " ", "below"}], ")"}]}]}], ",", " ", 
   RowBox[{
   "it", " ", "will", " ", "no", " ", "longer", " ", "be", " ", "in", " ", 
    RowBox[{"use", ".", " ", "In"}], " ", "the", " ", "final", " ", 
    "output"}], ",", " ", 
   RowBox[{"it", " ", "will", " ", "be", " ", "discarded"}], ",", " ", 
   RowBox[{
   "and", " ", "only", " ", "\"\<dim\>\"", " ", "will", " ", "be", " ", 
    RowBox[{"kept", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.8165392657203784`*^9, 3.816539270471385*^9}, {
  3.816539929312314*^9, 3.816539930812316*^9}, {3.816623738450248*^9, 
  3.8166237801883063`*^9}, {3.816623814734355*^9, 3.8166239096944895`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"df612e1b-605d-4fe1-b23f-aae800bb3796"]
}, Closed]],

Cell[CellGroupData[{

Cell["Term and Poly Arithmetic", "Subsubsection",
 CellChangeTimes->{{3.8165392723813877`*^9, 
  3.8165392903954134`*^9}},ExpressionUUID->"f9989a9d-7ef3-44fb-80cc-\
c8714de5ac99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "CollectPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SimplifyPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MultiplyTerms", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MultiplyPolys", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165392732513885`*^9, 3.816539273431389*^9}, {
   3.816539949975343*^9, 3.816539951415345*^9}, {3.816558919577715*^9, 
   3.8165589197493153`*^9}, 3.8165591114346523`*^9, {3.81655926418452*^9, 
   3.8165592643249207`*^9}, 3.8165596515698004`*^9, {3.816560095723779*^9, 
   3.81656009587978*^9}, {3.816561481989013*^9, 3.8165614876362233`*^9}, {
   3.816562598449374*^9, 3.816562599026575*^9}, {3.816564463356248*^9, 
   3.8165644634966483`*^9}, 3.8165649943499804`*^9, {3.8166217705654726`*^9, 
   3.8166217737354774`*^9}, {3.8166219448117185`*^9, 3.816621951902728*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"48d2fec3-88da-4ff8-a097-bb1991367c4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Collect", " ", "terms", " ", "with", " ", "identical", " ", "Oper", " ", 
    "and", " ", "Ord", " ", "in", " ", "a", " ", "poly"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CollectPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "collect", " ", "terms", " ", "with", " ", "identical", " ", "Oper", 
         " ", "and", " ", "Ord"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Join", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "&"}], "/@", "#"}], ")"}]}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{"poly", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              "}"}], "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"simplify", " ", "qSec"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"SimplifyqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"sort", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "poly", " ", "by", " ", "collecting", " ", 
     "and", " ", "simplifying", " ", "its", " ", "terms"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimplifyPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qSecArray", ",", "OperArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "move", " ", "all", " ", "commuting", " ", "factors", " ", 
          "including", " ", "constants"}], ",", " ", 
         SubscriptBox["m", "i"], ",", " ", 
         SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], ",", " ", 
         RowBox[{"and", " ", 
          SubscriptBox["\[Epsilon]", "\[Mu]\[Nu]\[Rho]\[Sigma]"], " ", "in", 
          " ", "Oper", " ", "to", " ", "qSec"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"qSecArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ScaleqSec", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Times", "@@", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{"_", "?", "NumericQ"}], "|", 
                 SubscriptBox["m", "_"], "|", 
                 SubscriptBox["\[Eta]", "__"], "|", 
                 SubscriptBox["\[Epsilon]", "__"]}]}], "]"}]}]}], "]"}], 
           "&"}], "/@", "poly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OperArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"_", "?", "NumericQ"}], "|", 
                  SubscriptBox["m", "_"], "|", 
                  SubscriptBox["\[Eta]", "__"], "|", 
                  SubscriptBox["\[Epsilon]", "__"]}]}], "]"}], "&"}], "/@", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "=!=", 
                RowBox[{"{", "}"}]}], ")"}], "&"}]}], "]"}], "&"}], "/@", 
          "poly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"#3", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "\[Rule]", "#1"}], ",", 
                RowBox[{"2", "\[Rule]", "#2"}]}], "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"qSecArray", ",", "OperArray", ",", "poly"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "collect", " ", "terms", " ", "with", " ", "identical", " ", 
          "Oper"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Join", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "&"}], "/@", "#"}], ")"}]}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"GatherBy", "[", 
           RowBox[{"mypoly", ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"simplify", " ", "qSec"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"SimplifyqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"sort", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Multiply", " ", "a", " ", "list", " ", "of", " ", "terms", " ", "into", 
     " ", "a", " ", "term"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiplyTerms", "[", "termArray_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dummyshiftArray", ",", "mytermArray", ",", "qSec", ",", "Oper", ",", 
         "Ord", ",", "indices", ",", "indicesOpen", ",", "indicesDummy", ",", 
         "ndummy", ",", "n\[Mu]", ",", "myterm"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"distinguish", " ", "dummy", " ", "indices", " ", 
         SubscriptBox["\[Mu]", "i"], " ", "before", " ", "multiplying", " ", 
         "terms"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dummyshiftArray", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{
            RowBox[{"Accumulate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ")"}], "&"}], "/@", "termArray"}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{";;", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mytermArray", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "n_"], "\[Rule]", 
               SubscriptBox["\[Mu]", 
                RowBox[{"n", "+", "#2"}]]}], "}"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"termArray", ",", "dummyshiftArray"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"multiply", " ", "terms"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"MultiplyqSecs", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "mytermArray"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Oper", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "mytermArray"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ord", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "mytermArray"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"{", 
          RowBox[{"qSec", ",", "Oper", ",", "Ord"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "convert", " ", "new", " ", "dummy", " ", "Lorentz", " ", "indices", 
          " ", "into", " ", 
          SubscriptBox["\[Mu]", "i"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"n\[Mu]", "=", 
         RowBox[{
         "Ord", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{
               "qSec", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{"Flatten", "[", "Oper", "]"}]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"_", "?", "NumericQ"}], "|", 
            SubscriptBox["\[Mu]", "_"]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indicesOpen", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"indices", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], "\[Equal]", "1"}], ")"}],
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"indicesOpen", ",", 
             SubscriptBox["\[Mu]", "_"]}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<MultiplyTerms called with term containing open \
\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\) indices: term=\>\"", ",", "myterm"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"indicesDummy", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"indices", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], ")"}], 
             "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndummy", "=", 
         RowBox[{"Length", "[", "indicesDummy", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"myterm", "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "\[Rule]", 
               SubscriptBox["\[Mu]", 
                RowBox[{"n\[Mu]", "+", "#2"}]]}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"indicesDummy", ",", 
              RowBox[{"Range", "[", "ndummy", "]"}]}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "myterm", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "=", 
         RowBox[{"n\[Mu]", "+", "ndummy"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Multiply", " ", "a", " ", "list", " ", "of", " ", "polys", " ", "into", 
     " ", "a", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MultiplyPolys", "[", "polyArray_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"MultiplyTerms", "/@", 
          RowBox[{"Tuples", "[", "polyArray", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"CollectPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165393096084404`*^9, 3.8165393097784405`*^9}, {
   3.8165399627973614`*^9, 3.816539963447362*^9}, {3.81655376603236*^9, 
   3.816553770493968*^9}, {3.816558909656098*^9, 3.816558910295699*^9}, {
   3.8165589858544316`*^9, 3.8165590075696697`*^9}, {3.8165591024334364`*^9, 
   3.8165591084238467`*^9}, {3.8165591504135203`*^9, 3.8165593096274*^9}, {
   3.816559394106948*^9, 3.816559482793104*^9}, {3.8165595132755575`*^9, 
   3.816559647560593*^9}, 3.816559703276291*^9, {3.8165597517143764`*^9, 
   3.8165597599199905`*^9}, {3.8165601002477875`*^9, 
   3.8165601012149887`*^9}, {3.816560337303403*^9, 3.81656037012586*^9}, {
   3.816560456630412*^9, 3.8165604589236164`*^9}, {3.8165604967848825`*^9, 
   3.8165605865630407`*^9}, {3.8165606766687984`*^9, 
   3.8165607684281597`*^9}, {3.816560811733836*^9, 3.8165608673323336`*^9}, {
   3.8165609144288163`*^9, 3.8165609377508574`*^9}, {3.8165610273106146`*^9, 
   3.8165610287614174`*^9}, {3.816561062551077*^9, 3.816561066794284*^9}, {
   3.816561122517582*^9, 3.8165611845120907`*^9}, {3.816561216492147*^9, 
   3.816561216648147*^9}, {3.8165612564750175`*^9, 3.816561303228299*^9}, {
   3.816561429245321*^9, 3.8165614656245847`*^9}, {3.816561646399702*^9, 
   3.8165617654747114`*^9}, {3.816561818234004*^9, 3.81656184439525*^9}, {
   3.8165619084957623`*^9, 3.8165619131289706`*^9}, {3.8165619683686676`*^9, 
   3.816561971441873*^9}, {3.816562011143943*^9, 3.8165621033869047`*^9}, {
   3.8165621948966656`*^9, 3.816562234317935*^9}, {3.8165622911800346`*^9, 
   3.816562298090847*^9}, {3.8165623794605894`*^9, 3.8165625405776725`*^9}, {
   3.8165626014601793`*^9, 3.816562628807027*^9}, {3.816563049383766*^9, 
   3.8165630496645665`*^9}, {3.8165630811454215`*^9, 
   3.8165631239206967`*^9}, {3.8165637721510353`*^9, 3.8165637865186605`*^9}, 
   3.8165640518051267`*^9, {3.8165644703138604`*^9, 3.8165644704854603`*^9}, {
   3.8165645294067636`*^9, 3.8165645748184433`*^9}, {3.816564616891717*^9, 
   3.816564686311839*^9}, {3.8165647296955156`*^9, 3.816564734157123*^9}, {
   3.8165647710667877`*^9, 3.8165649259750605`*^9}, {3.8165649564107137`*^9, 
   3.816564991448375*^9}, {3.816606910529769*^9, 3.816606937323807*^9}, {
   3.816607372497424*^9, 3.81660741234348*^9}, {3.8166207238626175`*^9, 
   3.816620727173622*^9}, {3.8166216180228767`*^9, 3.816621692544363*^9}, {
   3.81662174728244*^9, 3.8166218105315294`*^9}, {3.8166218635786037`*^9, 
   3.816621864468605*^9}, {3.8166222209641075`*^9, 3.8166222211041074`*^9}, {
   3.81663717986189*^9, 3.8166372286899757`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"5eeb4871-8412-4526-9c95-a3b4194d817c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trimmings", "Subsubsection",
 CellChangeTimes->{{3.8165392746713905`*^9, 
  3.8165392935654173`*^9}},ExpressionUUID->"56d19092-113d-41d2-ae31-\
a3650e1f3a40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "qPartFVanish", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FTrimqSec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FTrimTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FTrimPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "qEvenTrimPoly", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPAllTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IBPAllPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Eta]pairTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "MoveLorentzTerm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FIndexOrgOper", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "OperIndexOrgTerm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFpattern0", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFpattern1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFrules1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FUrules", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "PPFOrgTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "FUOrgTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "All\[Gamma]Pairings", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Trace\[Gamma]Term", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165393585465093`*^9, 3.816539358716509*^9}, {
   3.816539980660386*^9, 3.816539981820388*^9}, {3.8166275091759253`*^9, 
   3.816627509315925*^9}, 3.816637938726223*^9, 3.816641636405861*^9, {
   3.8166422336997104`*^9, 3.816642234105311*^9}, {3.8166428272339525`*^9, 
   3.8166428297143574`*^9}, {3.8166509602199574`*^9, 
   3.8166509603915577`*^9}, {3.816655123160069*^9, 3.816655124158471*^9}, {
   3.8166553762393136`*^9, 3.816655378251717*^9}, {3.816655711249902*^9, 
   3.8166557173183126`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"74a28995-db8d-4e1c-b961-3af991b2b959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "if", " ", "a", " ", "qPart", " ", "vanishes", " ", "upon", 
    " ", "contracting", " ", "with", " ", "a", " ", "given", " ", 
    SubscriptBox["F", "\[Mu]\[Nu]"]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"qPartFVanish", "[", 
      RowBox[{"qPart_", ",", "F\[Mu]pair_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myqPartSplit", ",", "q\[Mu]listArray", ",", "dq\[Mu]listArray", ",", 
         "\[Eta]\[Mu]pairlist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqPartSplit", "=", 
         RowBox[{"SplitqPart", "[", "qPart", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "if", " ", "qPart", " ", "vanishes", " ", "due", " ", 
          "to", " ", 
          SubscriptBox["q", "\[Mu]"], 
          SubscriptBox["q", "\[Nu]"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"q\[Mu]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SubscriptBox["q", "sub__"], "\[Rule]", "sub"}]}], "]"}], "&"}], 
          "/@", "myqPartSplit"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "F\[Mu]pair"}], "]"}], "&"}], "/@", 
             "q\[Mu]listArray"}], ")"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "if", " ", "qPart", " ", "vanishes", " ", "due", " ", 
          "to", " ", 
          SubscriptBox["dq", "\[Mu]"], 
          SubscriptBox["dq", "\[Nu]"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dq\[Mu]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SubscriptBox["dq", "sub__"], "\[Rule]", "sub"}]}], "]"}], "&"}],
           "/@", "myqPartSplit"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "F\[Mu]pair"}], "]"}], "&"}], "/@", 
             "dq\[Mu]listArray"}], ")"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "if", " ", "qPart", " ", "vanishes", " ", "due", " ", 
          "to", " ", 
          SubscriptBox["\[Eta]", "\[Mu]\[Nu]"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]\[Mu]pairlist", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"qPart", ",", 
           RowBox[{
            SubscriptBox["\[Eta]", "sub__"], "\[Rule]", 
            RowBox[{"{", "sub", "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"\[Eta]\[Mu]pairlist", ",", "F\[Mu]pair"}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"\[Eta]\[Mu]pairlist", ",", 
             RowBox[{"Reverse", "[", "F\[Mu]pair", "]"}]}], "]"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"FTrim", " ", "a", " ", "qSec"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FTrimqSec", "[", 
      RowBox[{"qSec_", ",", "F\[Mu]pair_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "myqSec", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"qSec", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"qPartFVanish", "[", 
              RowBox[{"#", ",", "F\[Mu]pair"}], "]"}]}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"myqSec", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myqSec", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"FTrim", " ", "a", " ", "term"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FTrimTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"F\[Mu]pairlist", ",", "myqSec", ",", "myterm"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"F\[Mu]pairlist", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
            "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            SubscriptBox["F", "a__"], "\[Rule]", 
            RowBox[{"{", "a", "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"Fold", "[", 
          RowBox[{"FTrimqSec", ",", 
           RowBox[{
           "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "F\[Mu]pairlist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"FTrim", " ", "a", " ", "poly"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FTrimPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"FTrimTerm", "/@", "poly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Trim", " ", "a", " ", "poly", " ", "by", " ", "keeping", " ", "only", 
      " ", "even", " ", "parts", " ", "under", " ", "q"}], "\[Rule]", 
     RowBox[{"-", "q"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"qEvenTrimPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                 RowBox[{"EvenQ", "[", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["q", "__"]}], "]"}], "+", 
                   RowBox[{"Count", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["dq", "__"]}], "]"}]}], "]"}], "&"}]}], 
               "]"}]}]}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "term", " ", "to", " ", 
     "remove", " ", "one", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper", " ", "to", " ", "get", " ", "a", " ", 
     "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myOper", ",", "len", ",", "myOperArray", ",", "mypoly"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "myOper", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"len", "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "term", "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"myOper", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             SubscriptBox["P", "__"]}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "term", "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myOperArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"myOper", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "\[Rule]", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", " ", 
                    RowBox[{
                    RowBox[{"myOper", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                   "}"}], ",", 
                  RowBox[{
                  "myOper", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "\[Rule]", 
                RowBox[{"Delete", "[", 
                 RowBox[{
                  RowBox[{"myOper", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", "1"}], 
                 "]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"len", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"2", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          "myOperArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "poly", " ", "to", " ", 
     "remove", " ", "one", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"IBPTerm", "/@", "poly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "term", " ", "to", " ", 
     "remove", " ", "all", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper", " ", "to", " ", "get", " ", "a", " ", 
     "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPAllTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nIBP", ",", "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nIBP", "=", 
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
           SubscriptBox["P", "__"]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"{", "term", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Nest", "[", 
          RowBox[{"IBPPoly", ",", "mypoly", ",", "nIBP"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "IBP", " ", "on", " ", "a", " ", "poly", " ", "to", " ", 
     "move", " ", "all", " ", 
     SubscriptBox["P", "\[Mu]"], " ", "on", " ", "the", " ", "last", " ", 
     "factor", " ", "in", " ", "Oper"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IBPAllPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"IBPAllTerm", "/@", "poly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Contract", " ", "a", " ", "term", " ", "with", " ", "an", " ", 
     SubscriptBox["\[Eta]", "\[Mu]\[Nu]"]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Eta]pairTerm", "[", 
      RowBox[{"term_", ",", "\[Eta]pair_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myOper", ",", "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"myOper", ",", 
             RowBox[{
             "\[Eta]pair", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], ",", "All"}], "]"}], "\[Equal]", 
           "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"myOper", "=", 
           RowBox[{"myOper", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\[Eta]pair", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "\[Eta]pair", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"myOper", ",", 
                RowBox[{
                "\[Eta]pair", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "All"}], "]"}], "\[Equal]", 
              "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"myOper", "=", 
              RowBox[{"myOper", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "\[Eta]pair", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{
                 "\[Eta]pair", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myOper", "=", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", 
                    SubscriptBox["\[Eta]", "\[Eta]pair"], "}"}], "}"}], ",", 
                  "myOper"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["\[Eta]", 
                   RowBox[{"{", "a__", "}"}]], "\[Rule]", 
                  SubscriptBox["\[Eta]", "a"]}], "}"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"2", "\[Rule]", "myOper"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Move", " ", 
     SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], " ", "and", " ", 
     SubscriptBox["\[Epsilon]", "\[Mu]\[Nu]\[Rho]\[Sigma]"], " ", "in", " ", 
     "the", " ", "qSec", " ", "of", " ", "a", " ", "term", " ", "to", " ", 
     "the", " ", "Oper", " ", "to", " ", "get", " ", "a", " ", "poly"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveLorentzTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myqSec", ",", "\[Eta]pairsArray", ",", "\[Epsilon]listArray", ",", 
         "qSecArray", ",", "OperArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myqSec", "=", 
         RowBox[{"SimplifyqSec", "[", 
          RowBox[{
          "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"move", " ", 
          SubscriptBox["\[Eta]", "\[Mu]\[Nu]"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"1", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"#", ",", 
                SubscriptBox["\[Eta]", "__"]}], "]"}], "}"}], "&"}], "/@", 
            "myqSec"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]pairsArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SubscriptBox["\[Eta]", "a__"], "\[Rule]", 
              RowBox[{"{", "a", "}"}]}]}], "]"}], "&"}], "/@", "myqSec"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Fold", "[", 
             RowBox[{"\[Eta]pairTerm", ",", "#1", ",", "#2"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"mypoly", ",", "\[Eta]pairsArray"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{"{", 
                 SubscriptBox["F", 
                  RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"__", ",", 
                  SubscriptBox["F", 
                   RowBox[{"\[Mu]_", ",", "\[Mu]_"}]]}], "}"}]}]}], "]"}], 
             "\[Equal]", "0"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"move", " ", 
          SubscriptBox["\[Epsilon]", "\[Mu]\[Nu]\[Rho]\[Sigma]"]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Epsilon]listArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             SubscriptBox["\[Epsilon]", "__"]}], "]"}], "&"}], "/@", 
          "mypoly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"qSecArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
              SubscriptBox["\[Epsilon]", "__"]}], "]"}], "}"}], "&"}], "/@", 
          "mypoly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OperArray", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#2", "===", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", "#2", "}"}], ",", 
                RowBox[{
                "#1", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"mypoly", ",", "\[Epsilon]listArray"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"#3", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "\[Rule]", "#1"}], ",", 
                RowBox[{"2", "\[Rule]", "#2"}]}], "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"qSecArray", ",", "OperArray", ",", "mypoly"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Organize", " ", "the", " ", "indices", " ", "of", " ", "the", " ", "nth",
      " ", 
     SubscriptBox["F", "\[Mu]\[Nu]"], " ", "in", " ", "an", " ", "Oper"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FIndexOrgOper", "[", 
      RowBox[{"oper_", ",", "n_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mylist", ",", "partNolist", ",", "partNo", ",", "\[Mu]pair", ",", 
         "indices", ",", "dummyindices", ",", "\[Mu]pairother", ",", 
         "myOper"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mylist", "=", 
         RowBox[{"Flatten", "[", "oper", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"partNolist", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Tuples", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "#", "}"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                  "oper", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}], "]"}], "]"}]}], "}"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "oper", "]"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"partNo", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"partNolist", ",", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"oper", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "\[RightDoubleBracket]"}], ",", 
                 SubscriptBox["F", "__"]}], "]"}], "&"}], ")"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]pair", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mylist", ",", 
            RowBox[{
             SubscriptBox["F", "a__"], "\[Rule]", 
             RowBox[{"{", "a", "}"}]}]}], "]"}], "\[LeftDoubleBracket]", "n", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"mylist", ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dummyindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"indices", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], "&"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "if", " ", "\[Mu]pair", " ", "are", " ", "not", " ", "both", " ", 
           "dummy", " ", "indices"}], ",", " ", 
          RowBox[{"put", " ", "indices", " ", "in", " ", 
           SubscriptBox["F", "\[Mu]\[Nu]"], " ", "in", " ", "canonical", " ", 
           "order", " ", "using", " ", "its", " ", "antisymmetry"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"SubsetQ", "[", 
            RowBox[{"dummyindices", ",", "\[Mu]pair"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", "\[Mu]pair", "]"}], "===", "\[Mu]pair"}], 
             ",", 
             RowBox[{"Return", "[", "oper", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myOper", "=", 
            RowBox[{"Flatten", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplacePart", "[", 
                RowBox[{"oper", ",", 
                 RowBox[{"partNo", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    SubscriptBox["F", 
                    RowBox[{"Reverse", "[", "\[Mu]pair", "]"}]]}], "}"}]}]}], 
                "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["F", 
                  RowBox[{"{", "a__", "}"}]], "\[Rule]", 
                 SubscriptBox["F", "a"]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "myOper", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "if", " ", "\[Mu]pair", " ", "are", " ", "both", " ", "dummy", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "canonically", " ", "order", " ", "both", " ", "dummy", " ", 
           "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Mu]pairother", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Delete", "[", 
               RowBox[{"oper", ",", "partNo"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"\[Mu]pair", ",", "#"}], "]"}], "&"}], ")"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Mu]pair", "===", "\[Mu]pairother"}], ",", 
          RowBox[{"Return", "[", "oper", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", "\[Mu]pair", "]"}], "=!=", "\[Mu]pair"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myOper", "=", 
            RowBox[{"Flatten", "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ReplacePart", "[", 
                RowBox[{"oper", ",", 
                 RowBox[{"partNo", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    SubscriptBox["F", 
                    RowBox[{"Reverse", "[", "\[Mu]pair", "]"}]]}], "}"}]}]}], 
                "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["F", 
                  RowBox[{"{", "a__", "}"}]], "\[Rule]", 
                 SubscriptBox["F", "a"]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "myOper", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"oper", ",", 
              RowBox[{"partNo", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 SubscriptBox["F", 
                  RowBox[{"Reverse", "[", "\[Mu]pair", "]"}]]}], "}"}]}]}], 
             "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["F", 
               RowBox[{"{", "a__", "}"}]], "\[Rule]", 
              SubscriptBox["F", "a"]}], "}"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"myOper", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "\[Mu]pair", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myOper", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Organize", " ", "the", " ", "indices", " ", "of", " ", "Oper", " ", "in",
      " ", "a", " ", "term"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OperIndexOrgTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myOper", ",", "indices", ",", "dummyindices", ",", "openindices", 
         ",", "Fpairs", ",", "ndummy", ",", "nopen", ",", "nF", ",", 
         "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "indices", " ", "in", " ", "Oper"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dummyindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"indices", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], "&"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"openindices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"indices", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], "&"}], 
             ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndummy", "=", 
         RowBox[{"Length", "[", "dummyindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nopen", "=", 
         RowBox[{"Length", "[", "openindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"openindices", ",", 
             SubscriptBox["\[Mu]", "_"]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<OperIndexOrgTerm called with open indices containing \
\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\).\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<open indices=\>\"", ",", "openindices"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<term=\>\"", ",", "term"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"canonically", " ", "order", " ", "dummy", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"term", "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "\[Rule]", 
              SubscriptBox["\[Mu]", "#2"]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"dummyindices", ",", 
              RowBox[{"Range", "[", "ndummy", "]"}]}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"canonically", " ", "order", " ", 
          SubscriptBox["F", "\[Mu]\[Nu]"], " ", "indices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{
         "myterm", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nF", "=", 
         RowBox[{"Count", "[", 
          RowBox[{"myOper", ",", 
           SubscriptBox["F", "__"], ",", "All"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Fold", "[", 
          RowBox[{"FIndexOrgOper", ",", "myOper", ",", 
           RowBox[{"Range", "[", "nF", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"myterm", ",", 
           RowBox[{"2", "\[Rule]", "myOper"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "PPF", " ", "paterns", " ", "and", " ", "their", " ", "simplification", 
     " ", "rules"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PPFpattern0", "=", 
     RowBox[{"Alternatives", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Nu]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PPFpattern1", "=", 
     RowBox[{"Alternatives", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PPFrules1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            SubscriptBox["P", "\[Nu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a__", ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"-", "1"}], ",", 
            SubscriptBox["P", "\[Nu]"], ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"-", "\[ImaginaryI]"}], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Nu]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Rho]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Nu]_", ",", "\[Mu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Nu]", ",", "\[Mu]"}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a__", ",", 
          SubscriptBox["P", "\[Mu]_"], ",", 
          SubscriptBox["P", "\[Rho]_"], ",", 
          SubscriptBox["F", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}]]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", 
            SubscriptBox["P", "\[Rho]"], ",", 
            SubscriptBox["P", "\[Mu]"], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "\[ImaginaryI]", ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Rho]"}]], ",", 
            SubscriptBox["F", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}]]}], "}"}]}], "}"}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FUrules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["F", "a__"], ",", "U__"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["F", "a"], "}"}], ",", 
           RowBox[{"{", "U", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "U", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             SubscriptBox["F", "a"]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "PPF", " ", "simplification", " ", "rules", " ", "on", " ", 
     "a", " ", "term", " ", "to", " ", "get", " ", "a", " ", "poly"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PPFOrgTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"operArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{
             "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "PPFpattern0"}], "]"}], "\[NotEqual]", " ", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"operArray", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{"#", ",", "PPFpattern1"}], "]"}], ",", "#", ",", 
                RowBox[{"{", "#", "}"}]}], "]"}], "&"}], "/@", 
             RowBox[{
             "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
             ")"}], "/.", "PPFrules1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"2", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          "operArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Use", " ", "FU", " ", "simplification", " ", "rules", " ", "on", " ", 
     "a", " ", "term", " ", "to", " ", "get", " ", "a", " ", "poly"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FUOrgTerm", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"operArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"operArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["F", "__"], ",", "__"}], "}"}]}], "]"}], ",",
                  "#", ",", 
                 RowBox[{"{", 
                  RowBox[{"{", "#", "}"}], "}"}]}], "]"}], "&"}], "/@", 
              RowBox[{
              "term", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], ")"}], "/.", "FUrules"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"2", "\[Rule]", "#"}]}], "]"}], "&"}], "/@", 
          "operArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "\[Eta]expr", " ", "from", " ", "all", " ", 
     "\[Gamma]", " ", "pairings", " ", 
     RowBox[{"(", 
      RowBox[{"alternating", " ", "pairings"}], ")"}], " ", "of", " ", "an", 
     " ", "even", " ", "number", " ", "of", " ", "indices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"All\[Gamma]Pairings", "[", 
      RowBox[{"{", "}"}], "]"}], ":=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"All\[Gamma]Pairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
     SubscriptBox["\[Eta]", 
      RowBox[{"a", ",", "b"}]]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"All\[Gamma]Pairings", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b__"}], "}"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"k", "-", "1"}]], 
        SubscriptBox["\[Eta]", 
         RowBox[{"a", ",", 
          RowBox[{
           RowBox[{"{", "b", "}"}], "\[LeftDoubleBracket]", "k", 
           "\[RightDoubleBracket]"}]}]], 
        RowBox[{"All\[Gamma]Pairings", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"{", "b", "}"}], ",", "k"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "a", " ", "term", " ", "to", " ", "get", " ", "a", " ", 
     "poly", " ", "when", " ", "the", " ", "Ulist", " ", "has", " ", "no", 
     " ", "\[Gamma]", " ", "dependence"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Trace\[Gamma]Term", "[", "term_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myOper", ",", "n\[Mu]", ",", "\[Mu]starts", ",", "coeff", ",", 
         "\[Gamma]\[Mu]list", ",", "\[Eta]expr", ",", "\[Eta]pairArray", ",", 
         "coeffArray", ",", "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myOper", "=", 
         RowBox[{
         "term", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"replace", " ", "\[Sigma]F", " ", "with", " ", 
          SubscriptBox["\[ImaginaryI]\[Gamma]", "\[Mu]"], 
          SubscriptBox["\[Gamma]", "\[Nu]"], 
          SubscriptBox["F", "\[Mu]\[Nu]"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"n\[Mu]", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
                RowBox[{
                 SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
              RowBox[{
               SubscriptBox["\[Mu]", "b_"], "\[Rule]", "b"}]}], "]"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Mu]starts", "=", 
         RowBox[{"n\[Mu]", "+", 
          RowBox[{"2", "\[Times]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{
              RowBox[{"Accumulate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Count", "[", 
                  RowBox[{"#", ",", "\[Sigma]F"}], "]"}], "&"}], "/@", 
                "myOper"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}]}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "/.", 
              RowBox[{"{", 
               RowBox[{"\[Sigma]F", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\[ImaginaryI]", ",", 
                  SubscriptBox["\[Gamma]", 
                   SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "1"}]]], ",", 
                  SubscriptBox["\[Gamma]", 
                   SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "2"}]]], ",", 
                  SubscriptBox["F", 
                   RowBox[{
                    SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "1"}]], ",", 
                    SubscriptBox["\[Mu]", 
                    RowBox[{"#2", "+", "2"}]]}]]}], "}"}]}], "}"}]}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"myOper", ",", "\[Mu]starts"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"extract", " ", "constants", " ", "and", " ", "\[Gamma]"}], 
          ",", " ", 
          RowBox[{
          "and", " ", "carry", " ", "out", " ", "trace", " ", "of", " ", 
           "\[Gamma]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]\[Mu]list", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "myOper", "]"}], ",", 
             SubscriptBox["\[Gamma]", "__"]}], "]"}], ",", 
           RowBox[{
            SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]expr", "=", 
         RowBox[{
          RowBox[{"coeff", " ", 
           RowBox[{"All\[Gamma]Pairings", "[", "\[Gamma]\[Mu]list", "]"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Eta]", 
             RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "\[Rule]", "d"}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]pairArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"#", "/.", 
               RowBox[{"{", 
                RowBox[{"Times", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}], 
            ")"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"\[Eta]expr", "/.", 
             RowBox[{"{", 
              RowBox[{"Plus", "\[Rule]", "List"}], "}"}]}], "}"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "multiply", " ", "\[Eta]expr", " ", "with", " ", "Oper", " ", "to", 
          " ", "get", " ", "a", " ", "poly"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coeffArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", "d"}]}], "]"}]}], ")"}], 
           "&"}], "/@", "\[Eta]pairArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myOper", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["\[Gamma]", "__"]}]}], "]"}], "&"}], "/@", 
          "myOper"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "\[Rule]", 
                RowBox[{"ScaleqSec", "[", 
                 RowBox[{
                  RowBox[{
                  "term", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "#"}], "]"}]}], ",", 
               RowBox[{"2", "\[Rule]", "myOper"}]}], "}"}]}], "]"}], "&"}], "/@",
           "coeffArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]pairArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", "d"}]}], "]"}], ",", 
             RowBox[{
              SubscriptBox["\[Eta]", "a__"], "\[Rule]", 
              RowBox[{"{", "a", "}"}]}]}], "]"}], "&"}], "/@", 
          "\[Eta]pairArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Fold", "[", 
             RowBox[{"\[Eta]pairTerm", ",", "#1", ",", "#2"}], "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"mypoly", ",", "\[Eta]pairArray"}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{"{", 
                 SubscriptBox["F", 
                  RowBox[{"\[Mu]_", ",", "\[Mu]_"}]], "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"__", ",", 
                  SubscriptBox["F", 
                   RowBox[{"\[Mu]_", ",", "\[Mu]_"}]]}], "}"}]}]}], "]"}], 
             "\[Equal]", "0"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816539311449443*^9, 3.816539311629443*^9}, {
   3.8165399949614067`*^9, 3.8165399956914077`*^9}, {3.8166274742208757`*^9, 
   3.816627474810877*^9}, {3.8166275213979425`*^9, 3.816627623809087*^9}, {
   3.8166276908521814`*^9, 3.816627712078212*^9}, {3.8166277631352835`*^9, 
   3.8166277850803146`*^9}, {3.816628246415966*^9, 3.816628251907974*^9}, {
   3.8166298906732826`*^9, 3.816629893634287*^9}, 3.816629927779335*^9, {
   3.8166301653986697`*^9, 3.81663016558867*^9}, {3.816630359219943*^9, 
   3.8166303594399433`*^9}, {3.816637925981001*^9, 3.8166379306142087`*^9}, {
   3.8166379960691233`*^9, 3.8166380626656404`*^9}, {3.816638100105706*^9, 
   3.816638123365347*^9}, {3.8166382335951405`*^9, 3.8166382386651497`*^9}, {
   3.8166385519293*^9, 3.816638559682513*^9}, {3.8166387868345127`*^9, 
   3.8166388232293763`*^9}, {3.816638872073062*^9, 3.8166390700998096`*^9}, {
   3.81663911577669*^9, 3.8166391518907537`*^9}, 3.8166391943228283`*^9, {
   3.8166392355381002`*^9, 3.8166392431509137`*^9}, 3.8166392816205816`*^9, {
   3.8166393203866496`*^9, 3.816639322508253*^9}, {3.81664106644326*^9, 
   3.8166412514751854`*^9}, {3.816641285654845*^9, 3.8166414579259477`*^9}, {
   3.816641558889325*^9, 3.8166415652697363`*^9}, {3.816641614831023*^9, 
   3.8166416451574764`*^9}, {3.8166422132480745`*^9, 3.816642214090476*^9}, {
   3.8166428403379755`*^9, 3.81664284843439*^9}, {3.8166509466947336`*^9, 
   3.8166509473811345`*^9}, {3.816654829395953*^9, 3.816654829910754*^9}, {
   3.8166551099624457`*^9, 3.8166553623552895`*^9}, {3.816655398048152*^9, 
   3.816655531974387*^9}, {3.816655580287672*^9, 3.816655580989673*^9}, {
   3.816655616152135*^9, 3.816655627430955*^9}, {3.8166557011098843`*^9, 
   3.8166557012658844`*^9}, {3.8167031557822447`*^9, 3.8167031588932486`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"9cf3ed08-524c-4ebe-8632-6857abad603d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivatives and Integrals", "Subsubsection",
 CellChangeTimes->{{3.8165392757723923`*^9, 3.816539276132393*^9}, {
  3.8165393561965055`*^9, 
  3.8165393665875206`*^9}},ExpressionUUID->"446ba1b0-5e5e-4193-8f91-\
ac634dec8066"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "dqAllPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardTerm", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SymHardPoly", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "IntegratePoly", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816539313679446*^9, 3.8165393138494463`*^9}, {
  3.81654001885544*^9, 3.816540020015442*^9}, {3.8166422418117247`*^9, 
  3.8166422420145245`*^9}, {3.8166509526227436`*^9, 3.8166509530595446`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"c7c47633-5d4f-4f20-b16a-81355ef71fb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Carrying", " ", "out", " ", "all", " ", "the", " ", "dq", " ", 
    "derivatives", " ", "in", " ", "a", " ", "poly"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dqAllPoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"dqAllqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Symmetrize", " ", "a", " ", "term", " ", "and", " ", "expand", " ", "in",
      " ", "hard", " ", "region", " ", "before", " ", "performing", " ", 
     "the", " ", "q", " ", "integral"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardTerm", "[", 
      RowBox[{"term_", ",", "dim_", ",", "Heavylist_", ",", "SoftOrd_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myqSec", ",", "myexprArray", ",", "\[Eta]pairsArray", ",", 
         "myterm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "contract", " ", "all", " ", "the", " ", "Lorentz", " ", "indices", 
         " ", "in", " ", "qSec"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myexprArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Times", "@@", "#"}], ")"}], "//.", 
               "\[Eta]ContractionRules"}], ")"}], "/.", "qContractionRules"}],
             ")"}], "&"}], "/@", 
          RowBox[{
          "term", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myexprArray", "=", 
         RowBox[{
          RowBox[{"myexprArray", "/.", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Eta]", 
              RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], "\[RuleDelayed]", 
             SubscriptBox["\[Eta]", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{"\[Mu]", ",", "\[Nu]"}], "}"}], "]"}]]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[Eta]", 
             RowBox[{"{", "a__", "}"}]], "\[Rule]", 
            SubscriptBox["\[Eta]", "a"]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"qPartFromExpr", "[", "#", "]"}], "&"}], "/@", 
          "myexprArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"FTrim", " ", "the", " ", "qSec"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{
          RowBox[{"FTrimTerm", "[", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myqSec", "===", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"term", ",", 
             RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}], "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "symmetrize", " ", "qSec", " ", "and", " ", "expand", " ", "in", " ",
           "hard", " ", "region"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myqSec", "=", 
         RowBox[{"SymHardqSec", "[", 
          RowBox[{"myqSec", ",", "Heavylist", ",", 
           RowBox[{"dim", "-", 
            RowBox[{
             RowBox[{
             "term", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            "SoftOrd"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myterm", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"term", ",", 
           RowBox[{"1", "\[Rule]", "myqSec"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myterm", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Symmetrize", " ", "a", " ", "poly"}], ",", " ", 
     RowBox[{"expand", " ", "in", " ", "hard", " ", "region"}], ",", " ", 
     RowBox[{
     "and", " ", "organize", " ", "it", " ", "before", " ", "performing", " ",
       "the", " ", "q", " ", "integral"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymHardPoly", "[", 
      RowBox[{
      "poly_", ",", "dim_", ",", "Heavylist_", ",", "SoftOrd_", ",", 
       "No\[Gamma]inU_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{"IBPAllPoly", "[", "poly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SymHardTerm", "[", 
            RowBox[{"#", ",", "dim", ",", "Heavylist", ",", "SoftOrd"}], 
            "]"}], "&"}], "/@", "mypoly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"MoveLorentzTerm", "/@", "mypoly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "simplify", " ", "the", " ", "result", " ", "when", " ", "Ulist", 
          " ", "has", " ", "no", " ", "\[Gamma]", " ", "dependence"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"No\[Gamma]inU", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "delete", " ", "terms", " ", "with", " ", "odd", " ", "numbers", 
            " ", "of", " ", 
            SubscriptBox["\[Gamma]", "\[Mu]"], " ", "or", " ", "only", " ", 
            "one", " ", "\[Sigma]F"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mypoly", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"mypoly", ",", 
              RowBox[{
               RowBox[{"EvenQ", "[", 
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   ",", 
                  SubscriptBox["\[Gamma]", "__"], ",", "All"}], "]"}], "]"}], 
               "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mypoly", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"mypoly", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    SubscriptBox["\[Gamma]", "__"], ",", "All"}], "]"}], 
                    "\[Equal]", "0"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "\[Sigma]F", ",", "All"}],
                     "]"}], "\[Equal]", "1"}], ")"}]}], ")"}]}], "&"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "carry", " ", "out", " ", "trace", " ", "of", " ", "\[Gamma]"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"mypoly", "=", 
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{"Trace\[Gamma]Term", "/@", "mypoly"}], ")"}]}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"organize", " ", "and", " ", "simplify"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"OperIndexOrgTerm", "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"PPFOrgTerm", "/@", "mypoly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"FUOrgTerm", "/@", "mypoly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"MoveLorentzTerm", "/@", "mypoly"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"OperIndexOrgTerm", "/@", "mypoly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Carrying", " ", "out", " ", "the", " ", "q", " ", "integral", " ", "of", 
     " ", "a", " ", "poly"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegratePoly", "[", "poly_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"IntegrateqSec", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "]"}], "&"}], "/@", "poly"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"mypoly", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"{", "0", "}"}], "}"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165389235358963`*^9, 3.8165389237258964`*^9}, {
   3.8165400312674575`*^9, 3.8165400321784587`*^9}, {3.8166289310469303`*^9, 
   3.8166289347579355`*^9}, 3.816629435998642*^9, {3.8166295015887346`*^9, 
   3.8166295188417587`*^9}, {3.8166297487110825`*^9, 3.816629766674108*^9}, {
   3.8166298308931985`*^9, 3.8166298310431986`*^9}, {3.8166300480595045`*^9, 
   3.816630048159505*^9}, {3.8166303765339675`*^9, 3.8166303766639676`*^9}, {
   3.816637979642295*^9, 3.816637983947902*^9}, {3.8166420293237514`*^9, 
   3.8166420322565565`*^9}, {3.816642093970265*^9, 3.8166421029558806`*^9}, {
   3.8166422265860977`*^9, 3.816642226976098*^9}, {3.8166505408570204`*^9, 
   3.8166505442422266`*^9}, {3.816650582243893*^9, 3.8166505894677057`*^9}, {
   3.8166506320401807`*^9, 3.816650766543617*^9}, {3.8166508235929174`*^9, 
   3.8166508568209753`*^9}, {3.8166509125754733`*^9, 
   3.8166509132930746`*^9}, {3.816651148699488*^9, 3.8166511489022884`*^9}, {
   3.8166557465839643`*^9, 3.8166557497351694`*^9}, {3.8166559848899827`*^9, 
   3.816655994125199*^9}, {3.816656043093685*^9, 3.8166560433588853`*^9}, {
   3.816656140640656*^9, 3.816656143386261*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"cb31c9eb-e30a-4aaf-a148-f13fff5be223"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["CDE Quantities", "Subsection",
 CellChangeTimes->{{3.8165389245558977`*^9, 
  3.816538942728923*^9}},ExpressionUUID->"f52ce3c2-ad06-4121-a8c3-\
5f3ec013b45a"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.816539021221034*^9, 3.816539027682043*^9}, 
   3.8165390651870956`*^9},ExpressionUUID->"37eb0656-6fec-4975-8d97-\
213b8f1dcc82"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "The", " ", "CDE", " ", "quantities", " ", "are", " ", "defined", " ", 
    "below"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["U", "i", "CDE"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"n", "=", "0"}], "\[Infinity]"], 
       RowBox[{
        FractionBox["1", 
         RowBox[{"n", "!"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["P", 
            SubscriptBox["\[Mu]", "1"]], "..."}], 
          SubscriptBox["P", 
           SubscriptBox["\[Mu]", "n"]], 
          SubscriptBox["U", "i"]}], ")"}], 
        SubscriptBox["dq", 
         SubscriptBox["\[Mu]", "1"]]}]}], "..."}], 
     SubscriptBox["dq", 
      SubscriptBox["\[Mu]", "n"]]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["G", 
     RowBox[{
      SubscriptBox["\[Nu]", "i"], 
      SubscriptBox["\[Nu]", "j"]}], "CDE"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "i"}], 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"n", "=", "0"}], "\[Infinity]"], 
        RowBox[{
         FractionBox[
          RowBox[{"n", "+", "1"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "!"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["P", 
             SubscriptBox["\[Mu]", "1"]], "..."}], 
           SubscriptBox["P", 
            SubscriptBox["\[Mu]", "n"]], 
           SubscriptBox["F", 
            RowBox[{
             SubscriptBox["\[Nu]", "i"], 
             SubscriptBox["\[Nu]", "j"]}]]}], ")"}], 
         SubscriptBox["dq", 
          SubscriptBox["\[Mu]", "1"]]}]}]}], "..."}], 
     SubscriptBox["dq", 
      SubscriptBox["\[Mu]", "n"]]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["P", 
     SubscriptBox["\[Nu]", "1"], "CDE"], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["q", 
       SubscriptBox["\[Nu]", "1"]]}], "+", 
     RowBox[{
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "2"]}], "CDE"], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SuperscriptBox["X", "CDE"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "1"]], " ", 
         SubsuperscriptBox["G", 
          RowBox[{
           SubscriptBox["\[Nu]", "1"], 
           SubscriptBox["\[Nu]", "2"]}], "CDE"]}], " ", "+", " ", 
        RowBox[{
         SubsuperscriptBox["G", 
          RowBox[{
           SubscriptBox["\[Nu]", "1"], 
           SubscriptBox["\[Nu]", "2"]}], "CDE"], " ", 
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "1"]]}]}], ")"}], 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]]}], " ", "-", " ", 
     RowBox[{
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "2"]}], "CDE"], " ", 
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "1"], 
        SubscriptBox["\[Nu]", "3"]}], "CDE"], " ", 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "2"]], " ", 
      SubscriptBox["dq", 
       SubscriptBox["\[Nu]", "3"]]}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["q", "2"], "-", 
       SubsuperscriptBox["m", "i", "2"], "-", 
       SuperscriptBox["X", "CDE"]}]], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], "+", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]", "i"], 
          SuperscriptBox["X", "CDE"], 
          SubscriptBox["\[CapitalDelta]", "i"]}], "+", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]", "i"], 
          SuperscriptBox["X", "CDE"], 
          SubscriptBox["\[CapitalDelta]", "i"], 
          SuperscriptBox["X", "CDE"], 
          SubscriptBox["\[CapitalDelta]", "i"]}], "+"}], "..."}], "   ", 
       "with", " ", 
       SubscriptBox["\[CapitalDelta]", "i"]}], "=", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["q", "2"], "-", 
        SubsuperscriptBox["m", "i", "2"]}]]}]}]}], ";"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.816539043434065*^9, 3.8165390651870956`*^9}, {
  3.816540128865595*^9, 3.8165401299455967`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"483d8fe1-3e39-4531-b026-2288d7a6688e"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "i", "CDE"], TraditionalForm]],ExpressionUUID->
  "24ade489-02e1-44bc-bb20-91b69a63b3e2"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["G", "\[Mu]\[Nu]", "CDE"], TraditionalForm]],
  ExpressionUUID->"f0bc2903-1aae-49d6-b0f4-23e24dc5da3b"]
}], "Subsubsection",
 CellChangeTimes->{{3.816539383520544*^9, 
  3.816539440861625*^9}},ExpressionUUID->"825ab971-4124-493c-8a02-\
7d4ef5cb875e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "ConvertDummy", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "UCDEDim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "GCDEDim", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165393844405456`*^9, 3.816539384650546*^9}, {
  3.8165400524314876`*^9, 3.8165400534814887`*^9}, {3.8165514820387506`*^9, 
  3.816551489807564*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"3d2d334f-9cce-445b-b7ac-0ab6d941d43f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Convert", " ", "dummy", " ", "indices", " ", "in", " ", "a", " ", "list", 
    " ", "into", " ", 
    SubscriptBox["\[Mu]", "i"], " ", "indices"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ConvertDummy", "[", 
      RowBox[{"list_", ",", "n\[Mu]_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "indicesOpen", ",", "indicesDummy", ",", "mylist"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"list", ",", 
             RowBox[{
              SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indicesOpen", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"indices", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], "\[Equal]", "1"}], ")"}],
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"indicesOpen", ",", 
             SubscriptBox["\[Mu]", "_"]}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ConvertDummy called with list containing \!\(\*SubscriptBox[\
\(\[Mu]\), \(i\)]\) open indices: list=\>\"", ",", "list"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"indicesDummy", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"indices", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{"indices", ",", "#"}], "]"}], ">", "1"}], ")"}], 
             "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"list", "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "\[Rule]", 
               SubscriptBox["\[Mu]", 
                RowBox[{"n\[Mu]", "+", "#2"}]]}], ")"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"indicesDummy", ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "indicesDummy", "]"}], "]"}]}], "}"}]}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mylist", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Poly", " ", 
      SubsuperscriptBox["U", "i", "CDE"]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"n", "=", "0"}], "\[Infinity]"], 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "!"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["P", 
             SubscriptBox["\[Mu]", "1"]], "..."}], 
           SubscriptBox["P", 
            SubscriptBox["\[Mu]", "n"]], 
           SubscriptBox["U", "i"]}], ")"}], 
         SubscriptBox["dq", 
          SubscriptBox["\[Mu]", "1"]]}]}], "..."}], 
      SubscriptBox["dq", 
       SubscriptBox["\[Mu]", "n"]], " ", "at", " ", "a", " ", "given", " ", 
      "operator", " ", "dimension"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UCDEDim", "[", 
      RowBox[{"dim_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Udim", "\[Rule]", "1"}], ",", 
          RowBox[{"Uoper", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Uexpr", ",", "n", ",", "coeff", ",", "UArray", ",", "qSec", ",", 
         "OperArray", ",", "ndummyArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Uexpr", "=", 
         RowBox[{"OptionValue", "[", "Uoper", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Uexpr", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Uexpr", "=", "U"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "[", "Uexpr", "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"dim", "\[Equal]", "0"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", "Uexpr", "}"}], "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}], "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"dim", "-", 
          RowBox[{"OptionValue", "[", "Udim", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "n", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"n", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         FractionBox["1", 
          RowBox[{"n", "!"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "coeff", "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"dq", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "n", "]"}]}]}], "]"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Times", "\[Rule]", "List"}], ",", 
                RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
               "}"}]}], "}"}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"Uexpr", "/.", 
             RowBox[{"Plus", "\[Rule]", "List"}]}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"OperArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"P", ",", 
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", "n", "]"}]}], ",", 
              RowBox[{"ConvertDummy", "[", 
               RowBox[{"#", ",", "n"}], "]"}]}], "]"}], "}"}], "&"}], "/@", 
          "UArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndummyArray", "=", 
         RowBox[{"n", "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"Tally", "[", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
                  RowBox[{"_", "?", "NumericQ"}]}], "]"}], "]"}], ",", 
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ">", "1"}], "&"}], ")"}]}]}], 
              "]"}], "&"}], "/@", "UArray"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"qSec", ",", "#1", ",", 
              RowBox[{"{", 
               RowBox[{"dim", ",", "#2"}], "}"}]}], "}"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"OperArray", ",", "ndummyArray"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Poly", " ", 
      SubsuperscriptBox["G", 
       RowBox[{
        SubscriptBox["\[Nu]", "i"], 
        SubscriptBox["\[Nu]", "j"]}], "CDE"]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "i"}], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"n", "=", "0"}], "\[Infinity]"], 
         RowBox[{
          FractionBox[
           RowBox[{"n", "+", "1"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "2"}], ")"}], "!"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", 
              SubscriptBox["\[Mu]", "1"]], "..."}], 
            SubscriptBox["P", 
             SubscriptBox["\[Mu]", "n"]], 
            SubscriptBox["F", 
             RowBox[{
              SubscriptBox["\[Nu]", "i"], 
              SubscriptBox["\[Nu]", "j"]}]]}], ")"}], 
          SubscriptBox["dq", 
           SubscriptBox["\[Mu]", "1"]]}]}]}], "..."}], 
      SubscriptBox["dq", 
       SubscriptBox["\[Mu]", "n"]], " ", "at", " ", "a", " ", "given", " ", 
      "operator", " ", "dimension"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GCDEDim", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Nu]i_", ",", "\[Nu]j_"}], "}"}], ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", "coeff", ",", "expr", ",", "qSec", ",", "Oper", ",", 
         "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Nu]i", ",", "\[Nu]j"}], "}"}], ",", 
            SubscriptBox["\[Mu]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<GCDEDim[] called with invalid input {\[Nu]i, \[Nu]j}=\>\"", 
             ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]i", ",", "\[Nu]j"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\) is reserved for dummy \
indices and cannot be used as open indices for GCDEDim[].\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Nu]i", "===", "\[Nu]j"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"dim", "-", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "n", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"n", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], 
          FractionBox[
           RowBox[{"n", "+", "1"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "2"}], ")"}], "!"}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "coeff", "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"dq", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "n", "]"}]}]}], "]"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Oper", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"P", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "n", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Subscript", "[", 
              RowBox[{"F", ",", "\[Nu]i", ",", "\[Nu]j"}], "]"}], "}"}]}], 
           "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"qSec", ",", "Oper", ",", 
            RowBox[{"{", 
             RowBox[{"dim", ",", "n"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165393854705467`*^9, 3.8165393884005513`*^9}, {
   3.816540063254503*^9, 3.816540064114504*^9}, {3.816544861020213*^9, 
   3.8165448673382244`*^9}, {3.8165448977738776`*^9, 3.816544897976678*^9}, {
   3.8165451235842743`*^9, 3.8165451237558746`*^9}, 3.8165451601507387`*^9, {
   3.816545216544838*^9, 3.8165452852785587`*^9}, {3.8165506147084265`*^9, 
   3.816550629450453*^9}, {3.8165507726587043`*^9, 3.816551355085727*^9}, {
   3.8165513898113885`*^9, 3.8165514578431077`*^9}, {3.8165516319550133`*^9, 
   3.81655169259232*^9}, {3.8165517407028046`*^9, 3.816551818484541*^9}, {
   3.8165518960166774`*^9, 3.816551944751163*^9}, {3.8165519923468466`*^9, 
   3.8165520383201275`*^9}, {3.8165522119328327`*^9, 
   3.8165522587173147`*^9}, {3.816552289152968*^9, 3.8165523296350393`*^9}, {
   3.8165523766379213`*^9, 3.8165524769616976`*^9}, {3.8165526482187986`*^9, 
   3.816552648499599*^9}, {3.8165527228805294`*^9, 3.8165527536125836`*^9}, {
   3.8165528220031037`*^9, 3.8165528221591043`*^9}, {3.816552875589198*^9, 
   3.8165528758699985`*^9}, {3.81655291064246*^9, 3.8165529164768696`*^9}, {
   3.8165530965167847`*^9, 3.816553113006014*^9}, {3.8165609822577353`*^9, 
   3.8165609891217475`*^9}, {3.816611282499219*^9, 3.816611343938306*^9}, {
   3.8166123974817915`*^9, 3.8166124021817985`*^9}, {3.8166125171909604`*^9, 
   3.8166125173609605`*^9}, {3.8166125690190334`*^9, 
   3.8166125692190337`*^9}, {3.8166126928462076`*^9, 
   3.8166126967472134`*^9}, {3.816623623387085*^9, 3.816623628058092*^9}, {
   3.8166236648851433`*^9, 3.816623665025144*^9}, {3.8167032102713213`*^9, 
   3.8167032104123216`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"095a7f4f-9671-4fb7-887b-90a372910514"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["P", "\[Mu]", "CDE"], TraditionalForm]],ExpressionUUID->
  "587233a4-909b-4f11-b5a9-b477afaa26f7"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], TraditionalForm]],
  ExpressionUUID->"fd300391-18ed-41c7-bfe6-4c7cb3b403b2"]
}], "Subsubsection",
 CellChangeTimes->{{3.816539386980549*^9, 3.816539400862569*^9}, {
  3.816539448672636*^9, 3.816539462694656*^9}, {3.8166145194547806`*^9, 
  3.8166145248657885`*^9}},ExpressionUUID->"c49e1031-0840-4c04-84a1-\
62a17cef033b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PCDEDim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "XCDEDim", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]XStrDimPar", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]XStrnX", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]CDEDimGen", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Load\[CapitalDelta]CDEPolyCache", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[CapitalDelta]CDEDim", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165390773891125`*^9, 3.8165390775691133`*^9}, {
  3.8165400856885347`*^9, 3.816540086868536*^9}, {3.8166145092027664`*^9, 
  3.8166145119537706`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"80d7a754-5eb2-4ea5-9163-9c470b580b69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Poly", " ", 
     SubsuperscriptBox["P", 
      SubscriptBox["\[Nu]", "i"], "CDE"]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["q", 
        SubscriptBox["\[Nu]", "i"]]}], "+", 
      RowBox[{
       SubsuperscriptBox["G", 
        RowBox[{
         SubscriptBox["\[Nu]", "i"], "\[Rho]"}], "CDE"], 
       SubscriptBox["dq", "\[Rho]"]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["q", 
          SubscriptBox["\[Nu]", "i"]]}], "-", 
        RowBox[{"i", 
         RowBox[{
          SubsuperscriptBox["\[Sum]", 
           RowBox[{"n", "=", "0"}], "\[Infinity]"], 
          RowBox[{
           FractionBox[
            RowBox[{"n", "+", "1"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "2"}], ")"}], "!"}]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["P", 
               SubscriptBox["\[Mu]", "1"]], "..."}], 
             SubscriptBox["P", 
              SubscriptBox["\[Mu]", "n"]], 
             SubscriptBox["F", 
              RowBox[{
               SubscriptBox["\[Nu]", "i"], 
               SubscriptBox["\[Mu]", 
                RowBox[{"n", "+", "1"}]]}]]}], ")"}], 
           SubscriptBox["dq", 
            SubscriptBox["\[Mu]", "1"]]}]}]}]}], "..."}], 
      SubscriptBox["dq", 
       SubscriptBox["\[Mu]", "n"]], 
      SubscriptBox["dq", 
       SubscriptBox["\[Mu]", 
        RowBox[{"n", "+", "1"}]]], " ", "at", " ", "a", " ", "given", " ", 
      "operator", " ", "dimension"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PCDEDim", "[", 
      RowBox[{"\[Nu]i_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "coeff", ",", "qSec", ",", "Oper", ",", "mypoly"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"\[Nu]i", ",", 
            SubscriptBox["\[Mu]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<PCDEDim[] called with invalid input \[Nu]i=\>\"", ",", 
             "\[Nu]i"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[Mu]\), \(i\)]\) is reserved for dummy \
indices and cannot be used as open indices for PCDEDim[].\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dim", "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 SubscriptBox["q", "\[Nu]i"]}], "}"}], "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}], "]"}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"dim", "-", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "n", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"n", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], 
          FractionBox[
           RowBox[{"n", "+", "1"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "2"}], ")"}], "!"}]]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qSec", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "coeff", "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"dq", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"n", "+", "1"}], "]"}]}]}], "]"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Oper", "=", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"P", ",", 
                RowBox[{"Subscript", "[", 
                 RowBox[{"\[Mu]", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "n", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Subscript", "[", 
              RowBox[{"F", ",", "\[Nu]i", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{"\[Mu]", ",", 
                 RowBox[{"n", "+", "1"}]}], "]"}]}], "]"}], "}"}]}], "]"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"qSec", ",", "Oper", ",", 
            RowBox[{"{", 
             RowBox[{"dim", ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Poly", " ", 
      SuperscriptBox["X", "CDE"]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["q", 
           SubscriptBox["\[Nu]", "1"]], 
          SubsuperscriptBox["G", 
           RowBox[{
            SubscriptBox["\[Nu]", "1"], 
            SubscriptBox["\[Nu]", "2"]}], "CDE"]}], "+", 
         RowBox[{
          SubsuperscriptBox["G", 
           RowBox[{
            SubscriptBox["\[Nu]", "1"], 
            SubscriptBox["\[Nu]", "2"]}], "CDE"], 
          SubscriptBox["q", 
           SubscriptBox["\[Nu]", "1"]]}]}], ")"}], 
       SubscriptBox["dq", 
        SubscriptBox["\[Nu]", "2"]]}], "-", 
      RowBox[{
       SubsuperscriptBox["G", 
        RowBox[{
         SubscriptBox["\[Nu]", "1"], 
         SubscriptBox["\[Nu]", "2"]}], "CDE"], 
       SubsuperscriptBox["G", 
        RowBox[{
         SubscriptBox["\[Nu]", "1"], 
         SubscriptBox["\[Nu]", "3"]}], "CDE"], 
       SubscriptBox["dq", 
        SubscriptBox["\[Nu]", "2"]], 
       SubscriptBox["dq", 
        SubscriptBox["\[Nu]", "3"]], " ", "at", " ", "a", " ", "given", " ", 
       "operator", " ", "dimension"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"XCDEDim", "[", "dim_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "poly1", ",", "poly2", ",", "poly3", ",", "polyArray", ",", 
         "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", "2"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"the", " ", "firt", " ", "two", " ", "terms", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["q", 
              SubscriptBox["\[Nu]", "1"]], 
             SubsuperscriptBox["G", 
              RowBox[{
               SubscriptBox["\[Nu]", "1"], 
               SubscriptBox["\[Nu]", "2"]}], "CDE"]}], "+", 
            RowBox[{
             SubsuperscriptBox["G", 
              RowBox[{
               SubscriptBox["\[Nu]", "1"], 
               SubscriptBox["\[Nu]", "2"]}], "CDE"], 
             SubscriptBox["q", 
              SubscriptBox["\[Nu]", "1"]]}]}], ")"}], 
          SubscriptBox["dq", 
           SubscriptBox["\[Nu]", "2"]]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"poly1", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["q", 
               SubscriptBox["\[Nu]", "1"]], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poly2", "=", 
         RowBox[{"GCDEDim", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Nu]", "1"], ",", 
             SubscriptBox["\[Nu]", "2"]}], "}"}], ",", "dim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poly3", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["dq", 
               SubscriptBox["\[Nu]", "2"]], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"MultiplyPolys", "[", 
            RowBox[{"{", 
             RowBox[{"poly1", ",", "poly2", ",", "poly3"}], "}"}], "]"}], ",", 
           RowBox[{"MultiplyPolys", "[", 
            RowBox[{"{", 
             RowBox[{"poly2", ",", "poly1", ",", "poly3"}], "}"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"CollectPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"the", " ", "last", " ", "term"}], " ", "-", 
          RowBox[{
           SubsuperscriptBox["G", 
            RowBox[{
             SubscriptBox["\[Nu]", "1"], 
             SubscriptBox["\[Nu]", "2"]}], "CDE"], 
           SubsuperscriptBox["G", 
            RowBox[{
             SubscriptBox["\[Nu]", "1"], 
             SubscriptBox["\[Nu]", "3"]}], "CDE"], 
           SubscriptBox["dq", 
            SubscriptBox["\[Nu]", "2"]], 
           SubscriptBox["dq", 
            SubscriptBox["\[Nu]", "3"]]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"poly1", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MultiplyPolys", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GCDEDim", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["\[Nu]", "1"], ",", 
                    SubscriptBox["\[Nu]", "2"]}], "}"}], ",", "#"}], "]"}], 
                ",", 
                RowBox[{"GCDEDim", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["\[Nu]", "1"], ",", 
                    SubscriptBox["\[Nu]", "3"]}], "}"}], ",", 
                  RowBox[{"dim", "-", "#"}]}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", 
              RowBox[{"dim", "-", "2"}]}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poly1", "=", 
         RowBox[{"CollectPoly", "[", "poly1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poly2", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               SubscriptBox["dq", 
                SubscriptBox["\[Nu]", "2"]], ",", 
               SubscriptBox["dq", 
                SubscriptBox["\[Nu]", "3"]]}], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poly3", "=", 
         RowBox[{"MultiplyPolys", "[", 
          RowBox[{"{", 
           RowBox[{"poly1", ",", "poly2"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"sum", " ", "the", " ", "above", " ", "terms"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"mypoly", ",", "poly3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Poly", " ", 
       SubscriptBox["\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"]}], "..."}], 
     SubscriptBox["X\[CapitalDelta]", "i"], " ", "for", " ", "a", " ", 
     "given", " ", "dimpar", " ", "of", " ", "X"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]XStrDimPar", "[", 
      RowBox[{"i_", ",", "dimpar_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polyDelta", ",", "polyArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polyDelta", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              SubscriptBox["\[CapitalDelta]", "i"], "}"}], "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"MultiplyPolys", "[", 
            RowBox[{"{", 
             RowBox[{"polyDelta", ",", 
              RowBox[{"XCDEDim", "[", "#", "]"}]}], "}"}], "]"}], "&"}], "/@",
           "dimpar"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MultiplyPolys", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"polyArray", ",", 
            RowBox[{"{", "polyDelta", "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Poly", " ", 
       SubscriptBox["\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"], 
       SubscriptBox["X\[CapitalDelta]", "i"]}], "..."}], 
     SubscriptBox["X\[CapitalDelta]", "i"], " ", "with", " ", "nX", " ", "of",
      " ", "X", " ", "at", " ", "a", " ", "given", " ", "operator", " ", 
     "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]XStrnX", "[", 
      RowBox[{"i_", ",", "nX_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dimparArray", ",", "polyArray", ",", "mypoly"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", 
             RowBox[{"2", "nX"}]}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dimparArray", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Permutations", "/@", 
             RowBox[{"IntegerPartitions", "[", 
              RowBox[{
               RowBox[{"dim", "-", "nX"}], ",", 
               RowBox[{"{", "nX", "}"}]}], "]"}]}], ",", "1"}], "]"}], "+", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalDelta]XStrDimPar", "[", 
              RowBox[{"i", ",", "#"}], "]"}], "&"}], "/@", "dimparArray"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"CollectPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Poly", " ", 
      SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "i"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], 
         SuperscriptBox["X", "CDE"], 
         SubscriptBox["\[CapitalDelta]", "i"]}], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], 
         SuperscriptBox["X", "CDE"], 
         SubscriptBox["\[CapitalDelta]", "i"], 
         SuperscriptBox["X", "CDE"], 
         SubscriptBox["\[CapitalDelta]", "i"]}], "+"}], "..."}], " ", "at", 
      " ", "a", " ", "given", " ", "operator", " ", "dimension"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]CDEDimGen", "[", 
      RowBox[{"i_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mypoly", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalDelta]XStrnX", "[", 
              RowBox[{"i", ",", "#", ",", "dim"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Floor", "[", 
               RowBox[{"dim", "/", "2"}], "]"}]}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"CollectPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Load", " ", "the", " ", "quantity", " ", "\[CapitalDelta]CDEPolyCache", 
      " ", "that", " ", "stores", " ", "the", " ", "pre"}], "-", 
     RowBox[{
     "evaluated", " ", "\[CapitalDelta]CDE", " ", "polys", " ", "for", " ", 
      RowBox[{"dim", " ", "[", 
       RowBox[{"0", ",", " ", "10"}], "]"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Load\[CapitalDelta]CDEPolyCache", "[", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]CDEPolyCache", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]CDEDimGen", "[", 
            RowBox[{"1", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "10"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Poly", " ", 
     SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], " ", "at", " ", "a", 
     " ", "given", " ", "operator", " ", "dimension"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]CDEDim", "[", 
      RowBox[{"i_", ",", "dim_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "dim", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", "<", "0"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"ValueQ", "[", "\[CapitalDelta]CDEPolyCache", "]"}]}], 
            ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"dim", ">", "10"}], ")"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"\[CapitalDelta]CDEDimGen", "[", 
            RowBox[{"i", ",", "dim"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"\[CapitalDelta]CDEPolyCache", "\[LeftDoubleBracket]", 
           RowBox[{"dim", "+", "1"}], "\[RightDoubleBracket]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "1"], "\[Rule]", 
            SubscriptBox["\[CapitalDelta]", "i"]}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165389444099255`*^9, 3.816538944579926*^9}, {
   3.8165400985105524`*^9, 3.8165400991905537`*^9}, {3.8165532149365926`*^9, 
   3.816553228368216*^9}, {3.8165642251226306`*^9, 3.816564375180494*^9}, {
   3.816564407971751*^9, 3.8165644354746*^9}, {3.816606593255322*^9, 
   3.8166066137803507`*^9}, {3.816611489610511*^9, 3.816611532566571*^9}, {
   3.8166116240017*^9, 3.8166116377137194`*^9}, {3.8166116777487755`*^9, 
   3.8166117240068407`*^9}, {3.8166117634218965`*^9, 
   3.8166118074109583`*^9}, {3.816611842727008*^9, 3.816611861710035*^9}, 
   3.816611908828101*^9, {3.816612015663254*^9, 3.8166120416372905`*^9}, {
   3.816612092615362*^9, 3.816612301895657*^9}, {3.8166124798439074`*^9, 
   3.8166124799839077`*^9}, {3.8166126654331694`*^9, 3.8166127174212427`*^9}, 
   3.8166127685183144`*^9, {3.816612806224367*^9, 3.816612821427389*^9}, {
   3.8166128594534426`*^9, 3.8166128601734433`*^9}, {3.816614499911753*^9, 
   3.81661450450276*^9}, {3.8166145533698287`*^9, 3.8166145838548717`*^9}, {
   3.816614616919918*^9, 3.816614619709922*^9}, {3.8166209001598654`*^9, 
   3.8166209199928937`*^9}, {3.8166209688609624`*^9, 
   3.8166209694809637`*^9}, {3.8166220480978637`*^9, 3.816622093684928*^9}, {
   3.81662249278649*^9, 3.816622559598584*^9}, {3.81662262627868*^9, 
   3.81662262645868*^9}, {3.816623015661228*^9, 3.816623023023239*^9}, {
   3.8166236764281597`*^9, 3.8166237070932035`*^9}, {3.816703218993334*^9, 
   3.8167032239343405`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"2642cd05-fb5f-4274-ba31-ec0ef889fa7f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Supertrace Manipulations", "Subsection",
 CellChangeTimes->{{3.8165389452099266`*^9, 
  3.816538960241948*^9}},ExpressionUUID->"3d3a826c-da45-4359-805e-\
2cc799e510d0"],

Cell[CellGroupData[{

Cell["Descriptions", "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8165390294120455`*^9, 
  3.8165390700281024`*^9}},ExpressionUUID->"ba516539-4fbf-4d01-9dbd-\
75740067ef7c"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "STrEAM", " ", "evaluates", " ", "functional", " ", "supertraces", " ", 
       "of", " ", "the", " ", "form"}], "\[IndentingNewLine]", "  ", "-", 
      RowBox[{"iSTr", "[", "f", "]"}]}], 
     SubscriptBox["|", "hard"]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "where", " ", "f", " ", "a", " ", "product", " ", "sequence", " ", "of", 
     " ", 
     SubscriptBox["P", "\[Mu]"]}]}], ",", " ", 
   SubscriptBox["U", "k"], ",", " ", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "i"], " ", "and", " ", 
    SubscriptBox["\[CapitalLambda]", "i"]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "consisting", " ", "of", " ", "an", " ", "arbitrary", " ", "number", " ",
       "of", " ", "\"\<propagator blocks\>\"", "\[IndentingNewLine]", "f"}], 
     "=", 
     RowBox[{"[", " ", 
      RowBox[{
       RowBox[{"...", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["P", 
            SubscriptBox["\[Mu]", "1"], "CDE"], "..."}], 
          SubsuperscriptBox["P", 
           SubscriptBox["\[Mu]", "n"], "CDE"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], " ", "or", " ", 
          SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["P", 
            SubscriptBox["\[Nu]", "1"], "CDE"], "..."}], 
          SubsuperscriptBox["P", 
           SubscriptBox["\[Nu]", "m"], "CDE"]}], ")"}], 
        SubsuperscriptBox["U", "k", "CDE"]}], " ", "..."}], " ", "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
    "where", " ", "the", " ", "propagator", " ", "can", " ", "be", " ", 
     "either", " ", "bosonic", " ", 
     SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}]}], ",", " ", 
   RowBox[{
    RowBox[{"or", " ", "fermionic", " ", 
     SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], ";", " ", 
    RowBox[{"the", " ", "last", " ", 
     SubsuperscriptBox["U", "k", "CDE"], " ", "factor", " ", "is", " ", 
     "allowed", " ", "to", " ", "be", " ", "absent"}], ";", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(|\), \(hard\)]\)\>\"", " ", "denotes", " ", 
     "the", " ", "hard", " ", "region", " ", "contributions"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Fermionic", " ", "propagators", " ", "are", " ", "addressed", " ", "by",
       "\[IndentingNewLine]", " ", 
      SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Pslash", "-", 
        SubscriptBox["m", "i"]}]], "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["P", "2"], "-", 
          SubsuperscriptBox["m", "i", "2"], "-", "\[CapitalSigma]"}]], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "i"], "+", 
          RowBox[{
           SubscriptBox["P", "\[Rho]"], 
           SubscriptBox["\[Gamma]", "\[Rho]"]}]}], ")"}]}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], "+", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
            SuperscriptBox["\[CapitalSigma]", "CDE"], 
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
            SuperscriptBox["\[CapitalSigma]", "CDE"], 
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
            SuperscriptBox["\[CapitalSigma]", "CDE"], 
            SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "+"}], 
          "..."}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "i"], "+", 
          RowBox[{
           SubscriptBox["P", "\[Rho]"], 
           SubscriptBox["\[Gamma]", "\[Rho]"]}]}], ")"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"with", "\[IndentingNewLine]", "\[CapitalSigma]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       SuperscriptBox["\[Sigma]", "\[Alpha]\[Beta]"], 
       SubscriptBox["F", "\[Alpha]\[Beta]"]}], "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "\[Sigma]F"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "We", " ", "call", " ", "the", " ", "supertrace", " ", "\"\<bosonic\>\"", 
     " ", "when", " ", "it", " ", "contains", " ", "no", " ", "fermionic", 
     " ", "propagators"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
    "Mandatory", " ", "input", " ", "parameters", " ", "for", " ", "the", " ",
      "main", " ", "function", " ", 
     RowBox[{"SuperTrace", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "dim", "          ", "Desired", " ", "operator", " ", "dimension", " ", 
     "in", " ", "the", " ", "result"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "flist", "        ", "Functional", " ", "operator", " ", "f", " ", "to", 
     " ", "trace", " ", "over"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Options", " ", "for", " ", "the", " ", "main", " ", "function", " ", 
     RowBox[{"SuperTrace", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Udimlist", "     ", "default", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "...", ",", "1"}], "}"}], "    ", "Minimum", " ", 
     "operator", " ", "dimensions", " ", "of", " ", 
     RowBox[{"{", 
      SubscriptBox["U", "k"], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Heavylist", "    ", "default", "    ", 
     RowBox[{"{", "1", "}"}], "       ", "Heavy", " ", "mass", " ", 
     "labels"}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "SoftOrd", "      ", "default", "     ", "0", "        ", "Additional", 
     " ", "power", 
     RowBox[{"(", "s", ")"}], " ", "of", " ", 
     RowBox[{
      SubscriptBox["m", "light"], "/", 
      SubscriptBox["m", "heavy"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "No\[Gamma]inU", "       ", "default", "   ", "False", "      ", "No", 
     " ", "Dirac", " ", "matrices", " ", 
     SubscriptBox["\[Gamma]", "\[Mu]"], " ", "in", " ", 
     RowBox[{"{", 
      SubscriptBox["U", "k"], "}"}], " ", "factors"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "display", "      ", "default", "   ", "False", "      ", "Print", " ", 
     "result"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "Alternatively"}], ",", " ", 
   RowBox[{
   "one", " ", "can", " ", "use", " ", "the", " ", "function", " ", 
    "SuperTraceFromExpr"}], ",", " ", 
   RowBox[{
    RowBox[{
    "which", " ", "takes", " ", "an", " ", "expression", " ", "fexpr", " ", 
     "as", " ", "input", " ", "for", " ", "the", " ", "functional", " ", 
     "operator", " ", "f"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "The", " ", "set", " ", "of", " ", "underlying", " ", "supertrace", " ", 
     "\"\<parameters\>\"", " ", "for", " ", "the", " ", "functional", " ", 
     "operator", " ", "f", " ", 
     RowBox[{"(", 
      RowBox[{
      "only", " ", "used", " ", "in", " ", "private", " ", "context"}], 
      ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "masslabels", "   ", "List", " ", "of", " ", "propagator", " ", 
     "masses"}]}], ",", " ", 
   RowBox[{
    RowBox[{"namely", " ", "the", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["i", "1"], ",", 
       SubscriptBox["i", "2"], ",", "..."}], "}"}], " ", "in", " ", "f"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "typelist", "     ", "List", " ", "of", " ", "propagator", " ", 
      "types"}], " ", "+", 
     RowBox[{"1", " ", "for", " ", 
      SubscriptBox["\[CapitalDelta]", "i"]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], " ", "or", " ", 
     SubscriptBox["\[CapitalLambda]", "i"]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "coeff", "        ", "Coefficient", " ", "multiplying", " ", "the", " ", 
     "supertrace"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Ulist", "        ", "List", " ", "of", " ", 
     SubscriptBox["U", "k"], " ", "factors"}]}], ",", " ", 
   RowBox[{
    RowBox[{"with", " ", "default", " ", "value", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["U", "1"], ",", 
       SubscriptBox["U", "2"], ",", 
       SubscriptBox["U", "3"], ",", "..."}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Plocations", "   ", "List", " ", "of", " ", "locations", " ", "of", " ", 
     SubsuperscriptBox["P", 
      SubscriptBox["\[Nu]", "i"], "CDE"]}]}], ",", " ", 
   RowBox[{
    RowBox[{"with", " ", "-", 
     RowBox[{"n", 
      RowBox[{"(", 
       RowBox[{"+", "n"}], ")"}], " ", "indicating", " ", "before", 
      RowBox[{"(", "after", ")"}], " ", "the", " ", "nth", " ", 
      "propagator"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Pindices", "     ", "List", " ", "of", " ", "Lorentz", " ", "indices", 
     " ", 
     SubscriptBox["\[Nu]", "i"], " ", "in", " ", "the", " ", "open", " ", 
     "covariant", " ", "derivatives", " ", 
     SubsuperscriptBox["P", 
      SubscriptBox["\[Nu]", "i"], "CDE"]}], ";", "\[IndentingNewLine]", 
    RowBox[{
    "Udimlist", "     ", "List", " ", "of", " ", "minimum", " ", "operator", 
     " ", "dimensions", " ", "of", " ", 
     RowBox[{"{", 
      SubscriptBox["U", "k"], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.816539045614068*^9, 3.8165390700281024`*^9}, {
  3.8165401141835747`*^9, 3.816540115043576*^9}, {3.8167034841967072`*^9, 
  3.816703496588725*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"3879f6c3-cea2-44b1-9f48-5091cfe347c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bosonic Supertrace CDE Poly Generation", "Subsubsection",
 CellChangeTimes->{{3.8165390813501186`*^9, 3.816539081570119*^9}, {
  3.8165394760176744`*^9, 
  3.8165394992437077`*^9}},ExpressionUUID->"d4011335-d331-419d-bff3-\
b72825bcf1a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "STrPrint", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "STrParameters", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "STrBflists", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "STrflistUFrame", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "DimparsBSTr", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "BSTrPolyDimPar", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "BSTrPolyGen", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165394689366646`*^9, 3.816539469116665*^9}, {
   3.8165401530196295`*^9, 3.8165401540296307`*^9}, 3.816624833720796*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"7bfbb863-c9c9-4154-8a19-27f91000ab89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "the", " ", "input", " ", "supertrace"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"STrPrint", "[", "flist_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "mylist", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mylist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Times", "\[Rule]", "List"}], ",", 
                  RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
                 "}"}]}], "]"}], "}"}], "]"}], "&"}], "/@", "flist"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{"Select", "[", 
               RowBox[{"mylist", ",", "NumericQ"}], "]"}], ")"}]}], "}"}], 
           ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"mylist", ",", 
             RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "mylist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===",
            "1"}], ",", 
          RowBox[{"mylist", "=", 
           RowBox[{"mylist", "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "mylist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"mylist", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"mylist", ",", 
             RowBox[{"1", "\[Rule]", "\"\<-\>\""}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"mylist", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "i_"], "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "0"}], ",", 
               FractionBox["1", 
                SuperscriptBox["P", "2"]], ",", 
               FractionBox["1", 
                RowBox[{
                 SuperscriptBox["P", "2"], "-", 
                 SubsuperscriptBox["m", "i", "2"]}]]}], "]"}]}], ",", 
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "j_"], "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "\[Equal]", "0"}], ",", 
               "\"\<\!\(\*FractionBox[\(1\), \(\(Pslash\)\(\\\ \)\)]\)\>\"", 
               ",", 
               FractionBox["1", 
                RowBox[{"Pslash", " ", "-", " ", 
                 SubscriptBox["m", "j"]}]]}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<-iSTr[\>\"", "}"}], ",", "mylist", ",", 
           RowBox[{
           "{", "\"\<]\!\(\*SubscriptBox[\(|\), \(hard\)]\)\>\"", "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Row", "[", "mylist", "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "set", " ", "of", " ", "underlying", " ", 
     "supertrace", " ", "\"\<parameters\>\"", " ", "for", " ", "flist"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STrParameters", "[", 
      RowBox[{"flist_", ",", "Udimlist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myflist", ",", "masslabels", ",", "mytypelist", ",", 
         "my\[CapitalDelta]split", ",", "mycoeff", ",", "PUframeArray", ",", 
         "nUArray", ",", "Ucoefflist", ",", "Uoperlist", ",", "myUlist", ",", 
         "myUdimlist", ",", "myP\[CapitalDelta]PUlist", ",", 
         "myP\[CapitalDelta]PUsplit", ",", "myPlocations", ",", "myPindices", 
         ",", "myParameters"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"canonicalize", " ", "flist", " ", "into", " ", "myflist"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myflist", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Times", "\[Rule]", "List"}], ",", 
                   RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
                  "}"}]}], "]"}], "}"}], "]"}], "&"}], "/@", "flist"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "myflist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "]"}]}], ",", 
          RowBox[{"myflist", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"myflist", ",", "1", ",", "1"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"masslabels", " ", "and", " ", "propagator", " ", "types"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"masslabels", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "i_"], "|", 
             SubscriptBox["\[CapitalLambda]", "i_"]}], "\[Rule]", "i"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mytypelist", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"myflist", ",", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "_"], "|", 
             SubscriptBox["\[CapitalLambda]", "_"]}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "_"], "\[Rule]", "1"}], ",", 
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "_"], "\[Rule]", 
             RowBox[{"-", "1"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"masslabels", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Invalid input f.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<f must be made of the propagator blocks f=[ ... \
(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(1\)], \(CDE\)]\)...\
\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(n\)], \(CDE\)]\))(\!\
\(\*SubsuperscriptBox[\(\[CapitalDelta]\), \(i\), \(CDE\)]\) or \
\!\(\*SubsuperscriptBox[\(\[CapitalLambda]\), \(i\), \
\(CDE\)]\))(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(1\)], \
\(CDE\)]\)...\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(m\)], \
\(CDE\)]\))\!\(\*SubsuperscriptBox[\(U\), \(k\), \(CDE\)]\) ... ].\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<No propagators detected: input flist=\>\"", ",", "flist"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"AllTrue", "[", 
              RowBox[{"masslabels", ",", "IntegerQ"}], "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Min", "[", "masslabels", "]"}], "<", "0"}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Invalid input f.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<mass labels must be non-negative integers: input flist=\>\"",
              ",", "flist"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"coeff", ",", " ", "Ulist", ",", " ", 
          RowBox[{"and", " ", "Udimlist"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SequenceCount", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{"myflist", ",", 
                RowBox[{
                 RowBox[{"_", "?", "NumericQ"}], "|", 
                 SubscriptBox["m", "_"], "|", 
                 SubscriptBox["\[Eta]", "__"], "|", 
                 SubscriptBox["\[Gamma]", "_"], "|", 
                 SubscriptBox["\[Epsilon]", "__"], "|", 
                 SubscriptBox["P", "_"]}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalDelta]", "_"], "|", 
                 SubscriptBox["\[CapitalLambda]", "_"]}], "\[Rule]", 
                "\[CapitalDelta]"}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalDelta]", ",", "\[CapitalDelta]"}], "}"}]}], 
            "]"}], ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Invalid input f.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<f must be made of the propagator blocks f=[ ... \
(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(1\)], \(CDE\)]\)...\
\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(n\)], \(CDE\)]\))(\!\
\(\*SubsuperscriptBox[\(\[CapitalDelta]\), \(i\), \(CDE\)]\) or \
\!\(\*SubsuperscriptBox[\(\[CapitalLambda]\), \(i\), \
\(CDE\)]\))(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(1\)], \
\(CDE\)]\)...\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(m\)], \
\(CDE\)]\))\!\(\*SubsuperscriptBox[\(U\), \(k\), \(CDE\)]\) ... ].\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Missing U factor between \[CapitalDelta]|\[CapitalLambda]: \
input flist=\>\"", ",", "flist"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"my\[CapitalDelta]split", "=", 
         RowBox[{"Split", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"#2", ",", 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "_"], "|", 
                SubscriptBox["\[CapitalLambda]", "_"]}]}], "]"}]}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
             "my\[CapitalDelta]split", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "_"], "|", 
              SubscriptBox["\[Eta]", "__"], "|", 
              SubscriptBox["\[Epsilon]", "__"], "|", 
              SubscriptBox["P", "_"]}]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Invalid input f.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<f must be made of the propagator blocks f=[ ... \
(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(1\)], \(CDE\)]\)...\
\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(n\)], \(CDE\)]\))(\!\
\(\*SubsuperscriptBox[\(\[CapitalDelta]\), \(i\), \(CDE\)]\) or \
\!\(\*SubsuperscriptBox[\(\[CapitalLambda]\), \(i\), \
\(CDE\)]\))(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(1\)], \
\(CDE\)]\)...\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(m\)], \
\(CDE\)]\))\!\(\*SubsuperscriptBox[\(U\), \(k\), \(CDE\)]\) ... ].\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<U factor found before the first propagator: input \
flist=\>\"", ",", "flist"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"mycoeff", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
            "my\[CapitalDelta]split", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            SubscriptBox["P", "_"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"my\[CapitalDelta]split", "=", 
         RowBox[{"my\[CapitalDelta]split", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PUframeArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "_"], "|", 
              SubscriptBox["\[Eta]", "__"], "|", 
              SubscriptBox["\[Gamma]", "_"], "|", 
              SubscriptBox["\[Epsilon]", "__"], "|", 
              SubscriptBox["\[CapitalDelta]", "_"], "|", 
              SubscriptBox["\[CapitalLambda]", "_"]}]}], "]"}], "&"}], "/@", 
          "my\[CapitalDelta]split"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nUArray", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Split", "[", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   SubscriptBox["P", "0"], "}"}], ",", "#"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"#1", ",", 
                    SubscriptBox["P", "_"]}], "]"}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"#2", ",", 
                    SubscriptBox["P", "_"]}], "]"}]}]}], ")"}]}], "&"}]}], 
               "]"}], "]"}], "&"}], "/@", "PUframeArray"}], ")"}], "-", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", "nUArray", "]"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Invalid input f.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<f must be made of the propagator blocks f=[ ... \
(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(1\)], \(CDE\)]\)...\
\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(n\)], \(CDE\)]\))(\!\
\(\*SubsuperscriptBox[\(\[CapitalDelta]\), \(i\), \(CDE\)]\) or \
\!\(\*SubsuperscriptBox[\(\[CapitalLambda]\), \(i\), \
\(CDE\)]\))(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(1\)], \
\(CDE\)]\)...\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(m\)], \
\(CDE\)]\))\!\(\*SubsuperscriptBox[\(U\), \(k\), \(CDE\)]\) ... ].\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<More than one U factors found between two adjacent \
propagators: input flist=\>\"", ",", "flist"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Ucoefflist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"_", "?", "NumericQ"}], "|", 
                SubscriptBox["m", "_"], "|", 
                SubscriptBox["\[Eta]", "__"], "|", 
                SubscriptBox["\[Epsilon]", "__"]}]}], "]"}]}], ")"}], "&"}], "/@",
           "my\[CapitalDelta]split"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Uoperlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "_"], "|", 
              SubscriptBox["\[Eta]", "__"], "|", 
              SubscriptBox["\[Epsilon]", "__"], "|", 
              SubscriptBox["\[CapitalDelta]", "_"], "|", 
              SubscriptBox["\[CapitalLambda]", "_"], "|", 
              SubscriptBox["P", "_"]}]}], "]"}], "&"}], "/@", 
          "my\[CapitalDelta]split"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Uoperlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
             RowBox[{"#", "/.", 
              RowBox[{"List", "\[Rule]", "NonCommutativeMultiply"}]}], ",", 
             RowBox[{"#", "/.", 
              RowBox[{"List", "\[Rule]", "Times"}]}]}], "]"}], "&"}], "/@", 
          "Uoperlist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myUlist", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"Ucoefflist", ",", "Uoperlist"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "Udimlist", "]"}], "\[NotEqual]", "0"}], 
            ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", "Udimlist", "]"}], "\[NotEqual]", 
             RowBox[{"Length", "[", "myUlist", "]"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", "\"\<Invalid input option Udimlist.\>\"", "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Length of Udimlist does not match number of U factors: \
Ulist=\>\"", ",", "myUlist", ",", "\"\<, Udimlist=\>\"", ",", "Udimlist"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"myUdimlist", "=", "Udimlist"}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"myUdimlist", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"myUdimlist", "=", 
           RowBox[{
            RowBox[{"1", "&"}], "/@", "myUlist"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Last", "[", "my\[CapitalDelta]split", "]"}], ",", 
             RowBox[{
              RowBox[{"_", "?", "NumericQ"}], "|", 
              SubscriptBox["m", "_"], "|", 
              SubscriptBox["\[Eta]", "__"], "|", 
              SubscriptBox["\[Gamma]", "_"], "|", 
              SubscriptBox["\[Epsilon]", "__"], "|", 
              SubscriptBox["\[CapitalDelta]", "_"], "|", 
              SubscriptBox["\[CapitalLambda]", "_"], "|", 
              SubscriptBox["P", "_"]}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", "Udimlist", "]"}], "\[NotEqual]", 
                "0"}], ")"}], "&&", 
              RowBox[{
               RowBox[{"Last", "[", "Udimlist", "]"}], "\[NotEqual]", "0"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", "\"\<Invalid input option Udimlist.\>\"", "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Nonzero last Udimlist for trivial last U factor: Ulist=\>\
\"", ",", "myUlist", ",", "\"\<, Udimlist=\>\"", ",", "Udimlist"}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"myUdimlist", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", "0"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Plocations", " ", "and", " ", "Pindices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"myP\[CapitalDelta]PUlist", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"myflist", ",", 
            RowBox[{
             RowBox[{"_", "?", "NumericQ"}], "|", 
             SubscriptBox["m", "_"], "|", 
             SubscriptBox["\[Eta]", "__"], "|", 
             SubscriptBox["\[Gamma]", "_"], "|", 
             SubscriptBox["\[Epsilon]", "__"]}]}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["P", "_"], "\[Rule]", "P"}], ",", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "_"], "|", 
              SubscriptBox["\[CapitalLambda]", "_"]}], "\[Rule]", 
             "\[CapitalDelta]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myP\[CapitalDelta]PUsplit", "=", 
         RowBox[{"Split", "[", 
          RowBox[{"myP\[CapitalDelta]PUlist", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"\[CapitalDelta]", "|", "P"}]}], "]"}], "||", 
              RowBox[{"!", 
               RowBox[{"MatchQ", "[", 
                RowBox[{"#2", ",", 
                 RowBox[{"\[CapitalDelta]", "|", "P"}]}], "]"}]}]}], ")"}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "myP\[CapitalDelta]PUsplit", "]"}], ">", 
           RowBox[{"Length", "[", "masslabels", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Invalid input f.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<f must be made of the propagator blocks f=[ ... \
(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(1\)], \(CDE\)]\)...\
\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Mu]\), \(n\)], \(CDE\)]\))(\!\
\(\*SubsuperscriptBox[\(\[CapitalDelta]\), \(i\), \(CDE\)]\) or \
\!\(\*SubsuperscriptBox[\(\[CapitalLambda]\), \(i\), \
\(CDE\)]\))(\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(1\)], \
\(CDE\)]\)...\!\(\*SubsuperscriptBox[\(P\), SubscriptBox[\(\[Nu]\), \(m\)], \
\(CDE\)]\))\!\(\*SubsuperscriptBox[\(U\), \(k\), \(CDE\)]\) ... ].\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(P\), \(\[Mu]\)]\) factors after the \
last U factor detected: input flist=\>\"", ",", "flist"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"myP\[CapitalDelta]PUsplit", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"P", "|", "\[CapitalDelta]"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"P", "\[Rule]", "0"}], ",", 
                RowBox[{"\[CapitalDelta]", "\[Rule]", "#2"}]}], "}"}]}], 
             ")"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"myP\[CapitalDelta]PUsplit", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "myP\[CapitalDelta]PUsplit", "]"}], 
              "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myPlocations", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Accumulate", "[", "#", "]"}], "-", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"Accumulate", "[", 
                  RowBox[{"Reverse", "[", "#", "]"}], "]"}], "]"}]}], ",", 
               "0"}], "]"}], "&"}], "/@", "myP\[CapitalDelta]PUsplit"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myPindices", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            SubscriptBox["P", "\[Nu]_"], "\[Rule]", "\[Nu]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "myPindices", "]"}], "\[NotEqual]", 
           RowBox[{"Length", "[", "myPlocations", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<Length mismatch between Plocations and Pindices:\>\"", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Plocation=\>\"", ",", "myPlocations", ",", 
             "\"\<, Pindices=\>\"", ",", "myPindices"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "put", " ", "all", " ", "the", " ", "inputs", " ", "together"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myParameters", "=", 
         RowBox[{"{", 
          RowBox[{
          "masslabels", ",", "mytypelist", ",", "mycoeff", ",", "myUlist", 
           ",", "myPlocations", ",", "myPindices", ",", "myUdimlist"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myParameters", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Get", " ", "the", " ", "set", " ", "of", " ", "bosonic", " ", "flists", 
      " ", "from", " ", "a", " ", "given", " ", "flist", " ", "by", " ", 
      SubsuperscriptBox["\[CapitalLambda]", "i", "CDE"]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], "+", 
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
          SuperscriptBox["\[CapitalSigma]", "CDE"], 
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
          SuperscriptBox["\[CapitalSigma]", "CDE"], 
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"], 
          SuperscriptBox["\[CapitalSigma]", "CDE"], 
          SubsuperscriptBox["\[CapitalDelta]", "i", "CDE"]}], "+"}], "..."}], 
       ")"}], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "i"], "+", 
        RowBox[{
         SubscriptBox["P", "\[Rho]"], 
         SubscriptBox["\[Gamma]", "\[Rho]"]}]}], ")"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STrBflists", "[", 
      RowBox[{"flist_", ",", "n\[CapitalSigma]cap_", ",", "n\[Nu]_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bflistTuples", ",", "\[Nu]shiftArray", ",", "bflistArray"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bflistTuples", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{"#", ",", 
                  SubscriptBox["\[CapitalLambda]", "__"]}], "]"}], ",", "#", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", "#", "}"}], "}"}]}], "]"}], "&"}], "/@", 
             "flist"}], ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[CapitalLambda]", "i_"], "\[RuleDelayed]", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Tuples", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"NestList", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ",", "\[Sigma]F", ",", 
                    SubscriptBox["\[CapitalDelta]", "i"]}], "}"}]}], "]"}], 
                    "&"}], ",", 
                   RowBox[{"{", 
                    SubscriptBox["\[CapitalDelta]", "i"], "}"}], ",", 
                   "n\[CapitalSigma]cap"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["m", "i"], ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["P", 
                    SubscriptBox["\[Mu]", "0"]], ",", "1", ",", 
                    SubscriptBox["\[Gamma]", 
                    SubscriptBox["\[Mu]", "0"]]}], "}"}]}], "}"}], ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["m", "0"]}], "]"}], "&"}], ")"}]}]}], 
                  "]"}]}], "}"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Nu]shiftArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{
              RowBox[{"Accumulate", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["\[Mu]", "0"], ",", "All"}], "]"}], "&"}], "/@",
                   "#"}], ")"}], "\[LeftDoubleBracket]", 
                RowBox[{";;", 
                 RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
              "2"}]}], "]"}], "&"}], "/@", "bflistTuples"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["\[Mu]", "0"], "\[Rule]", 
                   SubscriptBox["\[Nu]", 
                    RowBox[{"n\[Nu]", "+", "1", "+", "#2"}]]}], "}"}]}], 
                "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"bflistTuples", ",", "\[Nu]shiftArray"}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"bflistArray", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{"#", ",", "\[Sigma]F"}], "]"}], "\[LessEqual]", 
              "n\[CapitalSigma]cap"}], ")"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "bflistArray", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Obtain", " ", "the", " ", "UFrame", " ", "of", " ", "flist"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STrflistUFrame", "[", 
      RowBox[{
      "masslabels_", ",", "typelist_", ",", "coeff_", ",", "Plocations_", ",",
        "Pindices_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myUlist", ",", "\[CapitalDelta]lsit", ",", "\[CapitalDelta]Ulist", 
         ",", "poslist", ",", "Porders", ",", "myflist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myUlist", "=", 
         RowBox[{
          RowBox[{
           SubscriptBox["U", "#"], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "masslabels", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]lsit", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#2", ">", "0"}], ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"\[CapitalDelta]", ",", "#1"}], "]"}], ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"\[CapitalLambda]", ",", "#1"}], "]"}]}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"masslabels", ",", "typelist"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Ulist", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"\[CapitalDelta]lsit", ",", "myUlist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poslist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0"}], ",", 
              RowBox[{"2", "#"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "#"}], "-", "1"}]}], "]"}], "}"}], "&"}], 
          "/@", "Plocations"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myflist", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"\[CapitalDelta]Ulist", ",", "P", ",", "poslist"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Porders", "=", 
         RowBox[{"Accumulate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "===", "P"}], ",", "1", ",", "0"}], "]"}], "&"}], "/@",
            "myflist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myflist", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#1", "===", "P"}], ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"P", ",", 
                RowBox[{
                "Pindices", "\[LeftDoubleBracket]", "#2", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", "#1"}], "]"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"myflist", ",", "Porders"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"myflist", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "coeff", "}"}], ",", "myflist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "myflist", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Get", " ", "the", " ", "list", " ", "of", " ", "dimpars", " ", "of", " ",
      "a", " ", "given", " ", "operator", " ", "dimension", " ", "for", " ", 
     "a", " ", "bosonic", " ", "supertrace"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DimparsBSTr", "[", 
      RowBox[{
      "dim_", ",", "masslabels_", ",", "Plocations_", ",", "Udimlist_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]mindim", ",", "Umindim", ",", "mindimlist", ",", 
         "poslist", ",", "ULastdim", ",", "dimparshift", ",", "dimeff", ",", 
         "mydimparlist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]mindim", "=", 
         RowBox[{
          RowBox[{"0", "&"}], "/@", "masslabels"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Umindim", "=", "Udimlist"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindimlist", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{"\[CapitalDelta]mindim", ",", "Umindim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"poslist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0"}], ",", 
              RowBox[{"2", "#"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "#"}], "-", "1"}]}], "]"}], "}"}], "&"}], 
          "/@", "Plocations"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindimlist", "=", 
         RowBox[{"Insert", "[", 
          RowBox[{"mindimlist", ",", "0", ",", "poslist"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ULastdim", "=", 
         RowBox[{"Last", "[", "Udimlist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mindimlist", "=", 
         RowBox[{"mindimlist", "\[LeftDoubleBracket]", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dimparshift", "=", 
         RowBox[{"mindimlist", "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dimeff", "=", 
         RowBox[{"dim", "-", "ULastdim", "-", 
          RowBox[{"(", 
           RowBox[{"Plus", "@@", "dimparshift"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mydimparlist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Permutations", "/@", 
            RowBox[{"IntegerPartitions", "[", 
             RowBox[{"dimeff", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", "mindimlist", "]"}], "}"}]}], "]"}]}], 
           ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mydimparlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"#", "+", "dimparshift"}], ",", 
             RowBox[{"{", "ULastdim", "}"}]}], "]"}], "&"}], "/@", 
          "mydimparlist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "trimings", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"Plocations", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ",", 
          RowBox[{"mydimparlist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"mydimparlist", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "\[NotEqual]", "2"}], "&"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"Plocations", ",", 
             RowBox[{"Length", "[", "masslabels", "]"}]}], "]"}]}], ",", 
          RowBox[{"mydimparlist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"mydimparlist", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
               "2"}], "&"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mydimparlist", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generate", " ", "the", " ", "poly", " ", "of", " ", "a", " ", "bosonic", 
     " ", "supertrace", " ", "for", " ", "a", " ", "given", " ", "dimpar"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSTrPolyDimPar", "[", 
      RowBox[{
      "dimpar_", ",", "masslabels_", ",", "coeff_", ",", "Ulist_", ",", 
       "Plocations_", ",", "Pindices_", ",", "Udimlist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mytypelist", ",", "mylist", ",", "myexpr", ",", "polyArray", ",", 
         "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mytypelist", "=", 
         RowBox[{
          RowBox[{"1", "&"}], "/@", "masslabels"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"STrflistUFrame", "[", 
          RowBox[{
          "masslabels", ",", "mytypelist", ",", "1", ",", "Plocations", ",", 
           "Pindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mylist", "=", 
         RowBox[{"mylist", "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#1", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[CapitalDelta]", "i_"], "\[RuleDelayed]", 
                 RowBox[{"\[CapitalDelta]CDEDim", "[", 
                  RowBox[{"i", ",", "#2"}], "]"}]}], ",", 
                RowBox[{
                 SubscriptBox["U", "k_"], "\[RuleDelayed]", " ", 
                 RowBox[{"UCDEDim", "[", 
                  RowBox[{"#2", ",", 
                   RowBox[{"Udim", "\[Rule]", 
                    RowBox[{
                    "Udimlist", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{"Uoper", "\[Rule]", 
                    RowBox[{
                    "Ulist", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
                RowBox[{
                 SubscriptBox["P", "\[Nu]_"], "\[RuleDelayed]", 
                 RowBox[{"PCDEDim", "[", 
                  RowBox[{"\[Nu]", ",", "#2"}], "]"}]}]}], "}"}]}], ")"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"mylist", ",", "dimpar"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"MultiplyPolys", "[", "polyArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"FTrimPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"ScaleqSec", "[", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", "coeff"}], "]"}]}]}], "]"}], "&"}], "/@", "mypoly"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generate", " ", "the", " ", "poly", " ", "of", " ", "a", " ", "bosonic", 
     " ", "supertrace", " ", "up", " ", "to", " ", "a", " ", "given", " ", 
     "operator", " ", "dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSTrPolyGen", "[", 
      RowBox[{
      "dim_", ",", "masslabels_", ",", "coeff_", ",", "Ulist_", ",", 
       "Plocations_", ",", "Pindices_", ",", "Udimlist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mindim", ",", "mydimparArray", ",", "polyArray", ",", "myexpr", ",", 
         "mypoly"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mindim", "=", 
         RowBox[{"Plus", "@@", "Udimlist"}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mindim", "\[Equal]", "0"}], ",", 
          RowBox[{"mindim", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mydimparArray", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DimparsBSTr", "[", 
              RowBox[{
              "#", ",", "masslabels", ",", "Plocations", ",", "Udimlist"}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"mindim", ",", "dim"}], "]"}]}], ",", "1"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"polyArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"BSTrPolyDimPar", "[", 
            RowBox[{
            "#", ",", "masslabels", ",", "coeff", ",", "Ulist", ",", 
             "Plocations", ",", "Pindices", ",", "Udimlist"}], "]"}], "&"}], "/@",
           "mydimparArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", 
          RowBox[{"Join", "@@", "polyArray"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mypoly", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816539469796666*^9, 3.8165394700166664`*^9}, {
   3.816540165381647*^9, 3.8165401662816477`*^9}, {3.816560030604865*^9, 
   3.816560036720076*^9}, {3.8165600851737614`*^9, 3.8165600853297615`*^9}, {
   3.8165641946457777`*^9, 3.8165642018217897`*^9}, {3.816606582863307*^9, 
   3.8166065830433073`*^9}, {3.8166078014640284`*^9, 
   3.8166078138460455`*^9}, {3.816621906574664*^9, 3.8166219134466743`*^9}, {
   3.816624191484887*^9, 3.816624194345891*^9}, {3.8166244967663174`*^9, 
   3.8166245023333273`*^9}, {3.8166246560995455`*^9, 3.816624662460554*^9}, {
   3.816624718390633*^9, 3.8166247232716403`*^9}, {3.8166247964337435`*^9, 
   3.816624805505756*^9}, {3.8166251331682177`*^9, 3.816625174425276*^9}, {
   3.81662574506308*^9, 3.8166257569750967`*^9}, {3.816625811494173*^9, 
   3.8166258116741734`*^9}, {3.8166513526854467`*^9, 
   3.8166513644478674`*^9}, {3.8166526036696444`*^9, 
   3.8166526192696714`*^9}, {3.816652655695735*^9, 3.8166526780505743`*^9}, {
   3.8166527140242376`*^9, 3.816652714242638*^9}, {3.8166528952009563`*^9, 
   3.816652974277495*^9}, {3.8166594899956074`*^9, 3.8166594931156125`*^9}, {
   3.8166603823483744`*^9, 3.8166604683513255`*^9}, {3.816660505385791*^9, 
   3.816660524589424*^9}, {3.816660590271596*^9, 3.8166606063036184`*^9}, {
   3.8166607128014503`*^9, 3.8166607178414574`*^9}, {3.8166607890645576`*^9, 
   3.8166607975565696`*^9}, 3.8166609727058163`*^9, {3.8166610509579268`*^9, 
   3.8166612319331827`*^9}, {3.8166612669992323`*^9, 
   3.8166612931432686`*^9}, {3.81666142884446*^9, 3.81666142901446*^9}, 
   3.8166614674315147`*^9, 3.8166614991765594`*^9, {3.8166615320716057`*^9, 
   3.816661580799674*^9}, {3.816661644290764*^9, 3.816661644440764*^9}, {
   3.816662018506053*^9, 3.816662032539073*^9}, {3.816697893774408*^9, 
   3.8166978976744146`*^9}, {3.8166979318384743`*^9, 
   3.8166979448800974`*^9}, {3.8166979911029787`*^9, 3.816698055484292*^9}, {
   3.81669810022517*^9, 3.816698113687994*^9}, {3.8166981481172543`*^9, 
   3.8166983882615256`*^9}, {3.816698427338581*^9, 3.8166985051316905`*^9}, {
   3.8166985407677402`*^9, 3.816698729140006*^9}, {3.816698763285054*^9, 
   3.816698827495145*^9}, {3.8166990484614563`*^9, 3.8166990522124615`*^9}, {
   3.8166994840890694`*^9, 3.81669951989612*^9}, {3.8166995527311664`*^9, 
   3.816699710096388*^9}, {3.8166998048725214`*^9, 3.8166998121235323`*^9}, {
   3.8166998450095787`*^9, 3.8166998755946217`*^9}, {3.816699989682782*^9, 
   3.816699992893787*^9}, {3.8167000262598333`*^9, 3.8167000369718485`*^9}, {
   3.8167000797499094`*^9, 3.8167001178369627`*^9}, {3.8167002005690794`*^9, 
   3.816700312485237*^9}, {3.816700391168348*^9, 3.8167003998003597`*^9}, {
   3.8167004886844854`*^9, 3.816700496855497*^9}, 3.8167005661555943`*^9, {
   3.816700764237873*^9, 3.816700766787877*^9}, {3.8167012639165773`*^9, 
   3.816701276608595*^9}, {3.8167013405806856`*^9, 3.816701494434902*^9}, {
   3.816701529839952*^9, 3.8167016494511204`*^9}, {3.8167016851771708`*^9, 
   3.816701693118182*^9}, {3.8167020155816364`*^9, 3.8167020174026394`*^9}, {
   3.816702049416684*^9, 3.816702062858703*^9}, {3.8167040440724583`*^9, 
   3.8167040647580943`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"9386c726-0171-410f-8cbd-7bded944dc09"]
}, Closed]],

Cell[CellGroupData[{

Cell["General Supertrace (Main Functions)", "Subsubsection",
 CellChangeTimes->{{3.816539470706667*^9, 
  3.8165395127667265`*^9}},ExpressionUUID->"c06bd4ea-b292-4f1b-805c-\
a78cba71ad9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "SuperTrace", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "SuperTraceFromExpr", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165394716766686`*^9, 3.8165394719066687`*^9}, {
  3.816540184254673*^9, 3.8165401851946745`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"be379038-2d10-407d-b4ec-457e4b50083a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Compute", " ", "a", " ", "functional", " ", "supertrace"}], " ",
      "-", 
     RowBox[{"iSTr", "[", "f", "]"}]}], 
    SubscriptBox["|", "hard"], " ", 
    RowBox[{
    "up", " ", "to", " ", "a", " ", "given", " ", "operator", " ", 
     "dimension", " ", "dim"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SuperTrace", "[", 
      RowBox[{"dim_", ",", "flist_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Udimlist", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Heavylist", "\[Rule]", 
           RowBox[{"{", "1", "}"}]}], ",", 
          RowBox[{"SoftOrd", "\[Rule]", "0"}], ",", 
          RowBox[{"No\[Gamma]inU", "\[Rule]", "False"}], ",", 
          RowBox[{"display", "\[Rule]", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "myflist", ",", "indices", ",", "n\[Nu]", ",", "\[Mu]start", ",", 
         "Parameters", ",", "masslabels", ",", "typelist", ",", "coeff", ",", 
         "Ulist", ",", "Plocations", ",", "Pindices", ",", "myUdimlist", ",", 
         "myHeavylist", ",", "mySoftOrd", ",", "supersign", ",", "flistU", 
         ",", "n\[CapitalSigma]cap", ",", "bflistArray", ",", "UdimlistArray",
          ",", "BSTrInputArray", ",", "polyArray", ",", "mypoly", ",", 
         "myInput", ",", "myPrint", ",", "mystr"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "**",
          "**", "**", "**"}], "********)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**"}], "*", " ", "Interpret", " ", 
         RowBox[{"Inputs", " ", "**", "**", "**"}], "*", "*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "**",
          "**"}], "************)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myflist", "=", "flist"}], ";", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{
            SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n\[Nu]", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"Cases", "[", 
             RowBox[{"indices", ",", 
              RowBox[{
               SubscriptBox["\[Nu]", "i_"], "\[Rule]", "i"}]}], "]"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"indices", ",", 
            SubscriptBox["\[Mu]", "_"]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Mu]start", "=", 
            RowBox[{"Min", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"indices", ",", 
               RowBox[{
                SubscriptBox["\[Mu]", "i_"], "\[Rule]", "i"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"myflist", "=", 
            RowBox[{"myflist", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[Mu]", "i_"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "i", "-", "\[Mu]start", "+", "1"}]]}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<\[Mu] indices are reserved by the package STrEAM as internal \
dummy indices.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<Proceeding with the following indices replacements:\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               SubscriptBox["\[Mu]", "#"], "\[Rule]", 
               SubscriptBox["\[Nu]", 
                RowBox[{"n\[Nu]", "+", "#", "-", "\[Mu]start", "+", "1"}]]}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Sort", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"indices", ",", 
                RowBox[{
                 SubscriptBox["\[Mu]", "i_"], "\[Rule]", "i"}]}], "]"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"n\[Nu]", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{"myflist", ",", 
                   RowBox[{
                    SubscriptBox["_", "a__"], "\[Rule]", "a"}]}], "]"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Nu]", "i_"], "\[Rule]", "i"}]}], "]"}]}], 
              "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"Tally", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"indices", ",", 
                RowBox[{"_", "?", "NumericQ"}]}], "]"}], "]"}], ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 ">", "2"}], "&"}], ")"}]}]}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with invalid input flist=\>\"", ",", 
             "myflist"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Lorentz indices: \>\"", ",", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"indices", ",", 
               RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<The same Lorentz index should not appear more than \
twice.\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Parameters", "=", 
         RowBox[{"STrParameters", "[", 
          RowBox[{"myflist", ",", 
           RowBox[{"OptionValue", "[", "Udimlist", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"masslabels", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"typelist", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "3", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ulist", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "4", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plocations", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "5", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Pindices", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "6", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myUdimlist", "=", 
         RowBox[{
         "Parameters", "\[LeftDoubleBracket]", "7", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**"}], "********)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", " ", "Check"}], " ", "Validity", " ", "of", " ", 
          RowBox[{"Options", " ", "**", "**", "**"}], "*", 
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
          "**"}], "************)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Heavylist", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"myHeavylist", "=", 
         RowBox[{"OptionValue", "[", "Heavylist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"masslabels", ",", "myHeavylist"}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<SuperTrace[] called with an flist containing no heavy \
mass:\>\"", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<flist=\>\"", ",", "myflist"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<masslabels=\>\"", ",", "masslabels"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Heavylist=\>\"", ",", "myHeavylist"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", 
            "\"\<In this case, \
Supertrace[f]=-iSTr[f]\!\(\*SubscriptBox[\(|\), \(hard\)]\) vanishes.\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "SoftOrd", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"mySoftOrd", "=", 
         RowBox[{"OptionValue", "[", "SoftOrd", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "mySoftOrd", "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"mySoftOrd", "<", "0"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<SuperTrace[] called with invalid option SoftOrd=\>\"", ",", 
             "mySoftOrd"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<SoftOrd must be non-negative integers.\>\"", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<Aborted.\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**"}], "********)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
            "**", "**", "**", " ", "Evaluate"}], " ", "the", " ", 
          RowBox[{"SuperTrace", " ", "**", "**", "**", "**"}], "*", 
          RowBox[{
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
           "**"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
           "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
          "**"}], "************)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Address", " ", "the", " ", "\"\<super\>\"", " ", "in", " ", "STr"}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"supersign", "=", 
         RowBox[{
         "typelist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"coeff", "=", 
         RowBox[{"supersign", "\[Times]", "coeff"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Address", " ", "fermionic", " ", "propagators"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"flistU", "=", 
         RowBox[{"STrflistUFrame", "[", 
          RowBox[{
          "masslabels", ",", "typelist", ",", "coeff", ",", "Plocations", ",",
            "Pindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n\[CapitalSigma]cap", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dim", "-", 
             RowBox[{"(", 
              RowBox[{"Plus", "@@", "myUdimlist"}], ")"}]}], ")"}], "/", 
           "2"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n\[CapitalSigma]cap", "<", "0"}], ",", 
          RowBox[{"n\[CapitalSigma]cap", "=", "0"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{"STrBflists", "[", 
          RowBox[{"flistU", ",", "n\[CapitalSigma]cap", ",", "n\[Nu]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UdimlistArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"\[Sigma]F", "|", 
                SubscriptBox["U", "__"]}]}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Sigma]F", "\[Rule]", "2"}], ",", 
               RowBox[{
                SubscriptBox["U", "i_"], "\[RuleDelayed]", 
                RowBox[{
                "myUdimlist", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], ")"}], "&"}], "/@", 
          "bflistArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bflistArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["U", "i_"], "\[RuleDelayed]", 
               RowBox[{
               "Ulist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "}"}]}], ")"}], "&"}], "/@", 
          "bflistArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"BSTrInputArray", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"STrParameters", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"bflistArray", ",", "UdimlistArray"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"BSTrInputArray", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"Delete", "[", 
              RowBox[{"#", ",", "2"}], "]"}]}], "]"}], "&"}], "/@", 
          "BSTrInputArray"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Perform", " ", "original", " ", "CDE"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"BSTrPolyGen", "@@", "#"}], ")"}], "&"}], "/@", 
            "BSTrInputArray"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Perform", " ", "loop", " ", "integrals"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"qEvenTrimPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"dqAllPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SimplifyPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"FTrimPoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"SymHardPoly", "[", 
          RowBox[{
          "mypoly", ",", "dim", ",", "myHeavylist", ",", "mySoftOrd", ",", 
           RowBox[{"OptionValue", "[", "No\[Gamma]inU", "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mypoly", "=", 
         RowBox[{"IntegratePoly", "[", "mypoly", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mystr", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{"#", ",", 
             RowBox[{"3", "\[Rule]", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
            "]"}], "&"}], "/@", "mypoly"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mystr", "=", 
         RowBox[{"mystr", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             SubsuperscriptBox["m", "i_", "2"], "]"}], "\[Rule]", 
            RowBox[{"Log", "[", 
             FractionBox[
              SubsuperscriptBox["m", "i", "2"], 
              SuperscriptBox["\[Mu]", "2"]], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Print", " ", "results"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "display", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myInput", "=", 
            RowBox[{"STrPrint", "[", "myflist", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myPrint", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#", ",", 
                RowBox[{"2", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"Row", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "\"\<(\>\"", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Row", "[", "#", "]"}], "}"}], ",", 
                    RowBox[{"{", "\"\<)\>\"", "}"}]}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ")"}]}], "]"}], "}"}], 
                  "}"}]}]}], "]"}], "&"}], "/@", "mystr"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"myPrint", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#", ",", 
                RowBox[{"3", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<(dim-\>\"", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", "\"\<)\>\""}], "}"}], 
                    "]"}], "}"}], "}"}]}]}], "]"}], "&"}], "/@", 
             "myPrint"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "myInput", ",", 
             "\"\< = \[Integral]\!\(\*SuperscriptBox[\(d\), \(4\)]\)x \
\!\(\*FractionBox[\(1\), \(16 \*SuperscriptBox[\(\[Pi]\), \(2\)]\)]\) \
tr{\\n\>\"", ",", 
             RowBox[{"TableForm", "[", 
              RowBox[{"myPrint", ",", 
               RowBox[{"TableSpacing", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "5", ",", "2"}], "}"}]}]}], "]"}], ",", 
             "\"\<\\n}\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mystr", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Compute", " ", "a", " ", "functional", " ", "supertrace"}], 
      " ", "-", 
      RowBox[{"iSTr", "[", "f", "]"}]}], 
     SubscriptBox["|", "hard"], " ", 
     RowBox[{
     "up", " ", "to", " ", "a", " ", "given", " ", "operator", " ", 
      "dimension", " ", "dim"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SuperTraceFromExpr", "[", 
      RowBox[{"dim_", ",", "fexpr_", ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Udimlist", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Heavylist", "\[Rule]", 
           RowBox[{"{", "1", "}"}]}], ",", 
          RowBox[{"SoftOrd", "\[Rule]", "0"}], ",", 
          RowBox[{"No\[Gamma]inU", "\[Rule]", "False"}], ",", 
          RowBox[{"display", "\[Rule]", "False"}]}], "}"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myflist", ",", "mystr"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"myflist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"fexpr", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Times", "\[Rule]", "List"}], ",", 
              RowBox[{"NonCommutativeMultiply", "\[Rule]", "List"}]}], 
             "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mystr", "=", 
         RowBox[{"SuperTrace", "[", 
          RowBox[{"dim", ",", "myflist", ",", 
           RowBox[{"Udimlist", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Udimlist", "]"}]}], ",", 
           RowBox[{"Heavylist", "\[Rule]", 
            RowBox[{"OptionValue", "[", "Heavylist", "]"}]}], ",", 
           RowBox[{"SoftOrd", "\[Rule]", 
            RowBox[{"OptionValue", "[", "SoftOrd", "]"}]}], ",", 
           RowBox[{"No\[Gamma]inU", "\[Rule]", 
            RowBox[{"OptionValue", "[", "No\[Gamma]inU", "]"}]}], ",", 
           RowBox[{"display", "\[Rule]", 
            RowBox[{"OptionValue", "[", "display", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mystr", "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8165388361207733`*^9, 3.816538836310773*^9}, {
   3.8165401964166903`*^9, 3.816540197336692*^9}, {3.8165641329276695`*^9, 
   3.816564155235708*^9}, {3.8166528257964344`*^9, 3.8166528270600367`*^9}, 
   3.816653027514788*^9, {3.8166531126597376`*^9, 3.81665321081511*^9}, {
   3.816653246882374*^9, 3.8166533232133074`*^9}, {3.816653376487401*^9, 
   3.8166534182642746`*^9}, {3.8166534746271734`*^9, 
   3.8166535155460453`*^9}, {3.816653719298003*^9, 3.81665383724981*^9}, {
   3.8166538701814685`*^9, 3.8166538703686686`*^9}, {3.816701749238261*^9, 
   3.81670181218935*^9}, {3.816701915965496*^9, 3.8167019162054963`*^9}, {
   3.816701949960544*^9, 3.81670200382062*^9}, {3.8167020738607187`*^9, 
   3.81670207474072*^9}, {3.816702161823842*^9, 3.8167021991608953`*^9}, {
   3.816702238617951*^9, 3.8167023223910685`*^9}, {3.8167023596971216`*^9, 
   3.8167023597571216`*^9}, {3.81670243693923*^9, 3.8167024787962894`*^9}, {
   3.816702509406333*^9, 3.816702555123398*^9}, {3.816702607921472*^9, 
   3.8167026132624793`*^9}, {3.8167026646525517`*^9, 3.816702667583556*^9}, {
   3.816702719063629*^9, 3.816702824471777*^9}, {3.816702859246827*^9, 
   3.816702894662877*^9}, {3.8167029263479214`*^9, 3.8167029616529713`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"df311821-e9d4-4858-82de-c8d688512a31"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the `Private context", "Section",
 CellChangeTimes->{{3.8160027743112135`*^9, 3.816002774501213*^9}, {
  3.816003492488225*^9, 
  3.816003505450243*^9}},ExpressionUUID->"d026c125-4cd0-4bf5-ab2c-\
8af0d0e23649"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8160027752722144`*^9, 3.816002775482215*^9}, 
   3.8160035233432684`*^9},ExpressionUUID->"9335ac77-39b9-408f-9a83-\
0212ded97cfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the package context", "Section",
 CellChangeTimes->{{3.8160027761622157`*^9, 3.816002776382216*^9}, {
  3.816003498309233*^9, 
  3.816003511071251*^9}},ExpressionUUID->"5d8aefe4-887d-42c8-8424-\
15dd8de32d3b"],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.816002777072217*^9, 3.8160027772922173`*^9}, 
   3.8160035185122614`*^9},ExpressionUUID->"1e8c0adf-e8c8-4630-9847-\
da31be531f19"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949., 469.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "12.1 for Microsoft Windows (64-bit) (March 18, 2020)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"83b9b376-570e-4548-a0c6-767d85dcaa1c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 253, 3, 98, "Title",ExpressionUUID->"662a8f3a-d1ee-4f63-9c1d-149fdaf6ec99"],
Cell[836, 27, 584, 11, 78, "Text",ExpressionUUID->"0b01acb2-667c-458b-b768-a2dcb353bb45"],
Cell[CellGroupData[{
Cell[1445, 42, 217, 4, 67, "Section",ExpressionUUID->"082fd18a-95b5-45c0-99f6-6246c1805f02"],
Cell[1665, 48, 257, 5, 44, "Input",ExpressionUUID->"c20b3ed0-afb0-41b1-8870-a49d70cb20d3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1947, 57, 242, 4, 54, "Subsection",ExpressionUUID->"865fc571-d6ad-414e-b93b-4d97f5764f89"],
Cell[2192, 63, 6435, 131, 531, "Input",ExpressionUUID->"f5b27e81-fee2-43bf-8b72-a4fefe5d4e9c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8676, 200, 224, 4, 67, "Section",ExpressionUUID->"b6c86209-c710-4b00-971b-6d0c93cd8fb0"],
Cell[8903, 206, 249, 5, 44, "Input",ExpressionUUID->"68b24e7e-ba8d-467b-8952-fce34710afed",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[9177, 215, 172, 3, 54, "Subsection",ExpressionUUID->"095daa73-311e-4a5f-8ce4-891e55b8ebbe"],
Cell[CellGroupData[{
Cell[9374, 222, 238, 4, 34, "Text",ExpressionUUID->"632c0ae8-f1d2-4065-ae01-bd1f4bf25f2d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[9615, 228, 6474, 164, 432, "Input",ExpressionUUID->"73803775-ea8e-4e6c-b56d-8a4b670a479b",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[16126, 397, 228, 4, 36, "Subsubsection",ExpressionUUID->"9f8c6a2e-df40-4f84-a982-a7d84825c4ce"],
Cell[16357, 403, 1106, 27, 200, "Input",ExpressionUUID->"f18b13b2-0e28-4129-807a-4f79c9ac56dc",
 InitializationCell->True],
Cell[17466, 432, 11559, 301, 1158, "Input",ExpressionUUID->"35ebacf4-796e-433b-9335-cfd99a3efb17",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[29062, 738, 178, 3, 36, "Subsubsection",ExpressionUUID->"b901be8c-fdfc-448c-97f7-344842bbc09b"],
Cell[29243, 743, 1466, 35, 297, "Input",ExpressionUUID->"6acf400e-9beb-4b3c-9f9c-9b5b9a69f95c",
 InitializationCell->True],
Cell[30712, 780, 39437, 984, 3085, "Input",ExpressionUUID->"cd4e4332-93fe-4c3a-8078-c308224fdf96",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[70198, 1770, 224, 4, 38, "Subsection",ExpressionUUID->"96de1123-f0ea-46f5-a4be-2232f07f929f"],
Cell[CellGroupData[{
Cell[70447, 1778, 264, 5, 34, "Text",ExpressionUUID->"39635031-1306-4260-9bdf-14da131d6241",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[70714, 1785, 5837, 142, 422, "Input",ExpressionUUID->"df612e1b-605d-4fe1-b23f-aae800bb3796",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[76588, 1932, 179, 3, 36, "Subsubsection",ExpressionUUID->"f9989a9d-7ef3-44fb-80cc-c8714de5ac99"],
Cell[76770, 1937, 1054, 18, 103, "Input",ExpressionUUID->"48d2fec3-88da-4ff8-a097-bb1991367c4b",
 InitializationCell->True],
Cell[77827, 1957, 19165, 452, 1214, "Input",ExpressionUUID->"5eeb4871-8412-4526-9c95-a3b4194d817c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[97029, 2414, 164, 3, 36, "Subsubsection",ExpressionUUID->"56d19092-113d-41d2-ae31-a3650e1f3a40"],
Cell[97196, 2419, 2513, 57, 452, "Input",ExpressionUUID->"74a28995-db8d-4e1c-b961-3af991b2b959",
 InitializationCell->True],
Cell[99712, 2478, 63884, 1609, 4173, "Input",ExpressionUUID->"9cf3ed08-524c-4ebe-8632-6857abad603d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[163633, 4092, 231, 4, 36, "Subsubsection",ExpressionUUID->"446ba1b0-5e5e-4193-8f91-ac634dec8066"],
Cell[163867, 4098, 678, 14, 103, "Input",ExpressionUUID->"c7c47633-5d4f-4f20-b16a-81355ef71fb8",
 InitializationCell->True],
Cell[164548, 4114, 13077, 311, 1056, "Input",ExpressionUUID->"cb31c9eb-e30a-4aaf-a148-f13fff5be223",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[177674, 4431, 164, 3, 38, "Subsection",ExpressionUUID->"f52ce3c2-ad06-4121-a8c3-5f3ec013b45a"],
Cell[CellGroupData[{
Cell[177863, 4438, 234, 4, 34, "Text",ExpressionUUID->"37eb0656-6fec-4975-8d97-213b8f1dcc82",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[178100, 4444, 4938, 149, 305, "Input",ExpressionUUID->"483d8fe1-3e39-4531-b026-2288d7a6688e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[183075, 4598, 466, 13, 39, "Subsubsection",ExpressionUUID->"825ab971-4124-493c-8a02-7d4ef5cb875e"],
Cell[183544, 4613, 537, 12, 84, "Input",ExpressionUUID->"3d2d334f-9cce-445b-b7ac-0ab6d941d43f",
 InitializationCell->True],
Cell[184084, 4627, 16244, 412, 1043, "Input",ExpressionUUID->"095a7f4f-9671-4fb7-887b-90a372910514",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[200365, 5044, 574, 14, 39, "Subsubsection",ExpressionUUID->"c49e1031-0840-4c04-84a1-62a17cef033b"],
Cell[200942, 5060, 965, 24, 161, "Input",ExpressionUUID->"80d7a754-5eb2-4ea5-9163-9c470b580b69",
 InitializationCell->True],
Cell[201910, 5086, 23737, 616, 1526, "Input",ExpressionUUID->"2642cd05-fb5f-4274-ba31-ec0ef889fa7f",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[225696, 5708, 174, 3, 38, "Subsection",ExpressionUUID->"3d3a826c-da45-4359-805e-2cc799e510d0"],
Cell[CellGroupData[{
Cell[225895, 5715, 213, 4, 34, "Text",ExpressionUUID->"ba516539-4fbf-4d01-9dbd-75740067ef7c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[226111, 5721, 9975, 243, 770, "Input",ExpressionUUID->"3879f6c3-cea2-44b1-9f48-5091cfe347c8",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[236123, 5969, 244, 4, 36, "Subsubsection",ExpressionUUID->"d4011335-d331-419d-bff3-b72825bcf1a7"],
Cell[236370, 5975, 868, 19, 161, "Input",ExpressionUUID->"7bfbb863-c9c9-4154-8a19-27f91000ab89",
 InitializationCell->True],
Cell[237241, 5996, 51662, 1192, 3589, "Input",ExpressionUUID->"9386c726-0171-410f-8cbd-7bded944dc09",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[288940, 7193, 188, 3, 36, "Subsubsection",ExpressionUUID->"c06bd4ea-b292-4f1b-805c-a78cba71ad9d"],
Cell[289131, 7198, 434, 11, 64, "Input",ExpressionUUID->"be379038-2d10-407d-b4ec-457e4b50083a",
 InitializationCell->True],
Cell[289568, 7211, 26472, 600, 2266, "Input",ExpressionUUID->"df311821-e9d4-4858-82de-c8d688512a31",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[316101, 7818, 220, 4, 67, "Section",ExpressionUUID->"d026c125-4cd0-4bf5-ab2c-8af0d0e23649"],
Cell[316324, 7824, 231, 5, 44, "Input",ExpressionUUID->"9335ac77-39b9-408f-9a83-0212ded97cfd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[316592, 7834, 219, 4, 67, "Section",ExpressionUUID->"5d8aefe4-887d-42c8-8424-15dd8de32d3b"],
Cell[316814, 7840, 238, 5, 44, "Input",ExpressionUUID->"1e8c0adf-e8c8-4630-9847-da31be531f19",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

